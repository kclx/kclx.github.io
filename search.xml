<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>matplotlib简析</title>
      <link href="/2023/07/27/matplotlib%E7%AE%80%E6%9E%90/"/>
      <url>/2023/07/27/matplotlib%E7%AE%80%E6%9E%90/</url>
      
        <content type="html"><![CDATA[<h1 id="matplotlib简析"><a href="#matplotlib简析" class="headerlink" title="matplotlib简析"></a>matplotlib简析</h1><p>Matplotlib是一个用于创建静态、动态和交互式图表的Python绘图库。它提供了广泛的功能，使用户能够可视化数据和结果，从简单的线条图和散点图到复杂的图形，如条形图、直方图、饼图、3D图形等。</p><p>Matplotlib是Python数据科学生态系统中最流行的绘图库之一，它支持几乎所有操作系统，并且可以与多个图形工具包和界面结合使用，如NumPy、Pandas、SciPy等。此外，Matplotlib还可以嵌入到图形用户界面（GUI）工具包中，如Tkinter、PyQt等，从而实现交互式图形应用程序的开发。</p><p>Matplotlib的主要优势包括易于使用、灵活性和功能强大。使用Matplotlib，您可以以高质量和专业的方式展示数据，这对于数据分析、科学研究、工程和其他领域都是非常有用的。</p><div class="tagLink"><a class="link-card" title="Matplotlib官网" href="https://matplotlib.org/"><span class="link-card-backdrop" style="background-image: url(https://matplotlib.org/_static/logo_light.svg)"></span><div class="left"><img src="https://matplotlib.org/_static/logo_light.svg" class="lazyload placeholder" data-srcset="https://matplotlib.org/_static/logo_light.svg" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div><div class="right"><p class="text">Matplotlib官网</p><p class="url">https://matplotlib.org/</p></div></a></div><h2 id="绘图类型"><a href="#绘图类型" class="headerlink" title="绘图类型"></a>绘图类型</h2><h3 id="绘图"><a href="#绘图" class="headerlink" title="绘图"></a>绘图</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">plt.style.use(<span class="string">&#x27;_mpl-gallery&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># make data</span></span><br><span class="line">x = np.linspace(<span class="number">0</span>, <span class="number">10</span>, <span class="number">100</span>)</span><br><span class="line">y = <span class="number">4</span> + <span class="number">2</span> * np.sin(<span class="number">2</span> * x)</span><br><span class="line"></span><br><span class="line"><span class="comment"># plot</span></span><br><span class="line">fig, ax = plt.subplots()</span><br><span class="line"></span><br><span class="line">ax.plot(x, y, linewidth=<span class="number">2.0</span>)</span><br><span class="line"></span><br><span class="line">ax.<span class="built_in">set</span>(xlim=(<span class="number">0</span>, <span class="number">8</span>), xticks=np.arange(<span class="number">1</span>, <span class="number">8</span>),</span><br><span class="line">       ylim=(<span class="number">0</span>, <span class="number">8</span>), yticks=np.arange(<span class="number">1</span>, <span class="number">8</span>))</span><br><span class="line"></span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure><ol><li><p><code>import matplotlib.pyplot as plt</code>: 导入Matplotlib库，并将其简化为<code>plt</code>，这是Matplotlib中常用的惯例。</p></li><li><p><code>import numpy as np</code>: 导入NumPy库，并将其简化为<code>np</code>，NumPy是用于数值计算的Python库。</p></li><li><p><code>plt.style.use(&#39;_mpl-gallery&#39;)</code>: 这里使用了一个自定义的Matplotlib样式<code>&#39;_mpl-gallery&#39;</code>。Matplotlib样式用于设置图形的外观和风格。在此之前可能有一个自定义的样式定义，但代码片段中没有显示出来。</p></li><li><p><code>x = np.linspace(0, 10, 100)</code>: 使用NumPy的<code>linspace</code>函数创建一个包含100个点的等间隔数组，从0到10。这个数组将作为x轴的值。</p></li><li><p><code>y = 4 + 2 * np.sin(2 * x)</code>: 使用NumPy的<code>sin</code>函数对<code>2 * x</code>进行正弦运算，并乘以2，然后再加上4，得到y轴的值。这个计算的结果是使y值随着x轴的增加而周期性地上下波动的一组数据。</p></li><li><p><code>fig, ax = plt.subplots()</code>: 创建一个图形对象和一个坐标轴对象。<code>fig</code>代表整个图形窗口，<code>ax</code>代表图形中的坐标轴。</p></li><li><p><code>ax.plot(x, y, linewidth=2.0)</code>: 在坐标轴<code>ax</code>上绘制折线图，使用之前生成的x和y数组作为数据，并设置线宽为2.0。</p></li><li><p><code>ax.set(xlim=(0, 8), xticks=np.arange(1, 8), ylim=(0, 8), yticks=np.arange(1, 8))</code>: 设置坐标轴的范围和刻度。x轴范围设置为0到8，同时设置x轴刻度为从1到7的间隔为1的刻度。y轴范围设置为0到8，同时设置y轴刻度为从1到7的间隔为1的刻度。</p></li><li><p><code>plt.show()</code>: 显示绘制的图形。</p></li></ol><img src="https://matplotlib.org/stable/_images/sphx_glr_plot_001_2_00x.png" class="lazyload placeholder" data-srcset="https://matplotlib.org/stable/_images/sphx_glr_plot_001_2_00x.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="plot"><h3 id="散点图"><a href="#散点图" class="headerlink" title="散点图"></a>散点图</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">plt.style.use(<span class="string">&#x27;_mpl-gallery&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># make the data</span></span><br><span class="line">np.random.seed(<span class="number">3</span>)</span><br><span class="line">x = <span class="number">4</span> + np.random.normal(<span class="number">0</span>, <span class="number">2</span>, <span class="number">24</span>)</span><br><span class="line">y = <span class="number">4</span> + np.random.normal(<span class="number">0</span>, <span class="number">2</span>, <span class="built_in">len</span>(x))</span><br><span class="line"><span class="comment"># size and color:</span></span><br><span class="line">sizes = np.random.uniform(<span class="number">15</span>, <span class="number">80</span>, <span class="built_in">len</span>(x))</span><br><span class="line">colors = np.random.uniform(<span class="number">15</span>, <span class="number">80</span>, <span class="built_in">len</span>(x))</span><br><span class="line"></span><br><span class="line"><span class="comment"># plot</span></span><br><span class="line">fig, ax = plt.subplots()</span><br><span class="line"></span><br><span class="line">ax.scatter(x, y, s=sizes, c=colors, vmin=<span class="number">0</span>, vmax=<span class="number">100</span>)</span><br><span class="line"></span><br><span class="line">ax.<span class="built_in">set</span>(xlim=(<span class="number">0</span>, <span class="number">8</span>), xticks=np.arange(<span class="number">1</span>, <span class="number">8</span>),</span><br><span class="line">       ylim=(<span class="number">0</span>, <span class="number">8</span>), yticks=np.arange(<span class="number">1</span>, <span class="number">8</span>))</span><br><span class="line"></span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure><ol><li><p><code>import matplotlib.pyplot as plt</code>: 导入Matplotlib库，并将其简化为<code>plt</code>，这是Matplotlib中常用的惯例。</p></li><li><p><code>import numpy as np</code>: 导入NumPy库，并将其简化为<code>np</code>，NumPy是用于数值计算的Python库。</p></li><li><p><code>plt.style.use(&#39;_mpl-gallery&#39;)</code>: 这里使用了一个自定义的Matplotlib样式<code>&#39;_mpl-gallery&#39;</code>。Matplotlib样式用于设置图形的外观和风格。在此之前可能有一个自定义的样式定义，但代码片段中没有显示出来。</p></li><li><p><code>np.random.seed(3)</code>: 设置随机数生成器的种子，这样每次运行代码都能得到相同的随机数据。这是为了保证结果的可复现性。</p></li><li><p><code>x = 4 + np.random.normal(0, 2, 24)</code>: 使用NumPy的<code>random.normal</code>函数生成一个包含24个随机数的数组，这些随机数是从均值为0、标准差为2的正态分布中抽取的，并将每个数值都加上4。这样生成了一组带有偏移的随机数据，用作x轴的值。</p></li><li><p><code>y = 4 + np.random.normal(0, 2, len(x))</code>: 同样，使用NumPy的<code>random.normal</code>函数生成一个与x轴数据长度相同的随机数数组，并进行偏移。这样生成了一组带有偏移的随机数据，用作y轴的值。</p></li><li><p><code>sizes = np.random.uniform(15, 80, len(x))</code>: 使用NumPy的<code>random.uniform</code>函数生成一个与x轴数据长度相同的数组，其中的数值在15到80之间，用作散点的大小。</p></li><li><p><code>colors = np.random.uniform(15, 80, len(x))</code>: 使用NumPy的<code>random.uniform</code>函数生成一个与x轴数据长度相同的数组，其中的数值在15到80之间，用作散点的颜色。</p></li><li><p><code>fig, ax = plt.subplots()</code>: 创建一个图形对象和一个坐标轴对象。<code>fig</code>代表整个图形窗口，<code>ax</code>代表图形中的坐标轴。</p></li><li><p><code>ax.scatter(x, y, s=sizes, c=colors, vmin=0, vmax=100)</code>: 在坐标轴<code>ax</code>上绘制散点图。使用之前生成的x和y数组作为数据，并使用<code>sizes</code>数组设置散点的大小，使用<code>colors</code>数组设置散点的颜色。<code>vmin</code>和<code>vmax</code>参数用于设置颜色映射范围，这里设置为0和100，即颜色范围在15到80之间。</p></li><li><p><code>ax.set(xlim=(0, 8), xticks=np.arange(1, 8), ylim=(0, 8), yticks=np.arange(1, 8))</code>: 设置坐标轴的范围和刻度。x轴范围设置为0到8，同时设置x轴刻度为从1到7的间隔为1的刻度。y轴范围设置为0到8，同时设置y轴刻度为从1到7的间隔为1的刻度。</p></li><li><p><code>plt.show()</code>: 显示绘制的图形。</p></li></ol><img src="https://matplotlib.org/stable/_images/sphx_glr_scatter_plot_001_2_00x.png" class="lazyload placeholder" data-srcset="https://matplotlib.org/stable/_images/sphx_glr_scatter_plot_001_2_00x.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="scatter"><h3 id="条形图"><a href="#条形图" class="headerlink" title="条形图"></a>条形图</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">plt.style.use(<span class="string">&#x27;_mpl-gallery&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># make data:</span></span><br><span class="line">x = <span class="number">0.5</span> + np.arange(<span class="number">8</span>)</span><br><span class="line">y = [<span class="number">4.8</span>, <span class="number">5.5</span>, <span class="number">3.5</span>, <span class="number">4.6</span>, <span class="number">6.5</span>, <span class="number">6.6</span>, <span class="number">2.6</span>, <span class="number">3.0</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># plot</span></span><br><span class="line">fig, ax = plt.subplots()</span><br><span class="line"></span><br><span class="line">ax.bar(x, y, width=<span class="number">1</span>, edgecolor=<span class="string">&quot;white&quot;</span>, linewidth=<span class="number">0.7</span>)</span><br><span class="line"></span><br><span class="line">ax.<span class="built_in">set</span>(xlim=(<span class="number">0</span>, <span class="number">8</span>), xticks=np.arange(<span class="number">1</span>, <span class="number">8</span>),</span><br><span class="line">       ylim=(<span class="number">0</span>, <span class="number">8</span>), yticks=np.arange(<span class="number">1</span>, <span class="number">8</span>))</span><br><span class="line"></span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure><ol><li><p><code>import matplotlib.pyplot as plt</code>: 导入Matplotlib库，并将其简化为<code>plt</code>，这是Matplotlib中常用的惯例。</p></li><li><p><code>import numpy as np</code>: 导入NumPy库，并将其简化为<code>np</code>，NumPy是用于数值计算的Python库。</p></li><li><p><code>plt.style.use(&#39;_mpl-gallery&#39;)</code>: 这里使用了一个自定义的Matplotlib样式<code>&#39;_mpl-gallery&#39;</code>。Matplotlib样式用于设置图形的外观和风格。在此之前可能有一个自定义的样式定义，但代码片段中没有显示出来。</p></li><li><p><code>x = 0.5 + np.arange(8)</code>: 使用NumPy的<code>arange</code>函数生成一个从0.5开始、间隔为1的长度为8的数组。这将作为x轴的数据。</p></li><li><p><code>y = [4.8, 5.5, 3.5, 4.6, 6.5, 6.6, 2.6, 3.0]</code>: 定义了一个包含8个数值的列表，这些数值将作为y轴的数据。</p></li><li><p><code>fig, ax = plt.subplots()</code>: 创建一个图形对象和一个坐标轴对象。<code>fig</code>代表整个图形窗口，<code>ax</code>代表图形中的坐标轴。</p></li><li><p><code>ax.bar(x, y, width=1, edgecolor=&quot;white&quot;, linewidth=0.7)</code>: 在坐标轴<code>ax</code>上绘制条形图。使用之前生成的x和y数组作为数据，<code>width=1</code>设置条形的宽度为1，<code>edgecolor=&quot;white&quot;</code>设置条形的边缘颜色为白色，<code>linewidth=0.7</code>设置条形的边缘线宽为0.7。</p></li><li><p><code>ax.set(xlim=(0, 8), xticks=np.arange(1, 8), ylim=(0, 8), yticks=np.arange(1, 8))</code>: 设置坐标轴的范围和刻度。x轴范围设置为0到8，同时设置x轴刻度为从1到7的间隔为1的刻度。y轴范围设置为0到8，同时设置y轴刻度为从1到7的间隔为1的刻度。</p></li><li><p><code>plt.show()</code>: 显示绘制的图形。</p></li></ol><img src="https://matplotlib.org/stable/_images/sphx_glr_bar_001_2_00x.png" class="lazyload placeholder" data-srcset="https://matplotlib.org/stable/_images/sphx_glr_bar_001_2_00x.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="bar"><h3 id="棉棒图"><a href="#棉棒图" class="headerlink" title="棉棒图"></a>棉棒图</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">plt.style.use(<span class="string">&#x27;_mpl-gallery&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># make data</span></span><br><span class="line">x = <span class="number">0.5</span> + np.arange(<span class="number">8</span>)</span><br><span class="line">y = [<span class="number">4.8</span>, <span class="number">5.5</span>, <span class="number">3.5</span>, <span class="number">4.6</span>, <span class="number">6.5</span>, <span class="number">6.6</span>, <span class="number">2.6</span>, <span class="number">3.0</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># plot</span></span><br><span class="line">fig, ax = plt.subplots()</span><br><span class="line"></span><br><span class="line">ax.stem(x, y)</span><br><span class="line"></span><br><span class="line">ax.<span class="built_in">set</span>(xlim=(<span class="number">0</span>, <span class="number">8</span>), xticks=np.arange(<span class="number">1</span>, <span class="number">8</span>),</span><br><span class="line">       ylim=(<span class="number">0</span>, <span class="number">8</span>), yticks=np.arange(<span class="number">1</span>, <span class="number">8</span>))</span><br><span class="line"></span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure><ol><li><p><code>import matplotlib.pyplot as plt</code>: 导入Matplotlib库，并将其简化为<code>plt</code>，这是Matplotlib中常用的惯例。</p></li><li><p><code>import numpy as np</code>: 导入NumPy库，并将其简化为<code>np</code>，NumPy是用于数值计算的Python库。</p></li><li><p><code>plt.style.use(&#39;_mpl-gallery&#39;)</code>: 这里使用了一个自定义的Matplotlib样式<code>&#39;_mpl-gallery&#39;</code>。Matplotlib样式用于设置图形的外观和风格。在此之前可能有一个自定义的样式定义，但代码片段中没有显示出来。</p></li><li><p><code>x = 0.5 + np.arange(8)</code>: 使用NumPy的<code>arange</code>函数生成一个从0.5开始、间隔为1的长度为8的数组。这将作为x轴的数据。</p></li><li><p><code>y = [4.8, 5.5, 3.5, 4.6, 6.5, 6.6, 2.6, 3.0]</code>: 定义了一个包含8个数值的列表，这些数值将作为y轴的数据。</p></li><li><p><code>fig, ax = plt.subplots()</code>: 创建一个图形对象和一个坐标轴对象。<code>fig</code>代表整个图形窗口，<code>ax</code>代表图形中的坐标轴。</p></li><li><p><code>ax.stem(x, y)</code>: 在坐标轴<code>ax</code>上绘制棉棒图（stem plot）。使用之前生成的x和y数组作为数据，棉棒图展示了每个x坐标对应的y值，并通过垂直线连接每个点到x轴。</p></li><li><p><code>ax.set(xlim=(0, 8), xticks=np.arange(1, 8), ylim=(0, 8), yticks=np.arange(1, 8))</code>: 设置坐标轴的范围和刻度。x轴范围设置为0到8，同时设置x轴刻度为从1到7的间隔为1的刻度。y轴范围设置为0到8，同时设置y轴刻度为从1到7的间隔为1的刻度。</p></li><li><p><code>plt.show()</code>: 显示绘制的图形。</p></li></ol><img src="https://matplotlib.org/stable/_images/sphx_glr_stem_001_2_00x.png" class="lazyload placeholder" data-srcset="https://matplotlib.org/stable/_images/sphx_glr_stem_001_2_00x.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="stem"><h3 id="阶梯图"><a href="#阶梯图" class="headerlink" title="阶梯图"></a>阶梯图</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">plt.style.use(<span class="string">&#x27;_mpl-gallery&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># make data</span></span><br><span class="line">x = <span class="number">0.5</span> + np.arange(<span class="number">8</span>)</span><br><span class="line">y = [<span class="number">4.8</span>, <span class="number">5.5</span>, <span class="number">3.5</span>, <span class="number">4.6</span>, <span class="number">6.5</span>, <span class="number">6.6</span>, <span class="number">2.6</span>, <span class="number">3.0</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># plot</span></span><br><span class="line">fig, ax = plt.subplots()</span><br><span class="line"></span><br><span class="line">ax.step(x, y, linewidth=<span class="number">2.5</span>)</span><br><span class="line"></span><br><span class="line">ax.<span class="built_in">set</span>(xlim=(<span class="number">0</span>, <span class="number">8</span>), xticks=np.arange(<span class="number">1</span>, <span class="number">8</span>),</span><br><span class="line">       ylim=(<span class="number">0</span>, <span class="number">8</span>), yticks=np.arange(<span class="number">1</span>, <span class="number">8</span>))</span><br><span class="line"></span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure><ol><li><p><code>import matplotlib.pyplot as plt</code>: 导入Matplotlib库，并将其简化为<code>plt</code>，这是Matplotlib中常用的惯例。</p></li><li><p><code>import numpy as np</code>: 导入NumPy库，并将其简化为<code>np</code>，NumPy是用于数值计算的Python库。</p></li><li><p><code>plt.style.use(&#39;_mpl-gallery&#39;)</code>: 这里使用了一个自定义的Matplotlib样式<code>&#39;_mpl-gallery&#39;</code>。Matplotlib样式用于设置图形的外观和风格。在此之前可能有一个自定义的样式定义，但代码片段中没有显示出来。</p></li><li><p><code>x = 0.5 + np.arange(8)</code>: 使用NumPy的<code>arange</code>函数生成一个从0.5开始、间隔为1的长度为8的数组。这将作为x轴的数据。</p></li><li><p><code>y = [4.8, 5.5, 3.5, 4.6, 6.5, 6.6, 2.6, 3.0]</code>: 定义了一个包含8个数值的列表，这些数值将作为y轴的数据。</p></li><li><p><code>fig, ax = plt.subplots()</code>: 创建一个图形对象和一个坐标轴对象。<code>fig</code>代表整个图形窗口，<code>ax</code>代表图形中的坐标轴。</p></li><li><p><code>ax.step(x, y, linewidth=2.5)</code>: 在坐标轴<code>ax</code>上绘制阶梯图（step plot）。使用之前生成的x和y数组作为数据，阶梯图是一种连续线段连接的图形，每个点以垂直线段连接到下一个点，形成阶梯状的线条。</p></li><li><p><code>ax.set(xlim=(0, 8), xticks=np.arange(1, 8), ylim=(0, 8), yticks=np.arange(1, 8))</code>: 设置坐标轴的范围和刻度。x轴范围设置为0到8，同时设置x轴刻度为从1到7的间隔为1的刻度。y轴范围设置为0到8，同时设置y轴刻度为从1到7的间隔为1的刻度。</p></li><li><p><code>plt.show()</code>: 显示绘制的图形。</p></li></ol><img src="https://matplotlib.org/stable/_images/sphx_glr_step_001_2_00x.png" class="lazyload placeholder" data-srcset="https://matplotlib.org/stable/_images/sphx_glr_step_001_2_00x.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="step"><h3 id="填充区域图"><a href="#填充区域图" class="headerlink" title="填充区域图"></a>填充区域图</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">plt.style.use(<span class="string">&#x27;_mpl-gallery&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># make data</span></span><br><span class="line">np.random.seed(<span class="number">1</span>)</span><br><span class="line">x = np.linspace(<span class="number">0</span>, <span class="number">8</span>, <span class="number">16</span>)</span><br><span class="line">y1 = <span class="number">3</span> + <span class="number">4</span>*x/<span class="number">8</span> + np.random.uniform(<span class="number">0.0</span>, <span class="number">0.5</span>, <span class="built_in">len</span>(x))</span><br><span class="line">y2 = <span class="number">1</span> + <span class="number">2</span>*x/<span class="number">8</span> + np.random.uniform(<span class="number">0.0</span>, <span class="number">0.5</span>, <span class="built_in">len</span>(x))</span><br><span class="line"></span><br><span class="line"><span class="comment"># plot</span></span><br><span class="line">fig, ax = plt.subplots()</span><br><span class="line"></span><br><span class="line">ax.fill_between(x, y1, y2, alpha=<span class="number">.5</span>, linewidth=<span class="number">0</span>)</span><br><span class="line">ax.plot(x, (y1 + y2)/<span class="number">2</span>, linewidth=<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">ax.<span class="built_in">set</span>(xlim=(<span class="number">0</span>, <span class="number">8</span>), xticks=np.arange(<span class="number">1</span>, <span class="number">8</span>),</span><br><span class="line">       ylim=(<span class="number">0</span>, <span class="number">8</span>), yticks=np.arange(<span class="number">1</span>, <span class="number">8</span>))</span><br><span class="line"></span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure><ol><li><p><code>import matplotlib.pyplot as plt</code>: 导入Matplotlib库，并将其简化为<code>plt</code>，这是Matplotlib中常用的惯例。</p></li><li><p><code>import numpy as np</code>: 导入NumPy库，并将其简化为<code>np</code>，NumPy是用于数值计算的Python库。</p></li><li><p><code>plt.style.use(&#39;_mpl-gallery&#39;)</code>: 这里使用了一个自定义的Matplotlib样式<code>&#39;_mpl-gallery&#39;</code>。Matplotlib样式用于设置图形的外观和风格。在此之前可能有一个自定义的样式定义，但代码片段中没有显示出来。</p></li><li><p><code>np.random.seed(1)</code>: 设置随机数生成器的种子，这样每次运行代码都能得到相同的随机数据。这是为了保证结果的可复现性。</p></li><li><p><code>x = np.linspace(0, 8, 16)</code>: 使用NumPy的<code>linspace</code>函数生成一个从0到8的等间隔数组，长度为16。这将作为x轴的数据。</p></li><li><p><code>y1 = 3 + 4*x/8 + np.random.uniform(0.0, 0.5, len(x))</code>: 使用NumPy的<code>random.uniform</code>函数生成一个与x轴数据长度相同的随机数数组，其中的数值在0.0到0.5之间，并将其加到3 + 4*x&#x2F;8的结果中。这将生成一组y1轴的随机数据。</p></li><li><p><code>y2 = 1 + 2*x/8 + np.random.uniform(0.0, 0.5, len(x))</code>: 同样，使用NumPy的<code>random.uniform</code>函数生成一个与x轴数据长度相同的随机数数组，其中的数值在0.0到0.5之间，并将其加到1 + 2*x&#x2F;8的结果中。这将生成一组y2轴的随机数据。</p></li><li><p><code>fig, ax = plt.subplots()</code>: 创建一个图形对象和一个坐标轴对象。<code>fig</code>代表整个图形窗口，<code>ax</code>代表图形中的坐标轴。</p></li><li><p><code>ax.fill_between(x, y1, y2, alpha=.5, linewidth=0)</code>: 在坐标轴<code>ax</code>上绘制两条曲线<code>y1</code>和<code>y2</code>之间的填充区域。<code>alpha=.5</code>设置填充区域的透明度为0.5，<code>linewidth=0</code>设置填充区域的边界线宽为0，使得填充区域没有明显的边界线。</p></li><li><p><code>ax.plot(x, (y1 + y2)/2, linewidth=2)</code>: 在坐标轴<code>ax</code>上绘制一条线，线的y值是<code>y1</code>和<code>y2</code>的平均值，即<code>(y1 + y2)/2</code>。这条线将连接<code>y1</code>和<code>y2</code>两条曲线之间填充区域的中心。</p></li><li><p><code>ax.set(xlim=(0, 8), xticks=np.arange(1, 8), ylim=(0, 8), yticks=np.arange(1, 8))</code>: 设置坐标轴的范围和刻度。x轴范围设置为0到8，同时设置x轴刻度为从1到7的间隔为1的刻度。y轴范围设置为0到8，同时设置y轴刻度为从1到7的间隔为1的刻度。</p></li><li><p><code>plt.show()</code>: 显示绘制的图形。</p></li></ol><p>这段代码将绘制一个填充区域图，其中x轴的数据是从0到8的长度为16的等间隔数组，y轴的数据是通过在两个曲线<code>y1</code>和<code>y2</code>之间填充一个随机生成的小范围来得到的。填充区域由透明度为0.5的颜色填充，而中心线由y1和y2的平均值组成。x轴范围是0到8，y轴范围是0到8，并且x和y轴都有间隔为1的刻度。</p><img src="https://matplotlib.org/stable/_images/sphx_glr_fill_between_001_2_00x.png" class="lazyload placeholder" data-srcset="https://matplotlib.org/stable/_images/sphx_glr_fill_between_001_2_00x.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="fill_between"><h3 id="堆叠区域图"><a href="#堆叠区域图" class="headerlink" title="堆叠区域图"></a>堆叠区域图</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">plt.style.use(<span class="string">&#x27;_mpl-gallery&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># make data</span></span><br><span class="line">x = np.arange(<span class="number">0</span>, <span class="number">10</span>, <span class="number">2</span>)</span><br><span class="line">ay = [<span class="number">1</span>, <span class="number">1.25</span>, <span class="number">2</span>, <span class="number">2.75</span>, <span class="number">3</span>]</span><br><span class="line">by = [<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>]</span><br><span class="line">cy = [<span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>]</span><br><span class="line">y = np.vstack([ay, by, cy])</span><br><span class="line"></span><br><span class="line"><span class="comment"># plot</span></span><br><span class="line">fig, ax = plt.subplots()</span><br><span class="line"></span><br><span class="line">ax.stackplot(x, y)</span><br><span class="line"></span><br><span class="line">ax.<span class="built_in">set</span>(xlim=(<span class="number">0</span>, <span class="number">8</span>), xticks=np.arange(<span class="number">1</span>, <span class="number">8</span>),</span><br><span class="line">       ylim=(<span class="number">0</span>, <span class="number">8</span>), yticks=np.arange(<span class="number">1</span>, <span class="number">8</span>))</span><br><span class="line"></span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure><ol><li><p><code>import matplotlib.pyplot as plt</code>: 导入Matplotlib库，并将其简化为<code>plt</code>，这是Matplotlib中常用的惯例。</p></li><li><p><code>import numpy as np</code>: 导入NumPy库，并将其简化为<code>np</code>，NumPy是用于数值计算的Python库。</p></li><li><p><code>plt.style.use(&#39;_mpl-gallery&#39;)</code>: 这里使用了一个自定义的Matplotlib样式<code>&#39;_mpl-gallery&#39;</code>。Matplotlib样式用于设置图形的外观和风格。在此之前可能有一个自定义的样式定义，但代码片段中没有显示出来。</p></li><li><p><code>x = np.arange(0, 10, 2)</code>: 使用NumPy的<code>arange</code>函数生成一个从0开始、间隔为2的长度为5的数组。这将作为x轴的数据。</p></li><li><p><code>ay = [1, 1.25, 2, 2.75, 3]</code>: 定义了一个包含5个数值的列表，这些数值将作为第一组y轴的数据。</p></li><li><p><code>by = [1, 1, 1, 1, 1]</code>: 定义了一个包含5个数值的列表，这些数值将作为第二组y轴的数据。</p></li><li><p><code>cy = [2, 1, 2, 1, 2]</code>: 定义了一个包含5个数值的列表，这些数值将作为第三组y轴的数据。</p></li><li><p><code>y = np.vstack([ay, by, cy])</code>: 使用NumPy的<code>vstack</code>函数将三组y轴数据堆叠在一起，形成一个2维数组。这样，<code>y</code>将成为一个包含3个子数组的数组，每个子数组代表一组y轴数据。</p></li><li><p><code>fig, ax = plt.subplots()</code>: 创建一个图形对象和一个坐标轴对象。<code>fig</code>代表整个图形窗口，<code>ax</code>代表图形中的坐标轴。</p></li><li><p><code>ax.stackplot(x, y)</code>: 在坐标轴<code>ax</code>上绘制堆叠区域图（stacked plot）。使用之前生成的x和y数组作为数据，堆叠区域图展示了每个x坐标对应的三组y值的堆叠区域。</p></li><li><p><code>ax.set(xlim=(0, 8), xticks=np.arange(1, 8), ylim=(0, 8), yticks=np.arange(1, 8))</code>: 设置坐标轴的范围和刻度。x轴范围设置为0到8，同时设置x轴刻度为从1到7的间隔为1的刻度。y轴范围设置为0到8，同时设置y轴刻度为从1到7的间隔为1的刻度。</p></li><li><p><code>plt.show()</code>: 显示绘制的图形。</p></li></ol><p>这段代码将绘制一个堆叠区域图，其中x轴的数据是从0开始的长度为5的等间隔数组，y轴的数据有三组，分别是<code>ay</code>、<code>by</code>和<code>cy</code>。堆叠区域图将显示三组y轴数据在每个x坐标处的堆叠区域，形成了多个不同颜色的堆叠区域。x轴范围是0到8，y轴范围是0到8，并且x和y轴都有间隔为1的刻度。</p><img src="https://matplotlib.org/stable/_images/sphx_glr_stackplot_001_2_00x.png" class="lazyload placeholder" data-srcset="https://matplotlib.org/stable/_images/sphx_glr_stackplot_001_2_00x.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="stackplot"><h3 id="热图"><a href="#热图" class="headerlink" title="热图"></a>热图</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">plt.style.use(<span class="string">&#x27;_mpl-gallery-nogrid&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># make data</span></span><br><span class="line">X, Y = np.meshgrid(np.linspace(-<span class="number">3</span>, <span class="number">3</span>, <span class="number">16</span>), np.linspace(-<span class="number">3</span>, <span class="number">3</span>, <span class="number">16</span>))</span><br><span class="line">Z = (<span class="number">1</span> - X/<span class="number">2</span> + X**<span class="number">5</span> + Y**<span class="number">3</span>) * np.exp(-X**<span class="number">2</span> - Y**<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># plot</span></span><br><span class="line">fig, ax = plt.subplots()</span><br><span class="line"></span><br><span class="line">ax.imshow(Z)</span><br><span class="line"></span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure><ol><li><p><code>import matplotlib.pyplot as plt</code>: 导入Matplotlib库，并将其简化为<code>plt</code>，这是Matplotlib中常用的惯例。</p></li><li><p><code>import numpy as np</code>: 导入NumPy库，并将其简化为<code>np</code>，NumPy是用于数值计算的Python库。</p></li><li><p><code>plt.style.use(&#39;_mpl-gallery-nogrid&#39;)</code>: 这里使用了一个自定义的Matplotlib样式<code>&#39;_mpl-gallery-nogrid&#39;</code>。Matplotlib样式用于设置图形的外观和风格。在此之前可能有一个自定义的样式定义，但代码片段中没有显示出来。</p></li><li><p><code>X, Y = np.meshgrid(np.linspace(-3, 3, 16), np.linspace(-3, 3, 16))</code>: 使用NumPy的<code>meshgrid</code>函数生成一个网格，其中X和Y分别是从-3到3的等间隔数组，长度为16。这将用于创建一个二维坐标系，其中X和Y分别表示x轴和y轴上的点。</p></li><li><p><code>Z = (1 - X/2 + X**5 + Y**3) * np.exp(-X**2 - Y**2)</code>: 使用X和Y数组计算出一个二维数组Z，其中的数值是根据给定的函数计算得到的。这个函数是 <code>(1 - X/2 + X**5 + Y**3) * np.exp(-X**2 - Y**2)</code>。</p></li><li><p><code>fig, ax = plt.subplots()</code>: 创建一个图形对象和一个坐标轴对象。<code>fig</code>代表整个图形窗口，<code>ax</code>代表图形中的坐标轴。</p></li><li><p><code>ax.imshow(Z)</code>: 在坐标轴<code>ax</code>上显示二维数组Z，这将以图像的形式显示出来。imshow函数会根据数组中的数值来着色，较大的数值将显示为较亮的颜色，较小的数值将显示为较暗的颜色。</p></li><li><p><code>plt.show()</code>: 显示绘制的图形。</p></li></ol><p>这段代码将绘制一个基于二维数组Z的图像。Z的数值是根据给定的函数计算得到的，然后使用imshow函数将二维数组Z以图像的形式显示出来。imshow函数将根据数组中的数值自动着色，形成一个具有明暗变化的图像。在这里，Z的值由X和Y的坐标计算得到，因此图像会显示一种呈现复杂图案的分布情况。</p><img src="https://matplotlib.org/stable/_images/sphx_glr_imshow_001_2_00x.png" class="lazyload placeholder" data-srcset="https://matplotlib.org/stable/_images/sphx_glr_imshow_001_2_00x.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="imshow"><h3 id="伪彩色图"><a href="#伪彩色图" class="headerlink" title="伪彩色图"></a>伪彩色图</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">plt.style.use(<span class="string">&#x27;_mpl-gallery-nogrid&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># make data with uneven sampling in x</span></span><br><span class="line">x = [-<span class="number">3</span>, -<span class="number">2</span>, -<span class="number">1.6</span>, -<span class="number">1.2</span>, -<span class="number">.8</span>, -<span class="number">.5</span>, -<span class="number">.2</span>, <span class="number">.1</span>, <span class="number">.3</span>, <span class="number">.5</span>, <span class="number">.8</span>, <span class="number">1.1</span>, <span class="number">1.5</span>, <span class="number">1.9</span>, <span class="number">2.3</span>, <span class="number">3</span>]</span><br><span class="line">X, Y = np.meshgrid(x, np.linspace(-<span class="number">3</span>, <span class="number">3</span>, <span class="number">128</span>))</span><br><span class="line">Z = (<span class="number">1</span> - X/<span class="number">2</span> + X**<span class="number">5</span> + Y**<span class="number">3</span>) * np.exp(-X**<span class="number">2</span> - Y**<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># plot</span></span><br><span class="line">fig, ax = plt.subplots()</span><br><span class="line"></span><br><span class="line">ax.pcolormesh(X, Y, Z, vmin=-<span class="number">0.5</span>, vmax=<span class="number">1.0</span>)</span><br><span class="line"></span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure><ol><li><p><code>import matplotlib.pyplot as plt</code>: 导入Matplotlib库，并将其简化为<code>plt</code>，这是Matplotlib中常用的惯例。</p></li><li><p><code>import numpy as np</code>: 导入NumPy库，并将其简化为<code>np</code>，NumPy是用于数值计算的Python库。</p></li><li><p><code>plt.style.use(&#39;_mpl-gallery-nogrid&#39;)</code>: 这里使用了一个自定义的Matplotlib样式<code>&#39;_mpl-gallery-nogrid&#39;</code>。Matplotlib样式用于设置图形的外观和风格。在此之前可能有一个自定义的样式定义，但代码片段中没有显示出来。</p></li><li><p><code>x = [-3, -2, -1.6, -1.2, -.8, -.5, -.2, .1, .3, .5, .8, 1.1, 1.5, 1.9, 2.3, 3]</code>: 定义了一个不规则的一维数组<code>x</code>，用于表示网格中的x坐标。这些x坐标是不均匀间隔的。</p></li><li><p><code>X, Y = np.meshgrid(x, np.linspace(-3, 3, 128))</code>: 使用<code>np.meshgrid</code>函数生成两个二维数组<code>X</code>和<code>Y</code>，其中<code>X</code>由不规则间隔的一维数组<code>x</code>和均匀间隔的一维数组<code>np.linspace(-3, 3, 128)</code>组成。<code>Y</code>由均匀间隔的一维数组<code>np.linspace(-3, 3, 128)</code>组成。生成的<code>X</code>和<code>Y</code>数组都是(16, 128)的形状，表示一个16行、128列的网格。</p></li><li><p><code>Z = (1 - X/2 + X**5 + Y**3) * np.exp(-X**2 - Y**2)</code>: 这行代码计算一个二维数组<code>Z</code>，数组中的每个元素是通过对应位置的<code>X</code>和<code>Y</code>坐标值代入一个特定的函数表达式得到的。这个函数表达式是 <code>(1 - X/2 + X**5 + Y**3) * np.exp(-X**2 - Y**2)</code>。在这里，我们使用了NumPy的广播功能，<code>X</code>和<code>Y</code>是同样大小的数组，所以它们进行元素级别的运算，从而生成一个新的二维数组<code>Z</code>。</p></li><li><p><code>fig, ax = plt.subplots()</code>: 创建一个图形对象和一个坐标轴对象。<code>fig</code>代表整个图形窗口，<code>ax</code>代表图形中的坐标轴。</p></li><li><p><code>ax.pcolormesh(X, Y, Z, vmin=-0.5, vmax=1.0)</code>: 使用<code>ax.pcolormesh</code>函数绘制伪彩色图。这个函数以<code>X</code>和<code>Y</code>作为网格坐标，将<code>Z</code>数组中的值作为颜色编码来填充网格，从而生成一个伪彩色图。<code>vmin=-0.5</code>和<code>vmax=1.0</code>分别设置了颜色编码的范围，这样可以将<code>Z</code>中小于-0.5的值映射为低值颜色，大于1.0的值映射为高值颜色。</p></li><li><p><code>plt.show()</code>: 显示绘制的图形。</p></li></ol><p>这段代码将绘制一个伪彩色图，其中网格的x坐标由不规则间隔的一维数组<code>x</code>表示，y坐标由均匀间隔的一维数组<code>np.linspace(-3, 3, 128)</code>表示。在伪彩色图中，颜色编码用于表示<code>Z</code>数组中的值，而<code>Z</code>数组的值是根据特定的函数计算得到的。通过颜色的变化，我们可以直观地看到<code>Z</code>随着<code>X</code>和<code>Y</code>的变化而发生的变化。</p><p>这个数学公式可以写为：</p><p>$$ Z &#x3D; (1 - \frac{X}{2} + X^5 + Y^3) \times e^{-X^2 - Y^2} $$</p><p>其中，$ X $ 和 $ Y $ 是网格坐标，$ Z $ 是根据 $ X $ 和 $ Y $ 计算的函数值。公式中包含了多项式和指数函数的运算。这个函数表达式用于生成一个二维数组 $ Z $，并在后续的代码中被用于绘制伪彩色图。</p><img src="https://matplotlib.org/stable/_images/sphx_glr_pcolormesh_001_2_00x.png" class="lazyload placeholder" data-srcset="https://matplotlib.org/stable/_images/sphx_glr_pcolormesh_001_2_00x.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="pcolormesh"><blockquote><p>热图（Heatmap）和伪彩色图（Pseudocolor Plot）都是用来可视化二维数据的图像表示方法，但它们在呈现数据的方式和目的上有一些区别。<br>    热图（Heatmap）：<br>    - 热图是一种常见的二维数据可视化方法，通常用于显示数据的分布、关联性或者密度。<br>      - 热图使用颜色来表示数据值的大小，其中颜色的明暗程度代表数据的相对大小。<br>      - 通常，较大的数值用较深的颜色表示，较小的数值用较浅的颜色表示，从而形成一个明暗变化的色阶。<br>      - 热图通常用于展示数据的整体结构和趋势，以及在不同位置的数据值之间的相对大小关系。<br>      - 例子：在基因表达数据分析中，热图可以用来显示不同基因在不同样本中的表达量，帮助研究基因的表达模式。<br>    伪彩色图（Pseudocolor Plot）：<br>    - 伪彩色图也是一种二维数据可视化方法，用于表示数据的变化和分布情况。<br>      - 伪彩色图使用颜色来编码数据的数值，不同颜色代表不同数值，而不仅仅是数据的大小。<br>      - 伪彩色图通常用于展示数据的细节和变化，以及在不同位置的具体数值。<br>      - 通常，可以通过设定颜色映射范围来控制颜色的分配，从而突出数据的特定范围或变化。<br>      - 例子：在物理模拟中，伪彩色图可以用来显示模拟结果的数值，例如温度分布、流速等。<br>    总体而言，热图更适合呈现数据的总体结构和相对关系，而伪彩色图更适合呈现数据的具体数值和细节变化。但在某些情况下，这两种图形方法可以相互转换或混用，具体要根据数据的特性和可视化的目的来选择适合的方法。</p></blockquote><h3 id="等高线图"><a href="#等高线图" class="headerlink" title="等高线图"></a>等高线图</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">plt.style.use(<span class="string">&#x27;_mpl-gallery-nogrid&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># make data</span></span><br><span class="line">X, Y = np.meshgrid(np.linspace(-<span class="number">3</span>, <span class="number">3</span>, <span class="number">256</span>), np.linspace(-<span class="number">3</span>, <span class="number">3</span>, <span class="number">256</span>))</span><br><span class="line">Z = (<span class="number">1</span> - X/<span class="number">2</span> + X**<span class="number">5</span> + Y**<span class="number">3</span>) * np.exp(-X**<span class="number">2</span> - Y**<span class="number">2</span>)</span><br><span class="line">levels = np.linspace(np.<span class="built_in">min</span>(Z), np.<span class="built_in">max</span>(Z), <span class="number">7</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># plot</span></span><br><span class="line">fig, ax = plt.subplots()</span><br><span class="line"></span><br><span class="line">ax.contour(X, Y, Z, levels=levels)</span><br><span class="line"></span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure><ol><li><p><code>import matplotlib.pyplot as plt</code>: 导入Matplotlib库，并将其简化为<code>plt</code>，这是Matplotlib中常用的惯例。</p></li><li><p><code>import numpy as np</code>: 导入NumPy库，并将其简化为<code>np</code>，NumPy是用于数值计算的Python库。</p></li><li><p><code>plt.style.use(&#39;_mpl-gallery-nogrid&#39;)</code>: 这里使用了一个自定义的Matplotlib样式<code>&#39;_mpl-gallery-nogrid&#39;</code>。Matplotlib样式用于设置图形的外观和风格。在此之前可能有一个自定义的样式定义，但代码片段中没有显示出来。</p></li><li><p><code>X, Y = np.meshgrid(np.linspace(-3, 3, 256), np.linspace(-3, 3, 256))</code>: 使用<code>np.meshgrid</code>函数生成两个二维数组<code>X</code>和<code>Y</code>，其中<code>X</code>由均匀间隔的一维数组<code>np.linspace(-3, 3, 256)</code>组成，<code>Y</code>也是由均匀间隔的一维数组<code>np.linspace(-3, 3, 256)</code>组成。生成的<code>X</code>和<code>Y</code>数组都是(256, 256)的形状，表示一个256x256的网格。</p></li><li><p><code>Z = (1 - X/2 + X**5 + Y**3) * np.exp(-X**2 - Y**2)</code>: 这行代码计算一个二维数组<code>Z</code>，数组中的每个元素是通过对应位置的<code>X</code>和<code>Y</code>坐标值代入一个特定的函数表达式得到的。这个函数表达式是 <code>(1 - X/2 + X**5 + Y**3) * np.exp(-X**2 - Y**2)</code>。在这里，我们使用了NumPy的广播功能，<code>X</code>和<code>Y</code>是同样大小的数组，所以它们进行元素级别的运算，从而生成一个新的二维数组<code>Z</code>。</p></li><li><p><code>levels = np.linspace(np.min(Z), np.max(Z), 7)</code>: 创建一个包含7个元素的一维数组<code>levels</code>，其中的数值是通过等间隔方式从<code>Z</code>数组的最小值到最大值生成的。这些数值将用于设置等高线图中的轮廓线的高度值。</p></li><li><p><code>fig, ax = plt.subplots()</code>: 创建一个图形对象和一个坐标轴对象。<code>fig</code>代表整个图形窗口，<code>ax</code>代表图形中的坐标轴。</p></li><li><p><code>ax.contour(X, Y, Z, levels=levels)</code>: 使用<code>ax.contour</code>函数绘制等高线图。这个函数以<code>X</code>和<code>Y</code>作为网格坐标，将<code>Z</code>数组中的值作为高度值来绘制等高线。通过设置<code>levels</code>参数，等高线图将在指定的高度值处绘制轮廓线。</p></li><li><p><code>plt.show()</code>: 显示绘制的图形。</p></li></ol><p>这段代码将绘制一个等高线图，其中网格的x坐标由均匀间隔的一维数组<code>np.linspace(-3, 3, 256)</code>表示，y坐标也由均匀间隔的一维数组<code>np.linspace(-3, 3, 256)</code>表示。在等高线图中，不同高度值对应的轮廓线将呈现出数据的变化和分布情况。通过观察轮廓线的分布和形状，我们可以了解函数在二维空间中的变化和特性。</p><img src="https://matplotlib.org/stable/_images/sphx_glr_contour_001_2_00x.png" class="lazyload placeholder" data-srcset="https://matplotlib.org/stable/_images/sphx_glr_contour_001_2_00x.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="contour"><h3 id="填充等高线图"><a href="#填充等高线图" class="headerlink" title="填充等高线图"></a>填充等高线图</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">plt.style.use(<span class="string">&#x27;_mpl-gallery-nogrid&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># make data</span></span><br><span class="line">X, Y = np.meshgrid(np.linspace(-<span class="number">3</span>, <span class="number">3</span>, <span class="number">256</span>), np.linspace(-<span class="number">3</span>, <span class="number">3</span>, <span class="number">256</span>))</span><br><span class="line">Z = (<span class="number">1</span> - X/<span class="number">2</span> + X**<span class="number">5</span> + Y**<span class="number">3</span>) * np.exp(-X**<span class="number">2</span> - Y**<span class="number">2</span>)</span><br><span class="line">levels = np.linspace(Z.<span class="built_in">min</span>(), Z.<span class="built_in">max</span>(), <span class="number">7</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># plot</span></span><br><span class="line">fig, ax = plt.subplots()</span><br><span class="line"></span><br><span class="line">ax.contourf(X, Y, Z, levels=levels)</span><br><span class="line"></span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure><ol><li><p><code>import matplotlib.pyplot as plt</code>: 导入Matplotlib库，并将其简化为<code>plt</code>，这是Matplotlib中常用的惯例。</p></li><li><p><code>import numpy as np</code>: 导入NumPy库，并将其简化为<code>np</code>，NumPy是用于数值计算的Python库。</p></li><li><p><code>plt.style.use(&#39;_mpl-gallery-nogrid&#39;)</code>: 这里使用了一个自定义的Matplotlib样式<code>&#39;_mpl-gallery-nogrid&#39;</code>。Matplotlib样式用于设置图形的外观和风格。在此之前可能有一个自定义的样式定义，但代码片段中没有显示出来。</p></li><li><p><code>X, Y = np.meshgrid(np.linspace(-3, 3, 256), np.linspace(-3, 3, 256))</code>: 使用<code>np.meshgrid</code>函数生成两个二维数组<code>X</code>和<code>Y</code>，其中<code>X</code>由均匀间隔的一维数组<code>np.linspace(-3, 3, 256)</code>组成，<code>Y</code>也是由均匀间隔的一维数组<code>np.linspace(-3, 3, 256)</code>组成。生成的<code>X</code>和<code>Y</code>数组都是(256, 256)的形状，表示一个256x256的网格。</p></li><li><p><code>Z = (1 - X/2 + X**5 + Y**3) * np.exp(-X**2 - Y**2)</code>: 这行代码计算一个二维数组<code>Z</code>，数组中的每个元素是通过对应位置的<code>X</code>和<code>Y</code>坐标值代入一个特定的函数表达式得到的。这个函数表达式是 <code>(1 - X/2 + X**5 + Y**3) * np.exp(-X**2 - Y**2)</code>。在这里，我们使用了NumPy的广播功能，<code>X</code>和<code>Y</code>是同样大小的数组，所以它们进行元素级别的运算，从而生成一个新的二维数组<code>Z</code>。</p></li><li><p><code>levels = np.linspace(Z.min(), Z.max(), 7)</code>: 创建一个包含7个元素的一维数组<code>levels</code>，其中的数值是通过等间隔方式从<code>Z</code>数组的最小值到最大值生成的。这些数值将用于设置填充等高线图中的色块的高度值。</p></li><li><p><code>fig, ax = plt.subplots()</code>: 创建一个图形对象和一个坐标轴对象。<code>fig</code>代表整个图形窗口，<code>ax</code>代表图形中的坐标轴。</p></li><li><p><code>ax.contourf(X, Y, Z, levels=levels)</code>: 使用<code>ax.contourf</code>函数绘制填充等高线图。这个函数以<code>X</code>和<code>Y</code>作为网格坐标，将<code>Z</code>数组中的值作为高度值来绘制填充等高线图。通过设置<code>levels</code>参数，填充等高线图将在指定的高度值处绘制色块。</p></li><li><p><code>plt.show()</code>: 显示绘制的图形。</p></li></ol><p>这段代码将绘制一个填充等高线图，其中网格的x坐标由均匀间隔的一维数组<code>np.linspace(-3, 3, 256)</code>表示，y坐标也由均匀间隔的一维数组<code>np.linspace(-3, 3, 256)</code>表示。在填充等高线图中，不同高度值对应的色块将呈现出数据的变化和分布情况，填充等高线图比普通的等高线图更突出数据的整体结构和趋势。通过观察色块的分布和形状，我们可以直观地了解函数在二维空间中的变化和特性。</p><img src="https://matplotlib.org/stable/_images/sphx_glr_contourf_001_2_00x.png" class="lazyload placeholder" data-srcset="https://matplotlib.org/stable/_images/sphx_glr_contourf_001_2_00x.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="contourf"><h3 id="风羽图"><a href="#风羽图" class="headerlink" title="风羽图"></a>风羽图</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">plt.style.use(<span class="string">&#x27;_mpl-gallery-nogrid&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># make data:</span></span><br><span class="line">X, Y = np.meshgrid([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>], [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>])</span><br><span class="line">angle = np.pi / <span class="number">180</span> * np.array([[<span class="number">15.</span>, <span class="number">30</span>, <span class="number">35</span>, <span class="number">45</span>],</span><br><span class="line">                                [<span class="number">25.</span>, <span class="number">40</span>, <span class="number">55</span>, <span class="number">60</span>],</span><br><span class="line">                                [<span class="number">35.</span>, <span class="number">50</span>, <span class="number">65</span>, <span class="number">75</span>],</span><br><span class="line">                                [<span class="number">45.</span>, <span class="number">60</span>, <span class="number">75</span>, <span class="number">90</span>]])</span><br><span class="line">amplitude = np.array([[<span class="number">5</span>, <span class="number">10</span>, <span class="number">25</span>, <span class="number">50</span>],</span><br><span class="line">                      [<span class="number">10</span>, <span class="number">15</span>, <span class="number">30</span>, <span class="number">60</span>],</span><br><span class="line">                      [<span class="number">15</span>, <span class="number">26</span>, <span class="number">50</span>, <span class="number">70</span>],</span><br><span class="line">                      [<span class="number">20</span>, <span class="number">45</span>, <span class="number">80</span>, <span class="number">100</span>]])</span><br><span class="line">U = amplitude * np.sin(angle)</span><br><span class="line">V = amplitude * np.cos(angle)</span><br><span class="line"></span><br><span class="line"><span class="comment"># plot:</span></span><br><span class="line">fig, ax = plt.subplots()</span><br><span class="line"></span><br><span class="line">ax.barbs(X, Y, U, V, barbcolor=<span class="string">&#x27;C0&#x27;</span>, flagcolor=<span class="string">&#x27;C0&#x27;</span>, length=<span class="number">7</span>, linewidth=<span class="number">1.5</span>)</span><br><span class="line"></span><br><span class="line">ax.<span class="built_in">set</span>(xlim=(<span class="number">0</span>, <span class="number">4.5</span>), ylim=(<span class="number">0</span>, <span class="number">4.5</span>))</span><br><span class="line"></span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure><ol><li><p><code>import matplotlib.pyplot as plt</code>: 导入Matplotlib库，并将其简化为<code>plt</code>，这是Matplotlib中常用的惯例。</p></li><li><p><code>import numpy as np</code>: 导入NumPy库，并将其简化为<code>np</code>，NumPy是用于数值计算的Python库。</p></li><li><p><code>plt.style.use(&#39;_mpl-gallery-nogrid&#39;)</code>: 这里使用了一个自定义的Matplotlib样式<code>&#39;_mpl-gallery-nogrid&#39;</code>。Matplotlib样式用于设置图形的外观和风格。在此之前可能有一个自定义的样式定义，但代码片段中没有显示出来。</p></li><li><p><code>X, Y = np.meshgrid([1, 2, 3, 4], [1, 2, 3, 4])</code>: 使用<code>np.meshgrid</code>函数生成两个二维数组<code>X</code>和<code>Y</code>，其中<code>X</code>由一维数组<code>[1, 2, 3, 4]</code>组成，<code>Y</code>也由一维数组<code>[1, 2, 3, 4]</code>组成。生成的<code>X</code>和<code>Y</code>数组都是(4, 4)的形状，表示一个4x4的网格，用于表示风羽图中的位置。</p></li><li><p><code>angle</code>和<code>amplitude</code>分别是两个(4, 4)的二维数组，分别表示风的角度（方向）和风速的大小。这些数据用于计算风的速度在x和y方向的分量，分别保存在<code>U</code>和<code>V</code>数组中。</p></li><li><p><code>U = amplitude * np.sin(angle)</code>: 这行代码计算风速在x方向的分量。</p></li><li><p><code>V = amplitude * np.cos(angle)</code>: 这行代码计算风速在y方向的分量。</p></li><li><p><code>fig, ax = plt.subplots()</code>: 创建一个图形对象和一个坐标轴对象。<code>fig</code>代表整个图形窗口，<code>ax</code>代表图形中的坐标轴。</p></li><li><p><code>ax.barbs(X, Y, U, V, barbcolor=&#39;C0&#39;, flagcolor=&#39;C0&#39;, length=7, linewidth=1.5)</code>: 使用<code>ax.barbs</code>函数绘制风羽图。这个函数以<code>X</code>和<code>Y</code>作为网格坐标，<code>U</code>和<code>V</code>分别作为风速在x和y方向的分量。<code>barbcolor</code>参数设置风羽的颜色，<code>flagcolor</code>参数设置风羽旗帜的颜色，<code>length</code>参数设置风羽的长度，<code>linewidth</code>参数设置风羽的线宽。</p></li><li><p><code>ax.set(xlim=(0, 4.5), ylim=(0, 4.5))</code>: 设置坐标轴的显示范围，以便风羽图完整显示在图形中。</p></li><li><p><code>plt.show()</code>: 显示绘制的图形。</p></li></ol><p>这段代码将绘制一个风羽图，其中风的方向和风速由<code>angle</code>和<code>amplitude</code>数组表示。风羽图中的每个风羽表示了风的方向和大小。风速越大，风羽的长度越长；风的方向由风羽的方向表示。通过观察风羽图，我们可以直观地了解风的分布和风向的变化。</p><img src="https://matplotlib.org/stable/_images/sphx_glr_barbs_001_2_00x.png" class="lazyload placeholder" data-srcset="https://matplotlib.org/stable/_images/sphx_glr_barbs_001_2_00x.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="barbs"><h3 id="矢量场图"><a href="#矢量场图" class="headerlink" title="矢量场图"></a>矢量场图</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">plt.style.use(<span class="string">&#x27;_mpl-gallery-nogrid&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># make data</span></span><br><span class="line">x = np.linspace(-<span class="number">4</span>, <span class="number">4</span>, <span class="number">6</span>)</span><br><span class="line">y = np.linspace(-<span class="number">4</span>, <span class="number">4</span>, <span class="number">6</span>)</span><br><span class="line">X, Y = np.meshgrid(x, y)</span><br><span class="line">U = X + Y</span><br><span class="line">V = Y - X</span><br><span class="line"></span><br><span class="line"><span class="comment"># plot</span></span><br><span class="line">fig, ax = plt.subplots()</span><br><span class="line"></span><br><span class="line">ax.quiver(X, Y, U, V, color=<span class="string">&quot;C0&quot;</span>, angles=<span class="string">&#x27;xy&#x27;</span>,</span><br><span class="line">          scale_units=<span class="string">&#x27;xy&#x27;</span>, scale=<span class="number">5</span>, width=<span class="number">.015</span>)</span><br><span class="line"></span><br><span class="line">ax.<span class="built_in">set</span>(xlim=(-<span class="number">5</span>, <span class="number">5</span>), ylim=(-<span class="number">5</span>, <span class="number">5</span>))</span><br><span class="line"></span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure><ol><li><p><code>import matplotlib.pyplot as plt</code>: 导入Matplotlib库，并将其简化为<code>plt</code>，这是Matplotlib中常用的惯例。</p></li><li><p><code>import numpy as np</code>: 导入NumPy库，并将其简化为<code>np</code>，NumPy是用于数值计算的Python库。</p></li><li><p><code>plt.style.use(&#39;_mpl-gallery-nogrid&#39;)</code>: 这里使用了一个自定义的Matplotlib样式<code>&#39;_mpl-gallery-nogrid&#39;</code>。Matplotlib样式用于设置图形的外观和风格。在此之前可能有一个自定义的样式定义，但代码片段中没有显示出来。</p></li><li><p><code>x = np.linspace(-4, 4, 6)</code>: 使用<code>np.linspace</code>函数创建一个包含6个均匀分布的点的数组，范围从-4到4。这个数组用于表示x轴上的坐标点。</p></li><li><p><code>y = np.linspace(-4, 4, 6)</code>: 使用<code>np.linspace</code>函数创建一个包含6个均匀分布的点的数组，范围从-4到4。这个数组用于表示y轴上的坐标点。</p></li><li><p><code>X, Y = np.meshgrid(x, y)</code>: 使用<code>np.meshgrid</code>函数生成两个二维数组<code>X</code>和<code>Y</code>，分别表示所有x轴和y轴坐标点的组合。在这个例子中，<code>X</code>和<code>Y</code>都是(6, 6)的形状，表示一个6x6的网格。</p></li><li><p><code>U = X + Y</code>: 这行代码计算矢量场中每个点的x轴分量。在这个例子中，x轴分量 <code>U</code> 是<code>X</code>和<code>Y</code>的和。</p></li><li><p><code>V = Y - X</code>: 这行代码计算矢量场中每个点的y轴分量。在这个例子中，y轴分量 <code>V</code> 是<code>Y</code>减去<code>X</code>。</p></li><li><p><code>fig, ax = plt.subplots()</code>: 创建一个图形对象和一个坐标轴对象。<code>fig</code>代表整个图形窗口，<code>ax</code>代表图形中的坐标轴。</p></li><li><p><code>ax.quiver(X, Y, U, V, color=&quot;C0&quot;, angles=&#39;xy&#39;, scale_units=&#39;xy&#39;, scale=5, width=.015)</code>: 使用<code>ax.quiver</code>函数绘制矢量场图。这个函数以<code>X</code>和<code>Y</code>作为网格坐标，<code>U</code>和<code>V</code>分别作为矢量场中每个点的x轴和y轴分量。<code>color=&quot;C0&quot;</code>设置箭头的颜色为蓝色，<code>angles=&#39;xy&#39;</code>表示箭头是使用x和y坐标轴来表示角度，<code>scale_units=&#39;xy&#39;</code>表示箭头的比例尺是相对于x和y坐标轴的单位，<code>scale=5</code>设置箭头的比例尺为5，<code>width=.015</code>设置箭头的宽度为0.015。</p></li><li><p><code>ax.set(xlim=(-5, 5), ylim=(-5, 5))</code>: 设置坐标轴的显示范围，以便矢量场图完整显示在图形中。</p></li><li><p><code>plt.show()</code>: 显示绘制的图形。</p></li></ol><p>这段代码将绘制一个矢量场图，其中每个箭头表示矢量场中的一个点。箭头的位置由<code>X</code>和<code>Y</code>数组确定，箭头的方向和大小由<code>U</code>和<code>V</code>数组决定。箭头的方向表示在每个点的x和y方向上的分量，箭头的长度和宽度则决定了箭头的大小。通过观察矢量场图，我们可以直观地了解矢量场在不同位置的方向和大小。</p><img src="https://matplotlib.org/stable/_images/sphx_glr_quiver_001_2_00x.png" class="lazyload placeholder" data-srcset="https://matplotlib.org/stable/_images/sphx_glr_quiver_001_2_00x.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="quiver"><h3 id="流线图"><a href="#流线图" class="headerlink" title="流线图"></a>流线图</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">plt.style.use(<span class="string">&#x27;_mpl-gallery-nogrid&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># make a stream function:</span></span><br><span class="line">X, Y = np.meshgrid(np.linspace(-<span class="number">3</span>, <span class="number">3</span>, <span class="number">256</span>), np.linspace(-<span class="number">3</span>, <span class="number">3</span>, <span class="number">256</span>))</span><br><span class="line">Z = (<span class="number">1</span> - X/<span class="number">2</span> + X**<span class="number">5</span> + Y**<span class="number">3</span>) * np.exp(-X**<span class="number">2</span> - Y**<span class="number">2</span>)</span><br><span class="line"><span class="comment"># make U and V out of the streamfunction:</span></span><br><span class="line">V = np.diff(Z[<span class="number">1</span>:, :], axis=<span class="number">1</span>)</span><br><span class="line">U = -np.diff(Z[:, <span class="number">1</span>:], axis=<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># plot:</span></span><br><span class="line">fig, ax = plt.subplots()</span><br><span class="line"></span><br><span class="line">ax.streamplot(X[<span class="number">1</span>:, <span class="number">1</span>:], Y[<span class="number">1</span>:, <span class="number">1</span>:], U, V)</span><br><span class="line"></span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure><ol><li><p><code>import matplotlib.pyplot as plt</code>: 导入Matplotlib库，并将其简化为<code>plt</code>，这是Matplotlib中常用的惯例。</p></li><li><p><code>import numpy as np</code>: 导入NumPy库，并将其简化为<code>np</code>，NumPy是用于数值计算的Python库。</p></li><li><p><code>plt.style.use(&#39;_mpl-gallery-nogrid&#39;)</code>: 这里使用了一个自定义的Matplotlib样式<code>&#39;_mpl-gallery-nogrid&#39;</code>。Matplotlib样式用于设置图形的外观和风格。在此之前可能有一个自定义的样式定义，但代码片段中没有显示出来。</p></li><li><p><code>X, Y = np.meshgrid(np.linspace(-3, 3, 256), np.linspace(-3, 3, 256))</code>: 使用<code>np.meshgrid</code>函数生成两个二维数组<code>X</code>和<code>Y</code>，分别表示从-3到3范围内均匀分布的256个点的网格。这些数组将用于表示流场中的坐标点。</p></li><li><p><code>Z = (1 - X/2 + X**5 + Y**3) * np.exp(-X**2 - Y**2)</code>: 这行代码计算流函数 <code>Z</code>。流函数是一个标量场函数，它通常用于描述流体流动的速度分布。在这个例子中，<code>Z</code> 是根据给定的公式计算得到的，它是关于 <code>X</code> 和 <code>Y</code> 的函数。</p></li><li><p><code>V = np.diff(Z[1:, :], axis=1)</code>: 这行代码计算速度场中每个点的y轴分量。在这个例子中，y轴分量 <code>V</code> 是 <code>Z</code> 数组在y方向上的差分。</p></li><li><p><code>U = -np.diff(Z[:, 1:], axis=0)</code>: 这行代码计算速度场中每个点的x轴分量。在这个例子中，x轴分量 <code>U</code> 是 <code>Z</code> 数组在x方向上的差分，注意差分得到的结果要取负号。</p></li><li><p><code>fig, ax = plt.subplots()</code>: 创建一个图形对象和一个坐标轴对象。<code>fig</code>代表整个图形窗口，<code>ax</code>代表图形中的坐标轴。</p></li><li><p><code>ax.streamplot(X[1:, 1:], Y[1:, 1:], U, V)</code>: 使用<code>ax.streamplot</code>函数绘制流线图。这个函数以 <code>X[1:, 1:]</code> 和 <code>Y[1:, 1:]</code> 作为网格坐标，<code>U</code> 和 <code>V</code> 作为速度场中每个点的x轴和y轴分量。<code>streamplot</code>函数会根据速度场的信息绘制出流线，并展示流体在给定流场中的运动。</p></li><li><p><code>plt.show()</code>: 显示绘制的图形。</p></li></ol><p>这段代码将绘制一个流线图，其中流线表示在给定的流场中流体的运动情况。流线的分布和形态展示了流体在该流场中的运动轨迹和速度分布。通过观察流线图，我们可以了解流体在不同位置的运动方向和速度。</p><img src="https://matplotlib.org/stable/_images/sphx_glr_streamplot_001_2_00x.png" class="lazyload placeholder" data-srcset="https://matplotlib.org/stable/_images/sphx_glr_streamplot_001_2_00x.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="streamplot"><h3 id="直方图"><a href="#直方图" class="headerlink" title="直方图"></a>直方图</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">plt.style.use(<span class="string">&#x27;_mpl-gallery&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># make data</span></span><br><span class="line">np.random.seed(<span class="number">1</span>)</span><br><span class="line">x = <span class="number">4</span> + np.random.normal(<span class="number">0</span>, <span class="number">1.5</span>, <span class="number">200</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># plot:</span></span><br><span class="line">fig, ax = plt.subplots()</span><br><span class="line"></span><br><span class="line">ax.hist(x, bins=<span class="number">8</span>, linewidth=<span class="number">0.5</span>, edgecolor=<span class="string">&quot;white&quot;</span>)</span><br><span class="line"></span><br><span class="line">ax.<span class="built_in">set</span>(xlim=(<span class="number">0</span>, <span class="number">8</span>), xticks=np.arange(<span class="number">1</span>, <span class="number">8</span>),</span><br><span class="line">       ylim=(<span class="number">0</span>, <span class="number">56</span>), yticks=np.linspace(<span class="number">0</span>, <span class="number">56</span>, <span class="number">9</span>))</span><br><span class="line"></span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure><ol><li><p><code>import matplotlib.pyplot as plt</code>: 导入Matplotlib库，并将其简化为<code>plt</code>，这是Matplotlib中常用的惯例。</p></li><li><p><code>import numpy as np</code>: 导入NumPy库，并将其简化为<code>np</code>，NumPy是用于数值计算的Python库。</p></li><li><p><code>plt.style.use(&#39;_mpl-gallery&#39;)</code>: 这里使用了一个自定义的Matplotlib样式<code>&#39;_mpl-gallery&#39;</code>。Matplotlib样式用于设置图形的外观和风格。在此之前可能有一个自定义的样式定义，但代码片段中没有显示出来。</p></li><li><p><code>np.random.seed(1)</code>: 设置随机数种子，保证每次运行代码生成的随机数据都是一样的，便于复现结果。</p></li><li><p><code>x = 4 + np.random.normal(0, 1.5, 200)</code>: 使用<code>np.random.normal</code>生成一个包含200个随机数的数据集 <code>x</code>。这些随机数是从均值为4、标准差为1.5的正态分布中随机抽取的。</p></li><li><p><code>fig, ax = plt.subplots()</code>: 创建一个图形对象和一个坐标轴对象。<code>fig</code>代表整个图形窗口，<code>ax</code>代表图形中的坐标轴。</p></li><li><p><code>ax.hist(x, bins=8, linewidth=0.5, edgecolor=&quot;white&quot;)</code>: 使用<code>ax.hist</code>函数绘制直方图。该函数以数据集 <code>x</code> 为输入，<code>bins=8</code>指定了直方图的箱数为8，即直方图将被分成8个箱子，<code>linewidth=0.5</code>设置直方图边界线的宽度为0.5，<code>edgecolor=&quot;white&quot;</code>设置直方图边界线的颜色为白色。</p></li><li><p><code>ax.set(xlim=(0, 8), xticks=np.arange(1, 8), ylim=(0, 56), yticks=np.linspace(0, 56, 9))</code>: 使用<code>ax.set</code>方法设置坐标轴的显示范围和刻度。<code>xlim=(0, 8)</code>设置x轴显示范围为0到8，<code>xticks=np.arange(1, 8)</code>设置x轴刻度为从1到7的整数刻度，<code>ylim=(0, 56)</code>设置y轴显示范围为0到56，<code>yticks=np.linspace(0, 56, 9)</code>设置y轴刻度为0到56之间等间距的9个刻度。</p></li><li><p><code>plt.show()</code>: 显示绘制的图形。</p></li></ol><p>这段代码将绘制一个直方图，其中每个箱子表示数据集 <code>x</code> 在相应范围内的数据个数。通过观察直方图，我们可以了解数据集 <code>x</code> 的分布情况，以及数据在不同区间的频次分布。直方图是一种常用的数据可视化方法，用于对数据进行初步的统计和分布分析。</p><img src="https://matplotlib.org/stable/_images/sphx_glr_hist_plot_001_2_00x.png" class="lazyload placeholder" data-srcset="https://matplotlib.org/stable/_images/sphx_glr_hist_plot_001_2_00x.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="hist"><h3 id="箱线图"><a href="#箱线图" class="headerlink" title="箱线图"></a>箱线图</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">plt.style.use(<span class="string">&#x27;_mpl-gallery&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># make data:</span></span><br><span class="line">np.random.seed(<span class="number">10</span>)</span><br><span class="line">D = np.random.normal((<span class="number">3</span>, <span class="number">5</span>, <span class="number">4</span>), (<span class="number">1.25</span>, <span class="number">1.00</span>, <span class="number">1.25</span>), (<span class="number">100</span>, <span class="number">3</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># plot</span></span><br><span class="line">fig, ax = plt.subplots()</span><br><span class="line">VP = ax.boxplot(D, positions=[<span class="number">2</span>, <span class="number">4</span>, <span class="number">6</span>], widths=<span class="number">1.5</span>, patch_artist=<span class="literal">True</span>,</span><br><span class="line">                showmeans=<span class="literal">False</span>, showfliers=<span class="literal">False</span>,</span><br><span class="line">                medianprops=&#123;<span class="string">&quot;color&quot;</span>: <span class="string">&quot;white&quot;</span>, <span class="string">&quot;linewidth&quot;</span>: <span class="number">0.5</span>&#125;,</span><br><span class="line">                boxprops=&#123;<span class="string">&quot;facecolor&quot;</span>: <span class="string">&quot;C0&quot;</span>, <span class="string">&quot;edgecolor&quot;</span>: <span class="string">&quot;white&quot;</span>,</span><br><span class="line">                          <span class="string">&quot;linewidth&quot;</span>: <span class="number">0.5</span>&#125;,</span><br><span class="line">                whiskerprops=&#123;<span class="string">&quot;color&quot;</span>: <span class="string">&quot;C0&quot;</span>, <span class="string">&quot;linewidth&quot;</span>: <span class="number">1.5</span>&#125;,</span><br><span class="line">                capprops=&#123;<span class="string">&quot;color&quot;</span>: <span class="string">&quot;C0&quot;</span>, <span class="string">&quot;linewidth&quot;</span>: <span class="number">1.5</span>&#125;)</span><br><span class="line"></span><br><span class="line">ax.<span class="built_in">set</span>(xlim=(<span class="number">0</span>, <span class="number">8</span>), xticks=np.arange(<span class="number">1</span>, <span class="number">8</span>),</span><br><span class="line">       ylim=(<span class="number">0</span>, <span class="number">8</span>), yticks=np.arange(<span class="number">1</span>, <span class="number">8</span>))</span><br><span class="line"></span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure><ol><li><p><code>import matplotlib.pyplot as plt</code>: 导入Matplotlib库，并将其简化为<code>plt</code>，这是Matplotlib中常用的惯例。</p></li><li><p><code>import numpy as np</code>: 导入NumPy库，并将其简化为<code>np</code>，NumPy是用于数值计算的Python库。</p></li><li><p><code>plt.style.use(&#39;_mpl-gallery&#39;)</code>: 这里使用了一个自定义的Matplotlib样式<code>&#39;_mpl-gallery&#39;</code>。Matplotlib样式用于设置图形的外观和风格。在此之前可能有一个自定义的样式定义，但代码片段中没有显示出来。</p></li><li><p><code>np.random.seed(10)</code>: 设置随机数种子，保证每次运行代码生成的随机数据都是一样的，便于复现结果。</p></li><li><p><code>D = np.random.normal((3, 5, 4), (1.25, 1.00, 1.25), (100, 3))</code>: 使用<code>np.random.normal</code>生成三个包含100个随机数的数据集，每个数据集对应一个正态分布。其中 <code>(3, 5, 4)</code> 是均值，<code>(1.25, 1.00, 1.25)</code> 是标准差，<code>(100, 3)</code> 是生成的数据集的形状。</p></li><li><p><code>fig, ax = plt.subplots()</code>: 创建一个图形对象和一个坐标轴对象。<code>fig</code>代表整个图形窗口，<code>ax</code>代表图形中的坐标轴。</p></li><li><p><code>ax.boxplot(D, positions=[2, 4, 6], widths=1.5, patch_artist=True, ...)</code>：使用<code>ax.boxplot</code>函数绘制箱线图。<code>D</code> 是要绘制的数据集，<code>positions=[2, 4, 6]</code> 设置了每个箱线图的位置，即将三个数据集绘制在x轴上的位置为2、4和6。<code>widths=1.5</code> 设置了每个箱线图的宽度为1.5。<code>patch_artist=True</code> 设置箱体用填充方式绘制。<code>showmeans=False</code> 和 <code>showfliers=False</code> 分别设置不显示均值和离群值。<code>medianprops</code>、<code>boxprops</code>、<code>whiskerprops</code> 和 <code>capprops</code> 参数用于设置箱线图中各个部分的属性，例如箱体、中位数线、箱须线和箱顶线的颜色和宽度。</p></li><li><p><code>ax.set(xlim=(0, 8), xticks=np.arange(1, 8), ylim=(0, 8), yticks=np.arange(1, 8))</code>: 使用<code>ax.set</code>方法设置坐标轴的显示范围和刻度。<code>xlim=(0, 8)</code>设置x轴显示范围为0到8，<code>xticks=np.arange(1, 8)</code>设置x轴刻度为从1到7的整数刻度，<code>ylim=(0, 8)</code>设置y轴显示范围为0到8，<code>yticks=np.arange(1, 8)</code>设置y轴刻度为从1到7的整数刻度。</p></li><li><p><code>plt.show()</code>: 显示绘制的图形。</p></li></ol><p>这段代码将绘制一个箱线图，其中每个箱线图表示一个数据集的分布情况。箱线图展示了数据的中位数、上下四分位数和离群值等统计特征，可以帮助我们快速了解数据的分布和异常值情况。</p><p>箱线图是一种常用的数据可视化工具，用于展示数据的分布情况和离群值。通过观察箱线图，你可以了解数据的中位数、四分位数、离群值等统计信息，从而更好地理解数据的整体分布和异常情况。</p><p>以下是如何看箱线图的一些方法：</p><ol><li><p><strong>箱体：</strong> 箱线图的主要部分是箱体，它表示数据的四分位数范围。箱体的底边界和顶边界分别对应第一四分位数（Q1）和第三四分位数（Q3）。箱体的中间线表示中位数（Q2），即数据的中值。箱体的高度反映了数据的离散程度，越高表示数据的变异性越大。</p></li><li><p><strong>箱须线：</strong> 箱线图的箱须线延伸出箱体，表示数据的范围。上边的箱须线通常表示数据中的最大值（除去离群值），下边的箱须线表示数据中的最小值（除去离群值）。箱须线可以帮助你了解数据的整体范围。</p></li><li><p><strong>离群值：</strong> 离群值是指数据中明显偏离其他数据的值。在箱线图中，通常将离群值单独表示为散点或小圆圈。离群值可能是数据中的异常值，也可能表示了数据的特殊情况。通过观察离群值，你可以判断数据中是否存在异常或特殊的观测值。</p></li><li><p><strong>比较箱线图：</strong> 如果有多个数据集的箱线图在同一张图中显示，你可以通过比较它们来观察数据的差异和共性。比较不同箱线图可以帮助你发现数据之间的异同，以及是否存在某种趋势或模式。</p></li><li><p><strong>偏态和尾重：</strong> 箱线图也可以用来观察数据的偏态（Skewness）和尾重（Heavy Tails）。偏态表示数据分布的不对称程度，正偏态表示数据右侧较长，负偏态表示数据左侧较长。尾重表示数据分布的尾部概率密度较大，尾部的概率分布比较重。</p></li><li><p><strong>异常检测：</strong> 箱线图可以用于识别数据中的异常值。通常，超出箱须线的数据点可能是离群值或异常值，值得注意和进一步调查。</p></li></ol><p>通过合理观察和解释箱线图的各个元素，你可以得到关于数据分布、偏态、异常值等方面的直观认识，并从中获取对数据的洞察和见解。</p><img src="https://matplotlib.org/stable/_images/sphx_glr_boxplot_plot_001_2_00x.png" class="lazyload placeholder" data-srcset="https://matplotlib.org/stable/_images/sphx_glr_boxplot_plot_001_2_00x.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="boxplot"><h3 id="误差线图"><a href="#误差线图" class="headerlink" title="误差线图"></a>误差线图</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">plt.style.use(<span class="string">&#x27;_mpl-gallery&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># make data:</span></span><br><span class="line">np.random.seed(<span class="number">1</span>)</span><br><span class="line">x = [<span class="number">2</span>, <span class="number">4</span>, <span class="number">6</span>]</span><br><span class="line">y = [<span class="number">3.6</span>, <span class="number">5</span>, <span class="number">4.2</span>]</span><br><span class="line">yerr = [<span class="number">0.9</span>, <span class="number">1.2</span>, <span class="number">0.5</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># plot:</span></span><br><span class="line">fig, ax = plt.subplots()</span><br><span class="line"></span><br><span class="line">ax.errorbar(x, y, yerr, fmt=<span class="string">&#x27;o&#x27;</span>, linewidth=<span class="number">2</span>, capsize=<span class="number">6</span>)</span><br><span class="line"></span><br><span class="line">ax.<span class="built_in">set</span>(xlim=(<span class="number">0</span>, <span class="number">8</span>), xticks=np.arange(<span class="number">1</span>, <span class="number">8</span>),</span><br><span class="line">       ylim=(<span class="number">0</span>, <span class="number">8</span>), yticks=np.arange(<span class="number">1</span>, <span class="number">8</span>))</span><br><span class="line"></span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure><ol><li><p><code>import matplotlib.pyplot as plt</code>: 导入Matplotlib库，并将其简化为<code>plt</code>，这是Matplotlib中常用的惯例。</p></li><li><p><code>import numpy as np</code>: 导入NumPy库，并将其简化为<code>np</code>，NumPy是用于数值计算的Python库。</p></li><li><p><code>plt.style.use(&#39;_mpl-gallery&#39;)</code>: 这里使用了一个自定义的Matplotlib样式<code>&#39;_mpl-gallery&#39;</code>。Matplotlib样式用于设置图形的外观和风格。在此之前可能有一个自定义的样式定义，但代码片段中没有显示出来。</p></li><li><p><code>np.random.seed(1)</code>: 设置随机数种子，保证每次运行代码生成的随机数据都是一样的，便于复现结果。</p></li><li><p><code>x = [2, 4, 6]</code>: 定义一个包含3个x坐标的列表。</p></li><li><p><code>y = [3.6, 5, 4.2]</code>: 定义一个包含3个y坐标的列表，这些y坐标表示在相应x位置上的测量值。</p></li><li><p><code>yerr = [0.9, 1.2, 0.5]</code>: 定义一个包含3个y误差的列表，表示在相应x位置上的测量值的误差范围。</p></li><li><p><code>fig, ax = plt.subplots()</code>: 创建一个图形对象和一个坐标轴对象。<code>fig</code>代表整个图形窗口，<code>ax</code>代表图形中的坐标轴。</p></li><li><p><code>ax.errorbar(x, y, yerr, fmt=&#39;o&#39;, linewidth=2, capsize=6)</code>: 使用<code>ax.errorbar</code>函数绘制带有误差线的散点图。<code>x</code>和<code>y</code>是散点的横纵坐标数据，<code>yerr</code>是y方向的误差范围。<code>fmt=&#39;o&#39;</code>指定散点的形状为圆点，<code>linewidth=2</code>设置误差线的宽度为2，<code>capsize=6</code>设置误差线两端的横线长度为6。</p></li><li><p><code>ax.set(xlim=(0, 8), xticks=np.arange(1, 8), ylim=(0, 8), yticks=np.arange(1, 8))</code>: 使用<code>ax.set</code>方法设置坐标轴的显示范围和刻度。<code>xlim=(0, 8)</code>设置x轴显示范围为0到8，<code>xticks=np.arange(1, 8)</code>设置x轴刻度为从1到7的整数刻度，<code>ylim=(0, 8)</code>设置y轴显示范围为0到8，<code>yticks=np.arange(1, 8)</code>设置y轴刻度为从1到7的整数刻度。</p></li><li><p><code>plt.show()</code>: 显示绘制的图形。</p></li></ol><p>这段代码将绘制一个带有误差线的散点图，其中每个散点表示在相应x位置上的测量值，误差线表示了在相应x位置上的测量值的误差范围。带误差线的散点图可以帮助我们了解数据的可靠性和测量误差。</p><img src="https://matplotlib.org/stable/_images/sphx_glr_errorbar_plot_001_2_00x.png" class="lazyload placeholder" data-srcset="https://matplotlib.org/stable/_images/sphx_glr_errorbar_plot_001_2_00x.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="errorbar"><h3 id="小提琴图"><a href="#小提琴图" class="headerlink" title="小提琴图"></a>小提琴图</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">plt.style.use(<span class="string">&#x27;_mpl-gallery&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># make data:</span></span><br><span class="line">np.random.seed(<span class="number">10</span>)</span><br><span class="line">D = np.random.normal((<span class="number">3</span>, <span class="number">5</span>, <span class="number">4</span>), (<span class="number">0.75</span>, <span class="number">1.00</span>, <span class="number">0.75</span>), (<span class="number">200</span>, <span class="number">3</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># plot:</span></span><br><span class="line">fig, ax = plt.subplots()</span><br><span class="line"></span><br><span class="line">vp = ax.violinplot(D, [<span class="number">2</span>, <span class="number">4</span>, <span class="number">6</span>], widths=<span class="number">2</span>,</span><br><span class="line">                   showmeans=<span class="literal">False</span>, showmedians=<span class="literal">False</span>, showextrema=<span class="literal">False</span>)</span><br><span class="line"><span class="comment"># styling:</span></span><br><span class="line"><span class="keyword">for</span> body <span class="keyword">in</span> vp[<span class="string">&#x27;bodies&#x27;</span>]:</span><br><span class="line">    body.set_alpha(<span class="number">0.9</span>)</span><br><span class="line">ax.<span class="built_in">set</span>(xlim=(<span class="number">0</span>, <span class="number">8</span>), xticks=np.arange(<span class="number">1</span>, <span class="number">8</span>),</span><br><span class="line">       ylim=(<span class="number">0</span>, <span class="number">8</span>), yticks=np.arange(<span class="number">1</span>, <span class="number">8</span>))</span><br><span class="line"></span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure><ol><li><p><code>import matplotlib.pyplot as plt</code>: 导入Matplotlib库，并将其简化为<code>plt</code>，这是Matplotlib中常用的惯例。</p></li><li><p><code>import numpy as np</code>: 导入NumPy库，并将其简化为<code>np</code>，NumPy是用于数值计算的Python库。</p></li><li><p><code>plt.style.use(&#39;_mpl-gallery&#39;)</code>: 这里使用了一个自定义的Matplotlib样式<code>&#39;_mpl-gallery&#39;</code>。Matplotlib样式用于设置图形的外观和风格。在此之前可能有一个自定义的样式定义，但代码片段中没有显示出来。</p></li><li><p><code>np.random.seed(10)</code>: 设置随机数种子，保证每次运行代码生成的随机数据都是一样的，便于复现结果。</p></li><li><p><code>D = np.random.normal((3, 5, 4), (0.75, 1.00, 0.75), (200, 3))</code>: 使用<code>np.random.normal</code>生成三组包含200个随机数的数据集，每组数据集对应一个正态分布。其中 <code>(3, 5, 4)</code> 是均值，<code>(0.75, 1.00, 0.75)</code> 是标准差，<code>(200, 3)</code> 是生成的数据集的形状。</p></li><li><p><code>fig, ax = plt.subplots()</code>: 创建一个图形对象和一个坐标轴对象。<code>fig</code>代表整个图形窗口，<code>ax</code>代表图形中的坐标轴。</p></li><li><p><code>vp = ax.violinplot(D, [2, 4, 6], widths=2, showmeans=False, showmedians=False, showextrema=False)</code>: 使用<code>ax.violinplot</code>函数绘制小提琴图。<code>D</code> 是要绘制的数据集，<code>[2, 4, 6]</code> 设置了每个小提琴图的位置，即将三个数据集绘制在x轴上的位置为2、4和6。<code>widths=2</code> 设置了小提琴图的宽度为2。<code>showmeans=False</code>、<code>showmedians=False</code> 和 <code>showextrema=False</code> 分别设置不显示均值、中位数和极值线。小提琴图通过核密度估计展示了数据的分布情况。</p></li><li><p><code>for body in vp[&#39;bodies&#39;]: body.set_alpha(0.9)</code>: 对小提琴图的主体进行样式设置，将其透明度设置为0.9。</p></li><li><p><code>ax.set(xlim=(0, 8), xticks=np.arange(1, 8), ylim=(0, 8), yticks=np.arange(1, 8))</code>: 使用<code>ax.set</code>方法设置坐标轴的显示范围和刻度。<code>xlim=(0, 8)</code>设置x轴显示范围为0到8，<code>xticks=np.arange(1, 8)</code>设置x轴刻度为从1到7的整数刻度，<code>ylim=(0, 8)</code>设置y轴显示范围为0到8，<code>yticks=np.arange(1, 8)</code>设置y轴刻度为从1到7的整数刻度。</p></li><li><p><code>plt.show()</code>: 显示绘制的图形。</p></li></ol><p>这段代码将绘制三个小提琴图，每个小提琴图代表一个数据集的分布情况。小提琴图可以帮助我们直观地了解数据的分布及其密度，从而更好地理解数据集的特征和统计属性。</p><img src="https://matplotlib.org/stable/_images/sphx_glr_violin_001_2_00x.png" class="lazyload placeholder" data-srcset="https://matplotlib.org/stable/_images/sphx_glr_violin_001_2_00x.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="violinplot"><h3 id="事件图"><a href="#事件图" class="headerlink" title="事件图"></a>事件图</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">plt.style.use(<span class="string">&#x27;_mpl-gallery&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># make data:</span></span><br><span class="line">np.random.seed(<span class="number">1</span>)</span><br><span class="line">x = [<span class="number">2</span>, <span class="number">4</span>, <span class="number">6</span>]</span><br><span class="line">D = np.random.gamma(<span class="number">4</span>, size=(<span class="number">3</span>, <span class="number">50</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># plot:</span></span><br><span class="line">fig, ax = plt.subplots()</span><br><span class="line"></span><br><span class="line">ax.eventplot(D, orientation=<span class="string">&quot;vertical&quot;</span>, lineoffsets=x, linewidth=<span class="number">0.75</span>)</span><br><span class="line"></span><br><span class="line">ax.<span class="built_in">set</span>(xlim=(<span class="number">0</span>, <span class="number">8</span>), xticks=np.arange(<span class="number">1</span>, <span class="number">8</span>),</span><br><span class="line">       ylim=(<span class="number">0</span>, <span class="number">8</span>), yticks=np.arange(<span class="number">1</span>, <span class="number">8</span>))</span><br><span class="line"></span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure><ol><li><p><code>import matplotlib.pyplot as plt</code>: 导入Matplotlib库，并将其简化为<code>plt</code>，这是Matplotlib中常用的惯例。</p></li><li><p><code>import numpy as np</code>: 导入NumPy库，并将其简化为<code>np</code>，NumPy是用于数值计算的Python库。</p></li><li><p><code>plt.style.use(&#39;_mpl-gallery&#39;)</code>: 这里使用了一个自定义的Matplotlib样式<code>&#39;_mpl-gallery&#39;</code>。Matplotlib样式用于设置图形的外观和风格。在此之前可能有一个自定义的样式定义，但代码片段中没有显示出来。</p></li><li><p><code>np.random.seed(1)</code>: 设置随机数种子，保证每次运行代码生成的随机数据都是一样的，便于复现结果。</p></li><li><p><code>x = [2, 4, 6]</code>: 定义一个包含3个x坐标的列表。</p></li><li><p><code>D = np.random.gamma(4, size=(3, 50))</code>: 使用<code>np.random.gamma</code>生成三个数据集，每个数据集包含50个从Gamma分布中随机生成的值。Gamma分布是一种常见的概率分布，它在许多领域中都有应用。</p></li><li><p><code>fig, ax = plt.subplots()</code>: 创建一个图形对象和一个坐标轴对象。<code>fig</code>代表整个图形窗口，<code>ax</code>代表图形中的坐标轴。</p></li><li><p><code>ax.eventplot(D, orientation=&quot;vertical&quot;, lineoffsets=x, linewidth=0.75)</code>: 使用<code>ax.eventplot</code>函数绘制事件图。<code>D</code> 是要绘制的数据集，<code>orientation=&quot;vertical&quot;</code> 指定事件图的方向为垂直方向。<code>lineoffsets=x</code> 设置了事件图的x坐标位置，即将三个数据集绘制在x轴上的位置为2、4和6。<code>linewidth=0.75</code> 设置事件图的线宽为0.75。</p></li><li><p><code>ax.set(xlim=(0, 8), xticks=np.arange(1, 8), ylim=(0, 8), yticks=np.arange(1, 8))</code>: 使用<code>ax.set</code>方法设置坐标轴的显示范围和刻度。<code>xlim=(0, 8)</code>设置x轴显示范围为0到8，<code>xticks=np.arange(1, 8)</code>设置x轴刻度为从1到7的整数刻度，<code>ylim=(0, 8)</code>设置y轴显示范围为0到8，<code>yticks=np.arange(1, 8)</code>设置y轴刻度为从1到7的整数刻度。</p></li><li><p><code>plt.show()</code>: 显示绘制的图形。</p></li></ol><p>这段代码将绘制三个事件图，每个事件图代表一个数据集的事件发生情况。事件图可以用于可视化数据中的事件发生次数或发生时间，帮助我们了解数据的分布和事件之间的关联性。</p><img src="https://matplotlib.org/stable/_images/sphx_glr_eventplot_001_2_00x.png" class="lazyload placeholder" data-srcset="https://matplotlib.org/stable/_images/sphx_glr_eventplot_001_2_00x.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="eventplot"><h3 id="二维直方图"><a href="#二维直方图" class="headerlink" title="二维直方图"></a>二维直方图</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">plt.style.use(<span class="string">&#x27;_mpl-gallery-nogrid&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># make data: correlated + noise</span></span><br><span class="line">np.random.seed(<span class="number">1</span>)</span><br><span class="line">x = np.random.randn(<span class="number">5000</span>)</span><br><span class="line">y = <span class="number">1.2</span> * x + np.random.randn(<span class="number">5000</span>) / <span class="number">3</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># plot:</span></span><br><span class="line">fig, ax = plt.subplots()</span><br><span class="line"></span><br><span class="line">ax.hist2d(x, y, bins=(np.arange(-<span class="number">3</span>, <span class="number">3</span>, <span class="number">0.1</span>), np.arange(-<span class="number">3</span>, <span class="number">3</span>, <span class="number">0.1</span>)))</span><br><span class="line"></span><br><span class="line">ax.<span class="built_in">set</span>(xlim=(-<span class="number">2</span>, <span class="number">2</span>), ylim=(-<span class="number">3</span>, <span class="number">3</span>))</span><br><span class="line"></span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure><ol><li><p><code>import matplotlib.pyplot as plt</code>: 导入Matplotlib库，并将其简化为<code>plt</code>，这是Matplotlib中常用的惯例。</p></li><li><p><code>import numpy as np</code>: 导入NumPy库，并将其简化为<code>np</code>，NumPy是用于数值计算的Python库。</p></li><li><p><code>plt.style.use(&#39;_mpl-gallery-nogrid&#39;)</code>: 这里使用了一个自定义的Matplotlib样式<code>&#39;_mpl-gallery-nogrid&#39;</code>。Matplotlib样式用于设置图形的外观和风格。在此之前可能有一个自定义的样式定义，但代码片段中没有显示出来。</p></li><li><p><code>np.random.seed(1)</code>: 设置随机数种子，保证每次运行代码生成的随机数据都是一样的，便于复现结果。</p></li><li><p><code>x = np.random.randn(5000)</code>: 生成一个包含5000个随机数的数组x，这些随机数是从标准正态分布（均值为0，标准差为1）中生成的。</p></li><li><p><code>y = 1.2 * x + np.random.randn(5000) / 3</code>: 生成一个包含5000个随机数的数组y，其中y与x具有一定的线性相关性，并添加了一些噪声。具体地，y是由x线性变换得到，并加上了从标准正态分布中随机生成的噪声，噪声的标准差为1&#x2F;3。</p></li><li><p><code>fig, ax = plt.subplots()</code>: 创建一个图形对象和一个坐标轴对象。<code>fig</code>代表整个图形窗口，<code>ax</code>代表图形中的坐标轴。</p></li><li><p><code>ax.hist2d(x, y, bins=(np.arange(-3, 3, 0.1), np.arange(-3, 3, 0.1)))</code>: 使用<code>ax.hist2d</code>函数绘制二维直方图。<code>x</code>和<code>y</code>是要绘制的二维数据，<code>bins</code>设置了直方图的区间范围和分箱数目。在这里，x和y的区间范围都是从-3到3，分箱数目为60（(3-(-3)) &#x2F; 0.1 &#x3D; 60）。</p></li><li><p><code>ax.set(xlim=(-2, 2), ylim=(-3, 3))</code>: 使用<code>ax.set</code>方法设置坐标轴的显示范围。<code>xlim=(-2, 2)</code>设置x轴显示范围为-2到2，<code>ylim=(-3, 3)</code>设置y轴显示范围为-3到3。</p></li><li><p><code>plt.show()</code>: 显示绘制的图形。</p></li></ol><p>这段代码将绘制一个二维直方图，用于展示两个变量x和y之间的相关性和分布情况。二维直方图可以帮助我们直观地了解两个变量之间的关系和分布特征，尤其适用于观察大量数据点的情况。在直方图中，颜色越深表示数据点越密集，颜色越浅表示数据点较少。</p><img src="https://matplotlib.org/stable/_images/sphx_glr_hist2d_001_2_00x.png" class="lazyload placeholder" data-srcset="https://matplotlib.org/stable/_images/sphx_glr_hist2d_001_2_00x.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="hist2d"><h3 id="六边形图"><a href="#六边形图" class="headerlink" title="六边形图"></a>六边形图</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">plt.style.use(<span class="string">&#x27;_mpl-gallery-nogrid&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># make data: correlated + noise</span></span><br><span class="line">np.random.seed(<span class="number">1</span>)</span><br><span class="line">x = np.random.randn(<span class="number">5000</span>)</span><br><span class="line">y = <span class="number">1.2</span> * x + np.random.randn(<span class="number">5000</span>) / <span class="number">3</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># plot:</span></span><br><span class="line">fig, ax = plt.subplots()</span><br><span class="line"></span><br><span class="line">ax.hexbin(x, y, gridsize=<span class="number">20</span>)</span><br><span class="line"></span><br><span class="line">ax.<span class="built_in">set</span>(xlim=(-<span class="number">2</span>, <span class="number">2</span>), ylim=(-<span class="number">3</span>, <span class="number">3</span>))</span><br><span class="line"></span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure><ol><li><p><code>import matplotlib.pyplot as plt</code>: 导入Matplotlib库，并将其简化为<code>plt</code>，这是Matplotlib中常用的惯例。</p></li><li><p><code>import numpy as np</code>: 导入NumPy库，并将其简化为<code>np</code>，NumPy是用于数值计算的Python库。</p></li><li><p><code>plt.style.use(&#39;_mpl-gallery-nogrid&#39;)</code>: 这里使用了一个自定义的Matplotlib样式<code>&#39;_mpl-gallery-nogrid&#39;</code>。Matplotlib样式用于设置图形的外观和风格。在此之前可能有一个自定义的样式定义，但代码片段中没有显示出来。</p></li><li><p><code>np.random.seed(1)</code>: 设置随机数种子，保证每次运行代码生成的随机数据都是一样的，便于复现结果。</p></li><li><p><code>x = np.random.randn(5000)</code>: 生成一个包含5000个随机数的数组x，这些随机数是从标准正态分布（均值为0，标准差为1）中生成的。</p></li><li><p><code>y = 1.2 * x + np.random.randn(5000) / 3</code>: 生成一个包含5000个随机数的数组y，其中y与x具有一定的线性相关性，并添加了一些噪声。具体地，y是由x线性变换得到，并加上了从标准正态分布中随机生成的噪声，噪声的标准差为1&#x2F;3。</p></li><li><p><code>fig, ax = plt.subplots()</code>: 创建一个图形对象和一个坐标轴对象。<code>fig</code>代表整个图形窗口，<code>ax</code>代表图形中的坐标轴。</p></li><li><p><code>ax.hexbin(x, y, gridsize=20)</code>: 使用<code>ax.hexbin</code>函数绘制六边形图。<code>x</code>和<code>y</code>是要绘制的二维数据，<code>gridsize=20</code>设置了六边形的网格大小。该参数控制了六边形的大小和密度，数值越大，表示六边形的大小越小、密度越大。</p></li><li><p><code>ax.set(xlim=(-2, 2), ylim=(-3, 3))</code>: 使用<code>ax.set</code>方法设置坐标轴的显示范围。<code>xlim=(-2, 2)</code>设置x轴显示范围为-2到2，<code>ylim=(-3, 3)</code>设置y轴显示范围为-3到3。</p></li><li><p><code>plt.show()</code>: 显示绘制的图形。</p></li></ol><p>这段代码将绘制一个六边形图，用于展示两个变量x和y之间的相关性和分布情况。六边形图在处理大量数据点时有着较好的可视化效果，可以帮助我们更好地理解两个变量之间的关系和分布特征。在图中，六边形的颜色深浅表示数据点的密集程度，颜色越深表示数据点越密集。</p><img src="https://matplotlib.org/stable/_images/sphx_glr_hexbin_001_2_00x.png" class="lazyload placeholder" data-srcset="https://matplotlib.org/stable/_images/sphx_glr_hexbin_001_2_00x.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="hexbin"><h3 id="饼图"><a href="#饼图" class="headerlink" title="饼图"></a>饼图</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">plt.style.use(<span class="string">&#x27;_mpl-gallery-nogrid&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># make data</span></span><br><span class="line">x = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]</span><br><span class="line">colors = plt.get_cmap(<span class="string">&#x27;Blues&#x27;</span>)(np.linspace(<span class="number">0.2</span>, <span class="number">0.7</span>, <span class="built_in">len</span>(x)))</span><br><span class="line"></span><br><span class="line"><span class="comment"># plot</span></span><br><span class="line">fig, ax = plt.subplots()</span><br><span class="line">ax.pie(x, colors=colors, radius=<span class="number">3</span>, center=(<span class="number">4</span>, <span class="number">4</span>),</span><br><span class="line">       wedgeprops=&#123;<span class="string">&quot;linewidth&quot;</span>: <span class="number">1</span>, <span class="string">&quot;edgecolor&quot;</span>: <span class="string">&quot;white&quot;</span>&#125;, frame=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">ax.<span class="built_in">set</span>(xlim=(<span class="number">0</span>, <span class="number">8</span>), xticks=np.arange(<span class="number">1</span>, <span class="number">8</span>),</span><br><span class="line">       ylim=(<span class="number">0</span>, <span class="number">8</span>), yticks=np.arange(<span class="number">1</span>, <span class="number">8</span>))</span><br><span class="line"></span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure><ol><li><p><code>import matplotlib.pyplot as plt</code>: 导入Matplotlib库，并将其简化为<code>plt</code>，这是Matplotlib中常用的惯例。</p></li><li><p><code>import numpy as np</code>: 导入NumPy库，并将其简化为<code>np</code>，NumPy是用于数值计算的Python库。</p></li><li><p><code>plt.style.use(&#39;_mpl-gallery-nogrid&#39;)</code>: 这里使用了一个自定义的Matplotlib样式<code>&#39;_mpl-gallery-nogrid&#39;</code>。Matplotlib样式用于设置图形的外观和风格。在此之前可能有一个自定义的样式定义，但代码片段中没有显示出来。</p></li><li><p><code>x = [1, 2, 3, 4]</code>: 定义了一个包含4个数据点的列表x，每个数据点表示饼图中的一个扇区。</p></li><li><p><code>colors = plt.get_cmap(&#39;Blues&#39;)(np.linspace(0.2, 0.7, len(x)))</code>: 使用<code>plt.get_cmap(&#39;Blues&#39;)</code>函数获取一个蓝色调色板，<code>np.linspace(0.2, 0.7, len(x))</code>用于生成一个0.2到0.7的等差数列，长度与数据点个数相同。这些数值用于定义扇区的颜色，颜色逐渐从浅蓝到深蓝。</p></li><li><p><code>fig, ax = plt.subplots()</code>: 创建一个图形对象和一个坐标轴对象。<code>fig</code>代表整个图形窗口，<code>ax</code>代表图形中的坐标轴。</p></li><li><p><code>ax.pie(x, colors=colors, radius=3, center=(4, 4), wedgeprops=&#123;&quot;linewidth&quot;: 1, &quot;edgecolor&quot;: &quot;white&quot;&#125;, frame=True)</code>: 使用<code>ax.pie</code>函数绘制饼图。<code>x</code>是要绘制的数据，<code>colors=colors</code>用于设置扇区的颜色，<code>radius=3</code>设置饼图的半径为3个单位，<code>center=(4, 4)</code>设置饼图的中心位置为坐标(4, 4)处，<code>wedgeprops=&#123;&quot;linewidth&quot;: 1, &quot;edgecolor&quot;: &quot;white&quot;&#125;</code>用于设置扇区边界的线宽和颜色，<code>frame=True</code>表示显示饼图的边框。</p></li><li><p><code>ax.set(xlim=(0, 8), xticks=np.arange(1, 8), ylim=(0, 8), yticks=np.arange(1, 8))</code>: 使用<code>ax.set</code>方法设置坐标轴的显示范围和刻度位置。<code>xlim=(0, 8)</code>设置x轴显示范围为0到8，<code>xticks=np.arange(1, 8)</code>设置x轴的刻度位置为1到7，<code>ylim=(0, 8)</code>设置y轴显示范围为0到8，<code>yticks=np.arange(1, 8)</code>设置y轴的刻度位置为1到7。</p></li><li><p><code>plt.show()</code>: 显示绘制的图形。</p></li></ol><p>这段代码将绘制一个饼图，用于展示一组数据的占比情况。每个数据点对应饼图中的一个扇区，扇区的面积表示该数据点在总体中的占比。颜色从浅蓝到深蓝逐渐变化，用于区分不同的数据点。饼图是一种常用的可视化方式，适用于展示不同类别在总体中的比例关系。</p><img src="https://matplotlib.org/stable/_images/sphx_glr_pie_001_2_00x.png" class="lazyload placeholder" data-srcset="https://matplotlib.org/stable/_images/sphx_glr_pie_001_2_00x.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="pie"><h3 id="三角剖分等高线图"><a href="#三角剖分等高线图" class="headerlink" title="三角剖分等高线图"></a>三角剖分等高线图</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">plt.style.use(<span class="string">&#x27;_mpl-gallery-nogrid&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># make data:</span></span><br><span class="line">np.random.seed(<span class="number">1</span>)</span><br><span class="line">x = np.random.uniform(-<span class="number">3</span>, <span class="number">3</span>, <span class="number">256</span>)</span><br><span class="line">y = np.random.uniform(-<span class="number">3</span>, <span class="number">3</span>, <span class="number">256</span>)</span><br><span class="line">z = (<span class="number">1</span> - x/<span class="number">2</span> + x**<span class="number">5</span> + y**<span class="number">3</span>) * np.exp(-x**<span class="number">2</span> - y**<span class="number">2</span>)</span><br><span class="line">levels = np.linspace(z.<span class="built_in">min</span>(), z.<span class="built_in">max</span>(), <span class="number">7</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># plot:</span></span><br><span class="line">fig, ax = plt.subplots()</span><br><span class="line"></span><br><span class="line">ax.plot(x, y, <span class="string">&#x27;o&#x27;</span>, markersize=<span class="number">2</span>, color=<span class="string">&#x27;lightgrey&#x27;</span>)</span><br><span class="line">ax.tricontour(x, y, z, levels=levels)</span><br><span class="line"></span><br><span class="line">ax.<span class="built_in">set</span>(xlim=(-<span class="number">3</span>, <span class="number">3</span>), ylim=(-<span class="number">3</span>, <span class="number">3</span>))</span><br><span class="line"></span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure><ol><li><p><code>import matplotlib.pyplot as plt</code>: 导入Matplotlib库，并将其简化为<code>plt</code>，这是Matplotlib中常用的惯例。</p></li><li><p><code>import numpy as np</code>: 导入NumPy库，并将其简化为<code>np</code>，NumPy是用于数值计算的Python库。</p></li><li><p><code>plt.style.use(&#39;_mpl-gallery-nogrid&#39;)</code>: 这里使用了一个自定义的Matplotlib样式<code>&#39;_mpl-gallery-nogrid&#39;</code>。Matplotlib样式用于设置图形的外观和风格。在此之前可能有一个自定义的样式定义，但代码片段中没有显示出来。</p></li><li><p><code>np.random.seed(1)</code>: 设置随机数种子，保证每次运行代码生成的随机数据都是一样的，便于复现结果。</p></li><li><p><code>x = np.random.uniform(-3, 3, 256)</code>: 生成一个包含256个随机数的数组x，这些随机数是从-3到3的均匀分布中生成的。</p></li><li><p><code>y = np.random.uniform(-3, 3, 256)</code>: 生成一个包含256个随机数的数组y，这些随机数是从-3到3的均匀分布中生成的。</p></li><li><p><code>z = (1 - x/2 + x**5 + y**3) * np.exp(-x**2 - y**2)</code>: 生成一个包含256个随机数的数组z，其中z是通过对x、y进行一系列数学运算得到的。具体地，z是通过以下公式计算得到的：z &#x3D; (1 - x&#x2F;2 + x<strong>5 + y</strong>3) * np.exp(-x<strong>2 - y</strong>2)。</p></li><li><p><code>levels = np.linspace(z.min(), z.max(), 7)</code>: 使用<code>np.linspace</code>函数生成一个包含7个数值的等差数列，这些数值在z的最小值和最大值之间。</p></li><li><p><code>fig, ax = plt.subplots()</code>: 创建一个图形对象和一个坐标轴对象。<code>fig</code>代表整个图形窗口，<code>ax</code>代表图形中的坐标轴。</p></li><li><p><code>ax.plot(x, y, &#39;o&#39;, markersize=2, color=&#39;lightgrey&#39;)</code>: 使用<code>ax.plot</code>函数绘制原始数据点。在这里，将x、y作为散点图绘制在图中，并使用<code>&#39;o&#39;</code>表示散点形状为圆圈，<code>markersize=2</code>设置散点的大小为2个单位，<code>color=&#39;lightgrey&#39;</code>设置散点的颜色为浅灰色。</p></li><li><p><code>ax.tricontour(x, y, z, levels=levels)</code>: 使用<code>ax.tricontour</code>函数绘制三角剖分等高线图。<code>x</code>、<code>y</code>是原始数据点的坐标，<code>z</code>是对应的高度值，<code>levels=levels</code>用于设置等高线的数值。</p></li><li><p><code>ax.set(xlim=(-3, 3), ylim=(-3, 3))</code>: 使用<code>ax.set</code>方法设置坐标轴的显示范围。<code>xlim=(-3, 3)</code>设置x轴显示范围为-3到3，<code>ylim=(-3, 3)</code>设置y轴显示范围为-3到3。</p></li><li><p><code>plt.show()</code>: 显示绘制的图形。</p></li></ol><p>这段代码将绘制一个三角剖分等高线图，用于展示二维数据在三维空间中的等高线分布情况。三角剖分等高线图适用于处理在不规则网格上的数据点，可以更准确地表示数据的分布情况，并帮助我们理解数据的变化趋势。</p><img src="https://matplotlib.org/stable/_images/sphx_glr_tricontour_001_2_00x.png" class="lazyload placeholder" data-srcset="https://matplotlib.org/stable/_images/sphx_glr_tricontour_001_2_00x.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="tricontour"><h3 id="填充三角剖分等高线图"><a href="#填充三角剖分等高线图" class="headerlink" title="填充三角剖分等高线图"></a>填充三角剖分等高线图</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">plt.style.use(<span class="string">&#x27;_mpl-gallery-nogrid&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># make data:</span></span><br><span class="line">np.random.seed(<span class="number">1</span>)</span><br><span class="line">x = np.random.uniform(-<span class="number">3</span>, <span class="number">3</span>, <span class="number">256</span>)</span><br><span class="line">y = np.random.uniform(-<span class="number">3</span>, <span class="number">3</span>, <span class="number">256</span>)</span><br><span class="line">z = (<span class="number">1</span> - x/<span class="number">2</span> + x**<span class="number">5</span> + y**<span class="number">3</span>) * np.exp(-x**<span class="number">2</span> - y**<span class="number">2</span>)</span><br><span class="line">levels = np.linspace(z.<span class="built_in">min</span>(), z.<span class="built_in">max</span>(), <span class="number">7</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># plot:</span></span><br><span class="line">fig, ax = plt.subplots()</span><br><span class="line"></span><br><span class="line">ax.plot(x, y, <span class="string">&#x27;o&#x27;</span>, markersize=<span class="number">2</span>, color=<span class="string">&#x27;grey&#x27;</span>)</span><br><span class="line">ax.tricontourf(x, y, z, levels=levels)</span><br><span class="line"></span><br><span class="line">ax.<span class="built_in">set</span>(xlim=(-<span class="number">3</span>, <span class="number">3</span>), ylim=(-<span class="number">3</span>, <span class="number">3</span>))</span><br><span class="line"></span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure><ol><li><p><code>import matplotlib.pyplot as plt</code>: 导入Matplotlib库，并将其简化为<code>plt</code>，这是Matplotlib中常用的惯例。</p></li><li><p><code>import numpy as np</code>: 导入NumPy库，并将其简化为<code>np</code>，NumPy是用于数值计算的Python库。</p></li><li><p><code>plt.style.use(&#39;_mpl-gallery-nogrid&#39;)</code>: 这里使用了一个自定义的Matplotlib样式<code>&#39;_mpl-gallery-nogrid&#39;</code>。Matplotlib样式用于设置图形的外观和风格。在此之前可能有一个自定义的样式定义，但代码片段中没有显示出来。</p></li><li><p><code>np.random.seed(1)</code>: 设置随机数种子，保证每次运行代码生成的随机数据都是一样的，便于复现结果。</p></li><li><p><code>x = np.random.uniform(-3, 3, 256)</code>: 生成一个包含256个随机数的数组x，这些随机数是从-3到3的均匀分布中生成的。</p></li><li><p><code>y = np.random.uniform(-3, 3, 256)</code>: 生成一个包含256个随机数的数组y，这些随机数是从-3到3的均匀分布中生成的。</p></li><li><p><code>z = (1 - x/2 + x**5 + y**3) * np.exp(-x**2 - y**2)</code>: 生成一个包含256个随机数的数组z，其中z是通过对x、y进行一系列数学运算得到的。具体地，z是通过以下公式计算得到的：z &#x3D; (1 - x&#x2F;2 + x<strong>5 + y</strong>3) * np.exp(-x<strong>2 - y</strong>2)。</p></li><li><p><code>levels = np.linspace(z.min(), z.max(), 7)</code>: 使用<code>np.linspace</code>函数生成一个包含7个数值的等差数列，这些数值在z的最小值和最大值之间。</p></li><li><p><code>fig, ax = plt.subplots()</code>: 创建一个图形对象和一个坐标轴对象。<code>fig</code>代表整个图形窗口，<code>ax</code>代表图形中的坐标轴。</p></li><li><p><code>ax.plot(x, y, &#39;o&#39;, markersize=2, color=&#39;grey&#39;)</code>: 使用<code>ax.plot</code>函数绘制原始数据点。在这里，将x、y作为散点图绘制在图中，并使用<code>&#39;o&#39;</code>表示散点形状为圆圈，<code>markersize=2</code>设置散点的大小为2个单位，<code>color=&#39;grey&#39;</code>设置散点的颜色为灰色。</p></li><li><p><code>ax.tricontourf(x, y, z, levels=levels)</code>: 使用<code>ax.tricontourf</code>函数绘制填充三角剖分等高线图。<code>x</code>、<code>y</code>是原始数据点的坐标，<code>z</code>是对应的高度值，<code>levels=levels</code>用于设置等高线的数值，并且使用填充颜色表示等高线区域。</p></li><li><p><code>ax.set(xlim=(-3, 3), ylim=(-3, 3))</code>: 使用<code>ax.set</code>方法设置坐标轴的显示范围。<code>xlim=(-3, 3)</code>设置x轴显示范围为-3到3，<code>ylim=(-3, 3)</code>设置y轴显示范围为-3到3。</p></li><li><p><code>plt.show()</code>: 显示绘制的图形。</p></li></ol><p>这段代码将绘制一个填充三角剖分等高线图，用于展示二维数据在三维空间中的等高线分布情况，并通过填充颜色来强调不同高度区域的差异。填充三角剖分等高线图适用于处理在不规则网格上的数据点，并且通过填充颜色可以更直观地表示数据的变化趋势。</p><img src="https://matplotlib.org/stable/_images/sphx_glr_tricontourf_001_2_00x.png" class="lazyload placeholder" data-srcset="https://matplotlib.org/stable/_images/sphx_glr_tricontourf_001_2_00x.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="tricontourf"><h3 id="三角剖分彩色图"><a href="#三角剖分彩色图" class="headerlink" title="三角剖分彩色图"></a>三角剖分彩色图</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">plt.style.use(<span class="string">&#x27;_mpl-gallery-nogrid&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># make data:</span></span><br><span class="line">np.random.seed(<span class="number">1</span>)</span><br><span class="line">x = np.random.uniform(-<span class="number">3</span>, <span class="number">3</span>, <span class="number">256</span>)</span><br><span class="line">y = np.random.uniform(-<span class="number">3</span>, <span class="number">3</span>, <span class="number">256</span>)</span><br><span class="line">z = (<span class="number">1</span> - x/<span class="number">2</span> + x**<span class="number">5</span> + y**<span class="number">3</span>) * np.exp(-x**<span class="number">2</span> - y**<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># plot:</span></span><br><span class="line">fig, ax = plt.subplots()</span><br><span class="line"></span><br><span class="line">ax.plot(x, y, <span class="string">&#x27;o&#x27;</span>, markersize=<span class="number">2</span>, color=<span class="string">&#x27;grey&#x27;</span>)</span><br><span class="line">ax.tripcolor(x, y, z)</span><br><span class="line"></span><br><span class="line">ax.<span class="built_in">set</span>(xlim=(-<span class="number">3</span>, <span class="number">3</span>), ylim=(-<span class="number">3</span>, <span class="number">3</span>))</span><br><span class="line"></span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure><ol><li><p><code>import matplotlib.pyplot as plt</code>: 导入Matplotlib库，并将其简化为<code>plt</code>，这是Matplotlib中常用的惯例。</p></li><li><p><code>import numpy as np</code>: 导入NumPy库，并将其简化为<code>np</code>，NumPy是用于数值计算的Python库。</p></li><li><p><code>plt.style.use(&#39;_mpl-gallery-nogrid&#39;)</code>: 这里使用了一个自定义的Matplotlib样式<code>&#39;_mpl-gallery-nogrid&#39;</code>。Matplotlib样式用于设置图形的外观和风格。在此之前可能有一个自定义的样式定义，但代码片段中没有显示出来。</p></li><li><p><code>np.random.seed(1)</code>: 设置随机数种子，保证每次运行代码生成的随机数据都是一样的，便于复现结果。</p></li><li><p><code>x = np.random.uniform(-3, 3, 256)</code>: 生成一个包含256个随机数的数组x，这些随机数是从-3到3的均匀分布中生成的。</p></li><li><p><code>y = np.random.uniform(-3, 3, 256)</code>: 生成一个包含256个随机数的数组y，这些随机数是从-3到3的均匀分布中生成的。</p></li><li><p><code>z = (1 - x/2 + x**5 + y**3) * np.exp(-x**2 - y**2)</code>: 生成一个包含256个随机数的数组z，其中z是通过对x、y进行一系列数学运算得到的。具体地，z是通过以下公式计算得到的：z &#x3D; (1 - x&#x2F;2 + x<strong>5 + y</strong>3) * np.exp(-x<strong>2 - y</strong>2)。</p></li><li><p><code>fig, ax = plt.subplots()</code>: 创建一个图形对象和一个坐标轴对象。<code>fig</code>代表整个图形窗口，<code>ax</code>代表图形中的坐标轴。</p></li><li><p><code>ax.plot(x, y, &#39;o&#39;, markersize=2, color=&#39;grey&#39;)</code>: 使用<code>ax.plot</code>函数绘制原始数据点。在这里，将x、y作为散点图绘制在图中，并使用<code>&#39;o&#39;</code>表示散点形状为圆圈，<code>markersize=2</code>设置散点的大小为2个单位，<code>color=&#39;grey&#39;</code>设置散点的颜色为灰色。</p></li><li><p><code>ax.tripcolor(x, y, z)</code>: 使用<code>ax.tripcolor</code>函数绘制三角剖分彩色图。<code>x</code>、<code>y</code>是原始数据点的坐标，<code>z</code>是对应的高度值，函数将根据数据点的三角剖分情况来着色，形成彩色的三角区域。</p></li><li><p><code>ax.set(xlim=(-3, 3), ylim=(-3, 3))</code>: 使用<code>ax.set</code>方法设置坐标轴的显示范围。<code>xlim=(-3, 3)</code>设置x轴显示范围为-3到3，<code>ylim=(-3, 3)</code>设置y轴显示范围为-3到3。</p></li><li><p><code>plt.show()</code>: 显示绘制的图形。</p></li></ol><p>这段代码将绘制一个三角剖分彩色图，用于展示二维数据在三维空间中的变化情况，并通过彩色表示不同高度区域的差异。三角剖分彩色图适用于处理在不规则网格上的数据点，并且通过彩色能够更直观地表示数据的变化趋势。</p><img src="https://matplotlib.org/stable/_images/sphx_glr_tripcolor_001_2_00x.png" class="lazyload placeholder" data-srcset="https://matplotlib.org/stable/_images/sphx_glr_tripcolor_001_2_00x.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="tripcolor"><h3 id="三角剖分图"><a href="#三角剖分图" class="headerlink" title="三角剖分图"></a>三角剖分图</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">plt.style.use(<span class="string">&#x27;_mpl-gallery-nogrid&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># make data:</span></span><br><span class="line">np.random.seed(<span class="number">1</span>)</span><br><span class="line">x = np.random.uniform(-<span class="number">3</span>, <span class="number">3</span>, <span class="number">256</span>)</span><br><span class="line">y = np.random.uniform(-<span class="number">3</span>, <span class="number">3</span>, <span class="number">256</span>)</span><br><span class="line">z = (<span class="number">1</span> - x/<span class="number">2</span> + x**<span class="number">5</span> + y**<span class="number">3</span>) * np.exp(-x**<span class="number">2</span> - y**<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># plot:</span></span><br><span class="line">fig, ax = plt.subplots()</span><br><span class="line"></span><br><span class="line">ax.triplot(x, y)</span><br><span class="line"></span><br><span class="line">ax.<span class="built_in">set</span>(xlim=(-<span class="number">3</span>, <span class="number">3</span>), ylim=(-<span class="number">3</span>, <span class="number">3</span>))</span><br><span class="line"></span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure><ol><li><p><code>import matplotlib.pyplot as plt</code>: 导入Matplotlib库，并将其简化为<code>plt</code>，这是Matplotlib中常用的惯例。</p></li><li><p><code>import numpy as np</code>: 导入NumPy库，并将其简化为<code>np</code>，NumPy是用于数值计算的Python库。</p></li><li><p><code>plt.style.use(&#39;_mpl-gallery-nogrid&#39;)</code>: 这里使用了一个自定义的Matplotlib样式<code>&#39;_mpl-gallery-nogrid&#39;</code>。Matplotlib样式用于设置图形的外观和风格。在此之前可能有一个自定义的样式定义，但代码片段中没有显示出来。</p></li><li><p><code>np.random.seed(1)</code>: 设置随机数种子，保证每次运行代码生成的随机数据都是一样的，便于复现结果。</p></li><li><p><code>x = np.random.uniform(-3, 3, 256)</code>: 生成一个包含256个随机数的数组x，这些随机数是从-3到3的均匀分布中生成的。</p></li><li><p><code>y = np.random.uniform(-3, 3, 256)</code>: 生成一个包含256个随机数的数组y，这些随机数是从-3到3的均匀分布中生成的。</p></li><li><p><code>z = (1 - x/2 + x**5 + y**3) * np.exp(-x**2 - y**2)</code>: 生成一个包含256个随机数的数组z，其中z是通过对x、y进行一系列数学运算得到的。具体地，z是通过以下公式计算得到的：z &#x3D; (1 - x&#x2F;2 + x<strong>5 + y</strong>3) * np.exp(-x<strong>2 - y</strong>2)。</p></li><li><p><code>fig, ax = plt.subplots()</code>: 创建一个图形对象和一个坐标轴对象。<code>fig</code>代表整个图形窗口，<code>ax</code>代表图形中的坐标轴。</p></li><li><p><code>ax.triplot(x, y)</code>: 使用<code>ax.triplot</code>函数绘制三角剖分图。<code>x</code>、<code>y</code>是原始数据点的坐标，函数会根据这些数据点之间的三角剖分关系绘制三角网格。</p></li><li><p><code>ax.set(xlim=(-3, 3), ylim=(-3, 3))</code>: 使用<code>ax.set</code>方法设置坐标轴的显示范围。<code>xlim=(-3, 3)</code>设置x轴显示范围为-3到3，<code>ylim=(-3, 3)</code>设置y轴显示范围为-3到3。</p></li><li><p><code>plt.show()</code>: 显示绘制的图形。</p></li></ol><p>这段代码将绘制一个三角剖分图，用于展示二维数据在三维空间中的数据点之间的三角剖分关系。三角剖分图适用于处理在不规则网格上的数据点，并且通过三角网格可以更直观地表示数据点之间的连接关系。</p><img src="https://matplotlib.org/stable/_images/sphx_glr_triplot_001_2_00x.png" class="lazyload placeholder" data-srcset="https://matplotlib.org/stable/_images/sphx_glr_triplot_001_2_00x.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="triplot"><h3 id="三维散点图"><a href="#三维散点图" class="headerlink" title="三维散点图"></a>三维散点图</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">plt.style.use(<span class="string">&#x27;_mpl-gallery&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Make data</span></span><br><span class="line">np.random.seed(<span class="number">19680801</span>)</span><br><span class="line">n = <span class="number">100</span></span><br><span class="line">rng = np.random.default_rng()</span><br><span class="line">xs = rng.uniform(<span class="number">23</span>, <span class="number">32</span>, n)</span><br><span class="line">ys = rng.uniform(<span class="number">0</span>, <span class="number">100</span>, n)</span><br><span class="line">zs = rng.uniform(-<span class="number">50</span>, -<span class="number">25</span>, n)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Plot</span></span><br><span class="line">fig, ax = plt.subplots(subplot_kw=&#123;<span class="string">&quot;projection&quot;</span>: <span class="string">&quot;3d&quot;</span>&#125;)</span><br><span class="line">ax.scatter(xs, ys, zs)</span><br><span class="line"></span><br><span class="line">ax.<span class="built_in">set</span>(xticklabels=[],</span><br><span class="line">       yticklabels=[],</span><br><span class="line">       zticklabels=[])</span><br><span class="line"></span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure><ol><li><p><code>import matplotlib.pyplot as plt</code>: 导入Matplotlib库，并将其简化为<code>plt</code>，这是Matplotlib中常用的惯例。</p></li><li><p><code>import numpy as np</code>: 导入NumPy库，并将其简化为<code>np</code>，NumPy是用于数值计算的Python库。</p></li><li><p><code>plt.style.use(&#39;_mpl-gallery&#39;)</code>: 这里使用了一个自定义的Matplotlib样式<code>&#39;_mpl-gallery&#39;</code>。Matplotlib样式用于设置图形的外观和风格。在此之前可能有一个自定义的样式定义，但代码片段中没有显示出来。</p></li><li><p><code>np.random.seed(19680801)</code>: 设置随机数种子，保证每次运行代码生成的随机数据都是一样的，便于复现结果。</p></li><li><p><code>n = 100</code>: 定义数据点的数量。</p></li><li><p><code>rng = np.random.default_rng()</code>: 创建一个随机数生成器对象。</p></li><li><p><code>xs = rng.uniform(23, 32, n)</code>: 用随机数生成器生成包含100个随机数的数组<code>xs</code>，这些随机数是从23到32的均匀分布中生成的。</p></li><li><p><code>ys = rng.uniform(0, 100, n)</code>: 用随机数生成器生成包含100个随机数的数组<code>ys</code>，这些随机数是从0到100的均匀分布中生成的。</p></li><li><p><code>zs = rng.uniform(-50, -25, n)</code>: 用随机数生成器生成包含100个随机数的数组<code>zs</code>，这些随机数是从-50到-25的均匀分布中生成的。</p></li><li><p><code>fig, ax = plt.subplots(subplot_kw=&#123;&quot;projection&quot;: &quot;3d&quot;&#125;)</code>: 创建一个带有三维坐标轴的图形对象和一个三维坐标轴对象。<code>fig</code>代表整个图形窗口，<code>ax</code>代表图形中的三维坐标轴。</p></li><li><p><code>ax.scatter(xs, ys, zs)</code>: 使用<code>ax.scatter</code>函数绘制三维散点图。<code>xs</code>、<code>ys</code>、<code>zs</code>是数据点的x、y、z坐标，函数会在三维坐标轴上绘制这些数据点。</p></li><li><p><code>ax.set(xticklabels=[], yticklabels=[], zticklabels=[])</code>: 设置三维坐标轴的刻度标签为空，这样就隐藏了x、y、z轴的刻度标签。</p></li><li><p><code>plt.show()</code>: 显示绘制的图形。</p></li></ol><p>这段代码绘制了一个简单的三维散点图，其中包含了100个随机生成的数据点，用于展示数据在三维空间中的分布情况。</p><img src="https://matplotlib.org/stable/_images/sphx_glr_scatter3d_simple_001_2_00x.png" class="lazyload placeholder" data-srcset="https://matplotlib.org/stable/_images/sphx_glr_scatter3d_simple_001_2_00x.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="scatter"><h3 id="三维曲面图"><a href="#三维曲面图" class="headerlink" title="三维曲面图"></a>三维曲面图</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">from</span> matplotlib <span class="keyword">import</span> cm</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">plt.style.use(<span class="string">&#x27;_mpl-gallery&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Make data</span></span><br><span class="line">X = np.arange(-<span class="number">5</span>, <span class="number">5</span>, <span class="number">0.25</span>)</span><br><span class="line">Y = np.arange(-<span class="number">5</span>, <span class="number">5</span>, <span class="number">0.25</span>)</span><br><span class="line">X, Y = np.meshgrid(X, Y)</span><br><span class="line">R = np.sqrt(X**<span class="number">2</span> + Y**<span class="number">2</span>)</span><br><span class="line">Z = np.sin(R)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Plot the surface</span></span><br><span class="line">fig, ax = plt.subplots(subplot_kw=&#123;<span class="string">&quot;projection&quot;</span>: <span class="string">&quot;3d&quot;</span>&#125;)</span><br><span class="line">ax.plot_surface(X, Y, Z, vmin=Z.<span class="built_in">min</span>() * <span class="number">2</span>, cmap=cm.Blues)</span><br><span class="line"></span><br><span class="line">ax.<span class="built_in">set</span>(xticklabels=[],</span><br><span class="line">       yticklabels=[],</span><br><span class="line">       zticklabels=[])</span><br><span class="line"></span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure><ol><li><p><code>import matplotlib.pyplot as plt</code>: 导入Matplotlib库，并将其简化为<code>plt</code>，这是Matplotlib中常用的惯例。</p></li><li><p><code>from matplotlib import cm</code>: 从Matplotlib库中导入<code>cm</code>，用于获取颜色映射(colormap)。</p></li><li><p><code>plt.style.use(&#39;_mpl-gallery&#39;)</code>: 这里使用了一个自定义的Matplotlib样式<code>&#39;_mpl-gallery&#39;</code>。Matplotlib样式用于设置图形的外观和风格。在此之前可能有一个自定义的样式定义，但代码片段中没有显示出来。</p></li><li><p><code>X = np.arange(-5, 5, 0.25)</code>: 创建一个包含从-5到5的间隔为0.25的一维数组<code>X</code>。</p></li><li><p><code>Y = np.arange(-5, 5, 0.25)</code>: 创建一个包含从-5到5的间隔为0.25的一维数组<code>Y</code>。</p></li><li><p><code>X, Y = np.meshgrid(X, Y)</code>: 将<code>X</code>和<code>Y</code>组合成一个二维网格，生成<code>X</code>和<code>Y</code>的二维数组，分别表示X和Y坐标的网格。</p></li><li><p><code>R = np.sqrt(X**2 + Y**2)</code>: 计算每个点到原点(0,0)的距离，得到一个二维数组<code>R</code>。</p></li><li><p><code>Z = np.sin(R)</code>: 计算每个点的正弦值，得到一个二维数组<code>Z</code>。</p></li><li><p><code>fig, ax = plt.subplots(subplot_kw=&#123;&quot;projection&quot;: &quot;3d&quot;&#125;)</code>: 创建一个带有三维坐标轴的图形对象和一个三维坐标轴对象。<code>fig</code>代表整个图形窗口，<code>ax</code>代表图形中的三维坐标轴。</p></li><li><p><code>ax.plot_surface(X, Y, Z, vmin=Z.min() * 2, cmap=cm.Blues)</code>: 使用<code>ax.plot_surface</code>函数绘制三维曲面图。<code>X</code>、<code>Y</code>、<code>Z</code>分别表示数据点的x、y、z坐标，函数会根据这些坐标在三维坐标轴上绘制曲面。<code>vmin</code>参数设置颜色映射的最小值，这里将其设置为<code>Z.min() * 2</code>，即z值的最小值的两倍。<code>cmap=cm.Blues</code>设置颜色映射为蓝色调。</p></li><li><p><code>ax.set(xticklabels=[], yticklabels=[], zticklabels=[])</code>: 设置三维坐标轴的刻度标签为空，这样就隐藏了x、y、z轴的刻度标签。</p></li><li><p><code>plt.show()</code>: 显示绘制的图形。</p></li></ol><p>这段代码绘制了一个包含正弦函数在二维平面上的三维曲面图，颜色随着z值的变化而变化，呈现出蓝色调的效果。</p><img src="https://matplotlib.org/stable/_images/sphx_glr_surface3d_simple_001_2_00x.png" class="lazyload placeholder" data-srcset="https://matplotlib.org/stable/_images/sphx_glr_surface3d_simple_001_2_00x.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="plot_surface"><h3 id="三维三角网面图"><a href="#三维三角网面图" class="headerlink" title="三维三角网面图"></a>三维三角网面图</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">from</span> matplotlib <span class="keyword">import</span> cm</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">plt.style.use(<span class="string">&#x27;_mpl-gallery&#x27;</span>)</span><br><span class="line"></span><br><span class="line">n_radii = <span class="number">8</span></span><br><span class="line">n_angles = <span class="number">36</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Make radii and angles spaces</span></span><br><span class="line">radii = np.linspace(<span class="number">0.125</span>, <span class="number">1.0</span>, n_radii)</span><br><span class="line">angles = np.linspace(<span class="number">0</span>, <span class="number">2</span>*np.pi, n_angles, endpoint=<span class="literal">False</span>)[..., np.newaxis]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Convert polar (radii, angles) coords to cartesian (x, y) coords.</span></span><br><span class="line">x = np.append(<span class="number">0</span>, (radii*np.cos(angles)).flatten())</span><br><span class="line">y = np.append(<span class="number">0</span>, (radii*np.sin(angles)).flatten())</span><br><span class="line">z = np.sin(-x*y)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Plot</span></span><br><span class="line">fig, ax = plt.subplots(subplot_kw=&#123;<span class="string">&#x27;projection&#x27;</span>: <span class="string">&#x27;3d&#x27;</span>&#125;)</span><br><span class="line">ax.plot_trisurf(x, y, z, vmin=z.<span class="built_in">min</span>() * <span class="number">2</span>, cmap=cm.Blues)</span><br><span class="line"></span><br><span class="line">ax.<span class="built_in">set</span>(xticklabels=[],</span><br><span class="line">       yticklabels=[],</span><br><span class="line">       zticklabels=[])</span><br><span class="line"></span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure><ol><li><p><code>import matplotlib.pyplot as plt</code>: 导入Matplotlib库，并将其简化为<code>plt</code>，这是Matplotlib中常用的惯例。</p></li><li><p><code>from matplotlib import cm</code>: 从Matplotlib库中导入<code>cm</code>，用于获取颜色映射(colormap)。</p></li><li><p><code>plt.style.use(&#39;_mpl-gallery&#39;)</code>: 这里使用了一个自定义的Matplotlib样式<code>&#39;_mpl-gallery&#39;</code>。Matplotlib样式用于设置图形的外观和风格。在此之前可能有一个自定义的样式定义，但代码片段中没有显示出来。</p></li><li><p><code>n_radii = 8</code>: 定义半径的数量。</p></li><li><p><code>n_angles = 36</code>: 定义角度的数量。</p></li><li><p><code>radii = np.linspace(0.125, 1.0, n_radii)</code>: 创建一个包含8个均匀间隔的半径值的一维数组<code>radii</code>，范围从0.125到1.0。</p></li><li><p><code>angles = np.linspace(0, 2*np.pi, n_angles, endpoint=False)[..., np.newaxis]</code>: 创建一个包含36个均匀间隔的角度值的一维数组<code>angles</code>，范围从0到2π，每个角度值都用一个维度表示。</p></li><li><p><code>x = np.append(0, (radii*np.cos(angles)).flatten())</code>: 计算x坐标值，<code>radii*np.cos(angles)</code>将极坐标转换为直角坐标，并使用<code>flatten()</code>将二维数组展平成一维数组。然后通过<code>np.append()</code>函数在数组的开头插入0，以使得曲面图在原点处闭合。</p></li><li><p><code>y = np.append(0, (radii*np.sin(angles)).flatten())</code>: 计算y坐标值，<code>radii*np.sin(angles)</code>将极坐标转换为直角坐标，并使用<code>flatten()</code>将二维数组展平成一维数组。然后通过<code>np.append()</code>函数在数组的开头插入0，以使得曲面图在原点处闭合。</p></li><li><p><code>z = np.sin(-x*y)</code>: 计算z坐标值，根据x和y的值计算z的值，这里使用了正弦函数。</p></li><li><p><code>fig, ax = plt.subplots(subplot_kw=&#123;&#39;projection&#39;: &#39;3d&#39;&#125;)</code>: 创建一个带有三维坐标轴的图形对象和一个三维坐标轴对象。<code>fig</code>代表整个图形窗口，<code>ax</code>代表图形中的三维坐标轴。</p></li><li><p><code>ax.plot_trisurf(x, y, z, vmin=z.min() * 2, cmap=cm.Blues)</code>: 使用<code>ax.plot_trisurf</code>函数绘制三维三角网面图。<code>x</code>、<code>y</code>、<code>z</code>分别表示数据点的x、y、z坐标，函数会根据这些坐标在三维坐标轴上绘制三角网面图。<code>vmin</code>参数设置颜色映射的最小值，这里将其设置为<code>z.min() * 2</code>，即z值的最小值的两倍。<code>cmap=cm.Blues</code>设置颜色映射为蓝色调。</p></li><li><p><code>ax.set(xticklabels=[], yticklabels=[], zticklabels=[])</code>: 设置三维坐标轴的刻度标签为空，这样就隐藏了x、y、z轴的刻度标签。</p></li><li><p><code>plt.show()</code>: 显示绘制的图形。</p></li></ol><p>这段代码绘制了一个在极坐标系下的三维三角网面图，颜色随着z值的变化而变化，呈现出蓝色调的效果。</p><img src="https://matplotlib.org/stable/_images/sphx_glr_trisurf3d_simple_001_2_00x.png" class="lazyload placeholder" data-srcset="https://matplotlib.org/stable/_images/sphx_glr_trisurf3d_simple_001_2_00x.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="plot_trisurf"><h3 id="三维体素图"><a href="#三维体素图" class="headerlink" title="三维体素图"></a>三维体素图</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">plt.style.use(<span class="string">&#x27;_mpl-gallery&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Prepare some coordinates</span></span><br><span class="line">x, y, z = np.indices((<span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># Draw cuboids in the top left and bottom right corners</span></span><br><span class="line">cube1 = (x &lt; <span class="number">3</span>) &amp; (y &lt; <span class="number">3</span>) &amp; (z &lt; <span class="number">3</span>)</span><br><span class="line">cube2 = (x &gt;= <span class="number">5</span>) &amp; (y &gt;= <span class="number">5</span>) &amp; (z &gt;= <span class="number">5</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Combine the objects into a single boolean array</span></span><br><span class="line">voxelarray = cube1 | cube2</span><br><span class="line"></span><br><span class="line"><span class="comment"># Plot</span></span><br><span class="line">fig, ax = plt.subplots(subplot_kw=&#123;<span class="string">&quot;projection&quot;</span>: <span class="string">&quot;3d&quot;</span>&#125;)</span><br><span class="line">ax.voxels(voxelarray, edgecolor=<span class="string">&#x27;k&#x27;</span>)</span><br><span class="line"></span><br><span class="line">ax.<span class="built_in">set</span>(xticklabels=[],</span><br><span class="line">       yticklabels=[],</span><br><span class="line">       zticklabels=[])</span><br><span class="line"></span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure><ol><li><p><code>import matplotlib.pyplot as plt</code>: 导入Matplotlib库，并将其简化为<code>plt</code>，这是Matplotlib中常用的惯例。</p></li><li><p><code>plt.style.use(&#39;_mpl-gallery&#39;)</code>: 这里使用了一个自定义的Matplotlib样式<code>&#39;_mpl-gallery&#39;</code>。Matplotlib样式用于设置图形的外观和风格。在此之前可能有一个自定义的样式定义，但代码片段中没有显示出来。</p></li><li><p><code>x, y, z = np.indices((8, 8, 8))</code>: 创建了一个3D坐标网格，其中x、y和z坐标都取值范围为0到7。这样可以得到一个8x8x8的三维网格。</p></li><li><p><code>cube1 = (x &lt; 3) &amp; (y &lt; 3) &amp; (z &lt; 3)</code>: 创建了一个立方体1，它包含了坐标点(x, y, z)满足x &lt; 3、y &lt; 3和z &lt; 3的所有点。</p></li><li><p><code>cube2 = (x &gt;= 5) &amp; (y &gt;= 5) &amp; (z &gt;= 5)</code>: 创建了一个立方体2，它包含了坐标点(x, y, z)满足x &gt;&#x3D; 5、y &gt;&#x3D; 5和z &gt;&#x3D; 5的所有点。</p></li><li><p><code>voxelarray = cube1 | cube2</code>: 将立方体1和立方体2组合成一个单一的布尔数组voxelarray。在这个数组中，值为True的元素表示在立方体内，值为False的元素表示在立方体外。</p></li><li><p><code>fig, ax = plt.subplots(subplot_kw=&#123;&quot;projection&quot;: &quot;3d&quot;&#125;)</code>: 创建一个带有三维坐标轴的图形对象和一个三维坐标轴对象。<code>fig</code>代表整个图形窗口，<code>ax</code>代表图形中的三维坐标轴。</p></li><li><p><code>ax.voxels(voxelarray, edgecolor=&#39;k&#39;)</code>: 使用<code>ax.voxels</code>函数绘制三维体素图。<code>voxelarray</code>表示要绘制的体素的布尔数组，<code>edgecolor=&#39;k&#39;</code>设置体素的边缘颜色为黑色。</p></li><li><p><code>ax.set(xticklabels=[], yticklabels=[], zticklabels=[])</code>: 设置三维坐标轴的刻度标签为空，这样就隐藏了x、y、z轴的刻度标签。</p></li><li><p><code>plt.show()</code>: 显示绘制的图形。</p></li></ol><p>这段代码绘制了一个简单的三维体素图，其中包含两个立方体。其中一个立方体位于三维空间的左上角，另一个立方体位于右下角。</p><img src="https://matplotlib.org/stable/_images/sphx_glr_voxels_simple_001_2_00x.png" class="lazyload placeholder" data-srcset="https://matplotlib.org/stable/_images/sphx_glr_voxels_simple_001_2_00x.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="voxels"><h3 id="三维线框图"><a href="#三维线框图" class="headerlink" title="三维线框图"></a>三维线框图</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> mpl_toolkits.mplot3d <span class="keyword">import</span> axes3d</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line">plt.style.use(<span class="string">&#x27;_mpl-gallery&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Make data</span></span><br><span class="line">X, Y, Z = axes3d.get_test_data(<span class="number">0.05</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Plot</span></span><br><span class="line">fig, ax = plt.subplots(subplot_kw=&#123;<span class="string">&quot;projection&quot;</span>: <span class="string">&quot;3d&quot;</span>&#125;)</span><br><span class="line">ax.plot_wireframe(X, Y, Z, rstride=<span class="number">10</span>, cstride=<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">ax.<span class="built_in">set</span>(xticklabels=[],</span><br><span class="line">       yticklabels=[],</span><br><span class="line">       zticklabels=[])</span><br><span class="line"></span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure><ol><li><p><code>from mpl_toolkits.mplot3d import axes3d</code>: 导入Matplotlib中的<code>axes3d</code>模块，这个模块包含了用于绘制三维图形的函数和工具。</p></li><li><p><code>import matplotlib.pyplot as plt</code>: 导入Matplotlib库，并将其简化为<code>plt</code>，这是Matplotlib中常用的惯例。</p></li><li><p><code>plt.style.use(&#39;_mpl-gallery&#39;)</code>: 这里使用了一个自定义的Matplotlib样式<code>&#39;_mpl-gallery&#39;</code>。Matplotlib样式用于设置图形的外观和风格。在此之前可能有一个自定义的样式定义，但代码片段中没有显示出来。</p></li><li><p><code>X, Y, Z = axes3d.get_test_data(0.05)</code>: 使用<code>axes3d.get_test_data()</code>函数获取测试数据。这个函数返回了一个包含X、Y、Z坐标数据的三维网格，用于绘制一个三维曲面。<code>0.05</code>是步长参数，控制数据的稠密程度。</p></li><li><p><code>fig, ax = plt.subplots(subplot_kw=&#123;&quot;projection&quot;: &quot;3d&quot;&#125;)</code>: 创建一个带有三维坐标轴的图形对象和一个三维坐标轴对象。<code>fig</code>代表整个图形窗口，<code>ax</code>代表图形中的三维坐标轴。</p></li><li><p><code>ax.plot_wireframe(X, Y, Z, rstride=10, cstride=10)</code>: 使用<code>ax.plot_wireframe()</code>函数绘制三维线框图。<code>X</code>、<code>Y</code>、<code>Z</code>是三维曲面的坐标数据，<code>rstride</code>和<code>cstride</code>分别控制行和列的采样步长，用于控制曲面的稠密程度。</p></li><li><p><code>ax.set(xticklabels=[], yticklabels=[], zticklabels=[])</code>: 设置三维坐标轴的刻度标签为空，这样就隐藏了x、y、z轴的刻度标签。</p></li><li><p><code>plt.show()</code>: 显示绘制的图形。</p></li></ol><p>这段代码绘制了一个三维线框图，该图显示了一个曲面的结构，曲面的形状基于获取的测试数据。三维线框图通过连接数据点之间的线条来表示曲面的形状，使得可以更好地了解曲面的结构和特征。</p><img src="https://matplotlib.org/stable/_images/sphx_glr_wire3d_simple_001_2_00x.png" class="lazyload placeholder" data-srcset="https://matplotlib.org/stable/_images/sphx_glr_wire3d_simple_001_2_00x.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="plot_wireframe">]]></content>
      
      
      <categories>
          
          <category> Computer Technology </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
            <tag> Matplotlib </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Spark与Scala</title>
      <link href="/2023/07/27/Spark%E4%B8%8EScala/"/>
      <url>/2023/07/27/Spark%E4%B8%8EScala/</url>
      
        <content type="html"><![CDATA[<h1 id="Spark与Scala"><a href="#Spark与Scala" class="headerlink" title="Spark与Scala"></a>Spark与Scala</h1><p>Scala是一种通用的编程语言，旨在融合面向对象编程和函数式编程的特性。它运行在Java虚拟机（JVM）上，因此可以与Java库和框架无缝交互，并且可以利用Java生态系统中的各种工具和库。Scala的设计目标之一是让编程更具表现力和简洁，同时提供强大的类型系统和静态类型检查。</p><p>Apache Spark是一个开源的大数据处理框架，它旨在处理大规模数据集的分布式计算。Spark提供了许多用于处理数据的高级API，例如批处理（Spark Core）和流处理（Spark Streaming），还支持SQL查询（Spark SQL）、图处理（GraphX）和机器学习（MLlib）等功能。Spark的一个关键特点是其内存计算能力，它允许在内存中进行数据处理，从而大大提高了性能。</p><p>Scala与Spark之间有着密切的关系。事实上，Spark最初是用Scala编写的，并且Scala一直是Spark主要的编程语言。这是因为Scala语言具有与Spark的分布式计算模型和函数式编程特性非常契合的特点。Scala的函数式编程范式特性使得Spark的代码可以更具表现力和易读性，从而更容易编写和维护复杂的分布式计算任务。</p><p>Spark提供了Scala API以及其他语言（如Java、Python和R）的API，但Scala API通常被认为是最原生和最灵活的。许多Spark的核心开发人员和社区成员都喜欢使用Scala来编写Spark应用程序，因为Scala的语法和功能可以更好地利用Spark提供的高级特性，使得开发更加高效。</p><p>总结：Scala是Spark的主要编程语言，它与Spark之间有着紧密的关系，Scala的设计特点与Spark的分布式计算模型和函数式编程特性非常契合，使得使用Scala编写Spark应用程序更加方便和高效。</p><h2 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h2><div class="tagLink"><a class="link-card" title="Scala官网" href="https://www.scala-lang.org/"><span class="link-card-backdrop" style="background-image: url(https://www.scala-lang.org/resources/img/frontpage/scala-spiral.png)"></span><div class="left"><img src="https://www.scala-lang.org/resources/img/frontpage/scala-spiral.png" class="lazyload placeholder" data-srcset="https://www.scala-lang.org/resources/img/frontpage/scala-spiral.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div><div class="right"><p class="text">Scala官网</p><p class="url">https://www.scala-lang.org/</p></div></a></div><div class="tagLink"><a class="link-card" title="Spark官网" href="https://spark.apache.org/"><span class="link-card-backdrop" style="background-image: url(https://spark.apache.org/images/spark-logo-rev.svg)"></span><div class="left"><img src="https://spark.apache.org/images/spark-logo-rev.svg" class="lazyload placeholder" data-srcset="https://spark.apache.org/images/spark-logo-rev.svg" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div><div class="right"><p class="text">Spark官网</p><p class="url">https://spark.apache.org/</p></div></a></div><h2 id="使用IDEA构建一个Spark-Scala项目"><a href="#使用IDEA构建一个Spark-Scala项目" class="headerlink" title="使用IDEA构建一个Spark Scala项目"></a>使用IDEA构建一个Spark Scala项目</h2><ol><li><p>下载Scala</p></li><li><p>在IDEA中设置使用Scala语言<br>添加maven依赖</p> <figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- https://mvnrepository.com/artifact/org.apache.spark/spark-core --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.spark<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spark-core_2.11<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.4.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- https://mvnrepository.com/artifact/org.apache.spark/spark-sql --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.spark<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spark-sql_2.11<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.4.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>将Scala添加到全局库中</p></li><li><p>下载插件Scala并重启IDEA</p></li></ol><h2 id="案例解析"><a href="#案例解析" class="headerlink" title="案例解析"></a>案例解析</h2><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.hankcs.hanlp.<span class="type">HanLP</span></span><br><span class="line"><span class="keyword">import</span> com.hankcs.hanlp.seg.common.<span class="type">Term</span></span><br><span class="line"><span class="keyword">import</span> org.apache.log4j.&#123;<span class="type">Level</span>, <span class="type">Logger</span>&#125;</span><br><span class="line"><span class="keyword">import</span> org.apache.spark.storage.<span class="type">StorageLevel</span></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.&#123;<span class="type">SparkConf</span>, <span class="type">SparkContext</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">SearchEngineLogAnalysis</span> </span>&#123;</span><br><span class="line"> <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line">   <span class="type">Logger</span></span><br><span class="line">     .getLogger(<span class="string">&quot;org.apache.spark&quot;</span>)</span><br><span class="line">     .setLevel(<span class="type">Level</span>.<span class="type">ERROR</span>)</span><br><span class="line">   <span class="keyword">val</span> conf = <span class="keyword">new</span> <span class="type">SparkConf</span>()</span><br><span class="line">     .setAppName(<span class="string">&quot;SearchEngineLogAnalysis&quot;</span>)</span><br><span class="line">     .setMaster(<span class="string">&quot;local[*]&quot;</span>)</span><br><span class="line">   <span class="keyword">val</span> sparkContext = <span class="keyword">new</span> <span class="type">SparkContext</span>(config = conf)</span><br><span class="line">   <span class="keyword">val</span> file = <span class="string">&quot;/Volumes/KeQing/Documents/IntelliJ IDEA Ultimate/SparkTraning/src/main/resources/reduced.txt&quot;</span></span><br><span class="line">   <span class="keyword">val</span> outputPath1 = <span class="string">&quot;/Volumes/KeQing/Documents/IntelliJ IDEA Ultimate/SparkTraning/src/main/resources/output/queryWordsWordCountRDD&quot;</span></span><br><span class="line">   <span class="keyword">val</span> outputPath2 = <span class="string">&quot;/Volumes/KeQing/Documents/IntelliJ IDEA Ultimate/SparkTraning/src/main/resources/output/userQueryAnalysisRDD&quot;</span></span><br><span class="line">   <span class="keyword">val</span> outputPath3 = <span class="string">&quot;/Volumes/KeQing/Documents/IntelliJ IDEA Ultimate/SparkTraning/src/main/resources/output/timeQueryCountAnalysisRDD&quot;</span></span><br><span class="line">   <span class="keyword">val</span> rddSougouRecord = sparkContext.textFile(file)</span><br><span class="line">     .filter(line =&gt; line != <span class="literal">null</span> &amp;&amp; line.trim.split(<span class="string">&quot;\\s+&quot;</span>).length == <span class="number">6</span>)</span><br><span class="line">     .mapPartitions(it =&gt; &#123;</span><br><span class="line">       it.map(line =&gt; &#123;</span><br><span class="line">         <span class="keyword">val</span> contents = line.trim.split(<span class="string">&quot;\\s+&quot;</span>)</span><br><span class="line">         <span class="type">SogouRecord</span>(</span><br><span class="line">           contents(<span class="number">0</span>),</span><br><span class="line">           contents(<span class="number">1</span>),</span><br><span class="line">           contents(<span class="number">2</span>).replaceAll(<span class="string">&quot;[\\[|\\]]&quot;</span>, <span class="string">&quot;&quot;</span>),</span><br><span class="line">           contents(<span class="number">3</span>).toInt,</span><br><span class="line">           contents(<span class="number">4</span>).toInt,</span><br><span class="line">           contents(<span class="number">5</span>)</span><br><span class="line">         )</span><br><span class="line">       &#125;)</span><br><span class="line">     &#125;)</span><br><span class="line">   rddSougouRecord.persist(<span class="type">StorageLevel</span>.<span class="type">MEMORY_AND_DISK</span>).count()</span><br><span class="line"></span><br><span class="line">   <span class="keyword">val</span> queryWordsWordCountRDD = rddSougouRecord.mapPartitions(it =&gt; &#123;</span><br><span class="line">     it.flatMap(record =&gt; &#123;</span><br><span class="line">       <span class="keyword">val</span> terms: util.<span class="type">List</span>[<span class="type">Term</span>] = <span class="type">HanLP</span>.segment(record.queryWords.trim)</span><br><span class="line">       <span class="keyword">import</span> scala.collection.<span class="type">JavaConverters</span>._</span><br><span class="line">       terms.asScala.map(_.word)</span><br><span class="line">     &#125;)</span><br><span class="line">   &#125;).map((_, <span class="number">1</span>)).reduceByKey(_ + _).sortBy(_._2, ascending = <span class="literal">false</span>)</span><br><span class="line"></span><br><span class="line">   queryWordsWordCountRDD.coalesce(numPartitions = <span class="number">1</span>).saveAsTextFile(outputPath1)</span><br><span class="line"></span><br><span class="line">   <span class="keyword">val</span> userQueryAnalysisRDD = rddSougouRecord.mapPartitions(it =&gt; &#123;</span><br><span class="line">     it.map(record =&gt; &#123;</span><br><span class="line">       ((record.userId, record.queryWords), <span class="number">1</span>)</span><br><span class="line">     &#125;)</span><br><span class="line">   &#125;).reduceByKey(_ + _).sortBy(_._2, ascending = <span class="literal">false</span>)</span><br><span class="line">   userQueryAnalysisRDD.coalesce(<span class="number">1</span>).saveAsTextFile(outputPath2)</span><br><span class="line"></span><br><span class="line">   <span class="keyword">val</span> timeQueryCountAnalysisRDD = rddSougouRecord.mapPartitions(it =&gt; &#123;</span><br><span class="line">     it.map(record =&gt; &#123;</span><br><span class="line">       (record.queryTime.substring(<span class="number">0</span>, <span class="number">2</span>), <span class="number">1</span>)</span><br><span class="line">     &#125;)</span><br><span class="line">   &#125;).reduceByKey(_ + _).sortBy(_._2, ascending = <span class="literal">false</span>)</span><br><span class="line">   timeQueryCountAnalysisRDD.coalesce(<span class="number">1</span>).saveAsTextFile(outputPath3)</span><br><span class="line"></span><br><span class="line">   rddSougouRecord.unpersist()</span><br><span class="line">   sparkContext.stop()</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="逐步分析"><a href="#逐步分析" class="headerlink" title="逐步分析"></a>逐步分析</h3><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Logger</span></span><br><span class="line">  .getLogger(<span class="string">&quot;org.apache.spark&quot;</span>)</span><br><span class="line">  .setLevel(<span class="type">Level</span>.<span class="type">ERROR</span>)</span><br></pre></td></tr></table></figure><p>设置<code>org.apache.spark</code>的日志输出级别，可以在测试阶段更加方便的观察控制台的输出结果</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> conf = <span class="keyword">new</span> <span class="type">SparkConf</span>()</span><br><span class="line">  .setAppName(<span class="string">&quot;SearchEngineLogAnalysis&quot;</span>)</span><br><span class="line">  .setMaster(<span class="string">&quot;local[*]&quot;</span>)</span><br></pre></td></tr></table></figure><p>这段代码是使用Scala语言创建一个Spark应用程序的配置对象（SparkConf），并对其进行一些设置。</p><ol><li><p><code>val conf = new SparkConf()</code>: 首先，创建了一个名为<code>conf</code>的不可变（val）变量，并通过<code>new SparkConf()</code>来实例化一个新的SparkConf对象。SparkConf是用于配置Spark应用程序的类。</p></li><li><p><code>.setAppName(&quot;SearchEngineLogAnalysis&quot;)</code>: 使用<code>.setAppName()</code>方法为Spark应用程序设置一个名称，这里将应用程序的名称设置为”SearchEngineLogAnalysis”。应用程序的名称将在Spark集群中显示，用于标识不同的应用程序。</p></li><li><p><code>.setMaster(&quot;local[*]&quot;)</code>: 使用<code>.setMaster()</code>方法设置Spark应用程序的主节点URL或本地模式。在这里，将主节点URL设置为”local[*]”，表示在本地模式下运行Spark应用程序，并使用所有可用的CPU内核。</p></li></ol><p>综合起来，这段代码的作用是创建一个Spark应用程序的配置对象，设置了应用程序的名称为<code>SearchEngineLogAnalysis</code>，并将其配置为在本地模式下运行，并使用所有可用的CPU内核进行并行处理。请注意，在本地模式下运行的Spark应用程序将不会连接到Spark集群，而是在本地计算机上以单机模式运行，适用于开发和测试阶段。在实际生产环境中，你需要将<code>.setMaster()</code>方法的参数设置为连接到Spark集群的主节点URL，以便在集群上分布式运行你的Spark应用程序。</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> sparkContext = <span class="keyword">new</span> <span class="type">SparkContext</span>(config = conf)</span><br></pre></td></tr></table></figure><p>这段代码用于创建一个SparkContext对象，它是Spark应用程序与Spark集群之间的主要接口。</p><ol><li><p><code>val sparkContext</code>: 这是一个不可变（val）变量，用于存储SparkContext对象。</p></li><li><p><code>new SparkContext(config = conf)</code>: 这是创建SparkContext对象的语句。通过<code>new SparkContext()</code>来实例化一个新的SparkContext对象，并通过<code>config = conf</code>参数将之前创建的SparkConf对象<code>conf</code>传递给SparkContext构造函数。</p></li></ol><p>在这里，我们使用之前配置好的SparkConf对象<code>conf</code>来初始化SparkContext。SparkConf对象包含了应用程序的各种配置设置，而SparkContext则使用这些配置在Spark集群上执行任务。</p><p>需要注意的是，创建SparkContext对象是Spark早期版本（2.x及之前）的做法。从Spark 2.0版本开始，推荐使用SparkSession来代替SparkContext。SparkSession是一个更高级的接口，它封装了SparkContext和SQLContext，并且提供了更方便的功能，例如对DataFrame和Dataset的支持。</p><p>如果在使用Spark 2.x及之后版本，建议改用SparkSession来初始化Spark应用程序，示例如下：</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.spark.sql.<span class="type">SparkSession</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">val</span> spark = <span class="type">SparkSession</span>.builder()</span><br><span class="line">  .appName(<span class="string">&quot;SearchEngineLogAnalysis&quot;</span>)</span><br><span class="line">  .master(<span class="string">&quot;local[*]&quot;</span>)</span><br><span class="line">  .getOrCreate()</span><br></pre></td></tr></table></figure><p>使用<code>SparkSession.builder()</code>来构建SparkSession对象，并使用<code>.appName()</code>方法设置应用程序名称，<code>.master()</code>方法设置主节点URL或本地模式。最后，通过<code>.getOrCreate()</code>方法来获取或创建一个SparkSession对象。使用SparkSession之后，可以通过<code>.sparkContext</code>属性来访问底层的SparkContext对象，以便进行一些底层操作。</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> rddSougouRecord = sparkContext.textFile(file)</span><br><span class="line">  .filter(line =&gt; line != <span class="literal">null</span> &amp;&amp; line.trim.split(<span class="string">&quot;\\s+&quot;</span>).length == <span class="number">6</span>)</span><br><span class="line">  .mapPartitions(it =&gt; &#123;</span><br><span class="line">    it.map(line =&gt; &#123;</span><br><span class="line">      <span class="keyword">val</span> contents = line.trim.split(<span class="string">&quot;\\s+&quot;</span>)</span><br><span class="line">      <span class="type">SogouRecord</span>(</span><br><span class="line">        contents(<span class="number">0</span>),</span><br><span class="line">        contents(<span class="number">1</span>),</span><br><span class="line">        contents(<span class="number">2</span>).replaceAll(<span class="string">&quot;[\\[|\\]]&quot;</span>, <span class="string">&quot;&quot;</span>),</span><br><span class="line">        contents(<span class="number">3</span>).toInt,</span><br><span class="line">        contents(<span class="number">4</span>).toInt,</span><br><span class="line">        contents(<span class="number">5</span>)</span><br><span class="line">      )</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;)</span><br></pre></td></tr></table></figure><p>这段代码是使用Spark的RDD（Resilient Distributed Dataset） API来读取一个文本文件，并根据特定的规则将每行数据转换为自定义的SogouRecord对象。</p><ol><li><p><code>val rddSougouRecord = sparkContext.textFile(file)</code>: 这行代码读取文本文件并创建了一个RDD（Resilient Distributed Dataset）。<code>file</code>是指定的文件路径。<code>textFile</code>方法将文件的每一行作为RDD的一个元素。</p></li><li><p><code>.filter(line =&gt; line != null &amp;&amp; line.trim.split(&quot;\\s+&quot;).length == 6)</code>: 在上一步创建的RDD上调用<code>filter</code>方法，过滤掉一些不符合条件的行。<code>filter</code>方法接受一个函数作为参数，这里使用了一个Lambda表达式。Lambda表达式中的条件<code>line != null &amp;&amp; line.trim.split(&quot;\\s+&quot;).length == 6</code>判断是否满足过滤条件：行不为null且按空格拆分后有6个元素。</p></li><li><p><code>.mapPartitions(it =&gt; &#123; ... &#125;)</code>: 这是一个转换操作，使用<code>mapPartitions</code>方法对每个分区（partition）中的数据进行转换。<code>mapPartitions</code>方法也接受一个函数作为参数，该函数的输入是每个分区的迭代器（iterator），输出是转换后的迭代器。</p></li><li><p><code>it.map(line =&gt; &#123; ... &#125;)</code>: 在<code>mapPartitions</code>方法的函数体内，对每个分区的数据（即每行文本）进行转换。使用<code>map</code>方法对每行文本应用一个函数，将文本按空格拆分，并根据自定义的规则构造<code>SogouRecord</code>对象。</p></li><li><p><code>val contents = line.trim.split(&quot;\\s+&quot;)</code>: 将当前行去除首尾空格后按空格进行拆分，将结果保存在<code>contents</code>数组中。</p></li><li><p><code>SogouRecord(...)</code>：根据拆分后的<code>contents</code>数组的内容构造<code>SogouRecord</code>对象。<code>SogouRecord</code>是一个自定义的类，它包含了6个字段，对应着每行文本中拆分后的6个元素。</p></li></ol><p>最后，整个代码的作用是从给定的文件中读取数据，根据特定的条件过滤掉无效的行，然后按照自定义的规则将每行文本转换为<code>SogouRecord</code>对象，并最终得到一个包含<code>SogouRecord</code>对象的RDD <code>rddSougouRecord</code>。</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rddSougouRecord.persist(<span class="type">StorageLevel</span>.<span class="type">MEMORY_AND_DISK</span>).count()</span><br></pre></td></tr></table></figure><p>这行代码对之前的RDD <code>rddSougouRecord</code> 进行了持久化（缓存）操作，并计算了RDD中元素的数量。</p><ol><li><p><code>rddSougouRecord.persist(StorageLevel.MEMORY_AND_DISK)</code>: 这部分代码对RDD <code>rddSougouRecord</code> 进行了持久化操作。在Spark中，RDD是一个不可变的分布式数据集，当对一个RDD执行一系列的转换操作时，每个转换都会生成一个新的RDD，而原始RDD则不会受到影响。持久化（缓存）操作的目的是将RDD的数据缓存在内存或磁盘中，这样可以避免在后续的操作中重复计算，提高计算效率。</p><p><code>persist</code>方法接受一个参数，即存储级别（StorageLevel）。在这里，使用了<code>StorageLevel.MEMORY_AND_DISK</code>存储级别，表示将数据缓存在内存中，如果内存空间不足，则溢写到磁盘。这样可以在内存充足时快速访问数据，并在内存不足时保留数据在磁盘上，以便后续使用。</p></li><li><p><code>.count()</code>: 这部分代码对持久化后的RDD执行了<code>count</code>操作，用于计算RDD中元素的数量。<code>count</code>是一个动作（action）操作，会触发实际的计算并返回RDD中元素的数量。</p></li></ol><p>综合起来，这行代码的作用是对RDD <code>rddSougouRecord</code> 进行持久化操作，将数据缓存在内存或磁盘中，然后计算RDD中元素的数量。持久化操作使得在后续对<code>rddSougouRecord</code>执行其他转换或动作操作时，可以从缓存中快速访问数据，而不必每次都重新计算。</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> queryWordsWordCountRDD = rddSougouRecord.mapPartitions(it =&gt; &#123;</span><br><span class="line">  it.flatMap(record =&gt; &#123;</span><br><span class="line">    <span class="keyword">val</span> terms: util.<span class="type">List</span>[<span class="type">Term</span>] = <span class="type">HanLP</span>.segment(record.queryWords.trim)</span><br><span class="line">    <span class="keyword">import</span> scala.collection.<span class="type">JavaConverters</span>._</span><br><span class="line">    terms.asScala.map(_.word)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;).map((_, <span class="number">1</span>)).reduceByKey(_ + _).sortBy(_._2, ascending = <span class="literal">false</span>)</span><br></pre></td></tr></table></figure><p>这段代码是对之前持久化的RDD <code>rddSougouRecord</code> 进行一系列转换操作，最终得到一个包含查询词（queryWords）及其出现频率的RDD <code>queryWordsWordCountRDD</code>。</p><ol><li><p><code>val queryWordsWordCountRDD = rddSougouRecord.mapPartitions(it =&gt; &#123; ... &#125;)</code>: 这行代码首先对持久化的RDD <code>rddSougouRecord</code> 进行了 <code>mapPartitions</code> 转换操作。<code>mapPartitions</code> 方法对 RDD 的每个分区进行操作，并返回一个新的 RDD，它的每个元素都是转换后的结果。这里使用了一个 Lambda 表达式来处理每个分区的数据。</p></li><li><p><code>it.flatMap(record =&gt; &#123; ... &#125;)</code>: 在 <code>mapPartitions</code> 中，对每个分区的元素进行 <code>flatMap</code> 转换操作。<code>flatMap</code> 方法类似于 <code>map</code> 方法，但是它可以将每个输入元素映射为零个或多个输出元素。在这里，<code>flatMap</code> 用于将每个 <code>SogouRecord</code> 对象的 <code>queryWords</code> 字段拆分为单个词语。</p></li><li><p><code>val terms: util.List[Term] = HanLP.segment(record.queryWords.trim)</code>: 这行代码使用了 HanLP 中文分词库对每个 <code>queryWords</code> 进行中文分词，并将结果保存在 <code>terms</code> 变量中。<code>HanLP.segment</code> 方法返回一个 <code>util.List[Term]</code> 对象，其中包含了分词后的词语。</p></li><li><p><code>import scala.collection.JavaConverters._</code>: 这行代码导入了 Scala 与 Java 集合之间的转换工具，用于将 Java 集合转换为 Scala 集合，方便后续的处理。</p></li><li><p><code>terms.asScala.map(_.word)</code>: 在前面的步骤中，将 <code>queryWords</code> 分词后得到的结果是一个 Java 集合，这里使用 <code>asScala</code> 方法将其转换为 Scala 集合，并使用 <code>map</code> 方法提取每个 <code>Term</code> 对象的 <code>word</code> 字段，即每个词语，形成一个包含所有词语的新的 Scala 集合。</p></li><li><p><code>.map((_, 1))</code>: 这一步是对每个词语添加一个计数值 1，将每个词语映射为一个二元组 <code>(词语, 1)</code>。</p></li><li><p><code>.reduceByKey(_ + _)</code>: 接着使用 <code>reduceByKey</code> 方法，将相同的词语进行分组并求和。即将相同词语的计数值相加，得到每个词语的出现频率。</p></li><li><p><code>.sortBy(_._2, ascending = false)</code>: 最后使用 <code>sortBy</code> 方法，按照词语出现频率（即二元组的第二个元素）进行降序排序，得到包含查询词及其出现频率的 RDD <code>queryWordsWordCountRDD</code>。</p></li></ol><p>综合起来，这段代码的作用是将每个 <code>SogouRecord</code> 对象的 <code>queryWords</code> 字段进行中文分词，统计查询词的出现频率，并按频率降序排列，得到一个包含查询词及其出现频率的 RDD <code>queryWordsWordCountRDD</code>。</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">queryWordsWordCountRDD.coalesce(numPartitions = <span class="number">1</span>).saveAsTextFile(outputPath1)</span><br></pre></td></tr></table></figure><p>这段代码是将之前得到的RDD <code>queryWordsWordCountRDD</code> 进行一系列操作，并将结果保存为文本文件。</p><ol><li><p><code>queryWordsWordCountRDD.coalesce(numPartitions = 1)</code>: 这部分代码使用了 <code>coalesce</code> 方法对RDD进行重新分区。<code>coalesce</code> 方法可以将RDD的分区数量减少到指定的数量。在这里，<code>numPartitions = 1</code> 表示将RDD合并为一个分区，也就是将所有数据合并到一个分区中。</p></li><li><p><code>.saveAsTextFile(outputPath1)</code>: 接着使用 <code>saveAsTextFile</code> 方法将RDD保存为文本文件。<code>saveAsTextFile</code> 方法将RDD中的每个元素（每行文本）写入到文本文件中。<code>outputPath1</code> 是保存文本文件的输出路径。</p></li></ol><p>综合起来，这段代码的作用是将之前计算得到的 <code>queryWordsWordCountRDD</code> 重新分区为一个分区，并将结果保存为文本文件。在文本文件中，每个查询词及其出现频率将以文本行的形式存储。注意，由于使用了 <code>coalesce(1)</code>，结果文件将只有一个分区，并且所有数据都会写入同一个文件中。如果数据量很大，可能会造成单个文件过大的问题。如果想要分多个文件保存，可以调整 <code>coalesce</code> 方法中的分区数为需要的值。</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">rddSougouRecord.unpersist()</span><br><span class="line">sparkContext.stop()</span><br></pre></td></tr></table></figure><p>这段代码是对之前持久化的RDD <code>rddSougouRecord</code> 进行解除持久化，并停止SparkContext对象，从而终止Spark应用程序的执行。</p><ol><li><p><code>rddSougouRecord.unpersist()</code>: 这行代码调用了 <code>unpersist</code> 方法，用于解除RDD的持久化。在之前的代码中，我们对 <code>rddSougouRecord</code> 进行了持久化（缓存）操作，将数据缓存到内存或磁盘中，以便后续的操作可以快速访问数据。而 <code>unpersist</code> 方法的作用就是解除持久化，即释放RDD的缓存，从而释放内存或磁盘空间。在某些情况下，当RDD不再被频繁使用时，可以手动调用 <code>unpersist</code> 方法来释放资源，以避免占用过多的存储空间。</p></li><li><p><code>sparkContext.stop()</code>: 这行代码调用了 <code>stop</code> 方法，用于停止SparkContext对象，从而终止Spark应用程序的执行。<code>SparkContext</code> 是Spark应用程序与Spark集群之间的主要接口，调用 <code>stop</code> 方法将会关闭与集群的连接，并释放资源。在应用程序执行完成后，通常会调用 <code>stop</code> 方法来优雅地终止Spark应用程序，释放集群资源，避免资源浪费。</p></li></ol><p>综合起来，这段代码的作用是解除之前对RDD的持久化，释放缓存的资源，并停止SparkContext对象，从而正常终止Spark应用程序的执行。</p><h2 id="使用Spark-SQL案例解析"><a href="#使用Spark-SQL案例解析" class="headerlink" title="使用Spark SQL案例解析"></a>使用Spark SQL案例解析</h2><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.log4j.&#123;<span class="type">Level</span>, <span class="type">Logger</span>&#125;</span><br><span class="line"><span class="keyword">import</span> org.apache.spark.sql.&#123;<span class="type">Row</span>, <span class="type">SparkSession</span>&#125;</span><br><span class="line"><span class="keyword">import</span> org.apache.spark.sql.types.&#123;<span class="type">IntegerType</span>, <span class="type">StringType</span>, <span class="type">StructField</span>, <span class="type">StructType</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">SogouAnalysisSQL</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line">    <span class="comment">// 设置输出的日志级别</span></span><br><span class="line">    <span class="type">Logger</span>.getLogger(<span class="string">&quot;org.apache.spark&quot;</span>).setLevel(<span class="type">Level</span>.<span class="type">ERROR</span>)</span><br><span class="line">    <span class="keyword">val</span> spark = <span class="type">SparkSession</span>.builder()</span><br><span class="line">      .appName(<span class="string">&quot;SogouAnalysisSQL&quot;</span>)</span><br><span class="line">      .master(<span class="string">&quot;local[*]&quot;</span>)</span><br><span class="line">      .getOrCreate()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">val</span> file = <span class="string">&quot;/Volumes/KeQing/Documents/IntelliJ IDEA Ultimate/SparkTraning/src/main/resources/reduced.txt&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">val</span> fileRDD = spark.sparkContext.textFile(file)</span><br><span class="line">      .filter(line =&gt; line != <span class="literal">null</span> &amp;&amp; line.trim.split(<span class="string">&quot;\\s+&quot;</span>).length == <span class="number">6</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">val</span> schema = <span class="type">StructType</span>(<span class="type">Array</span>(</span><br><span class="line">      <span class="type">StructField</span>(<span class="string">&quot;queryTime&quot;</span>, <span class="type">StringType</span>, <span class="literal">false</span>),</span><br><span class="line">      <span class="type">StructField</span>(<span class="string">&quot;userId&quot;</span>, <span class="type">StringType</span>, <span class="literal">false</span>),</span><br><span class="line">      <span class="type">StructField</span>(<span class="string">&quot;queryWords&quot;</span>, <span class="type">StringType</span>, <span class="literal">false</span>),</span><br><span class="line">      <span class="type">StructField</span>(<span class="string">&quot;resultRank&quot;</span>, <span class="type">IntegerType</span>, <span class="literal">false</span>),</span><br><span class="line">      <span class="type">StructField</span>(<span class="string">&quot;clickRank&quot;</span>, <span class="type">IntegerType</span>, <span class="literal">false</span>),</span><br><span class="line">      <span class="type">StructField</span>(<span class="string">&quot;clickUrl&quot;</span>, <span class="type">StringType</span>, <span class="literal">false</span>)</span><br><span class="line">    ))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">val</span> rddRow = fileRDD.mapPartitions(it =&gt; &#123;</span><br><span class="line">      it.map(line =&gt; &#123;</span><br><span class="line">        <span class="keyword">val</span> contents = line.trim.split(<span class="string">&quot;\\s+&quot;</span>)</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">          <span class="comment">// 封装的字段的时候，顺序要与定义的schema顺序完全一致</span></span><br><span class="line">          <span class="type">Row</span>(</span><br><span class="line">            contents(<span class="number">0</span>),</span><br><span class="line">            contents(<span class="number">1</span>),</span><br><span class="line">            contents(<span class="number">2</span>).replaceAll(<span class="string">&quot;[\\[|\\]]&quot;</span>, <span class="string">&quot;&quot;</span>),</span><br><span class="line">            contents(<span class="number">3</span>).toInt,</span><br><span class="line">            contents(<span class="number">4</span>).toInt,</span><br><span class="line">            contents(<span class="number">5</span>)</span><br><span class="line">          )</span><br><span class="line">        &#125; <span class="keyword">catch</span> &#123;</span><br><span class="line">          <span class="keyword">case</span> e: <span class="type">Exception</span> =&gt; <span class="type">Row</span>(<span class="string">&quot;error&quot;</span>, <span class="string">&quot;error&quot;</span>, <span class="string">&quot;error&quot;</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="string">&quot;error&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">val</span> df = spark.createDataFrame(rddRow, schema)</span><br><span class="line"></span><br><span class="line">    df.createOrReplaceTempView(<span class="string">&quot;sogou_view&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">val</span> sql =</span><br><span class="line">      <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        |select * from sogou_view where clickUrl like &#x27;www%&#x27;</span></span><br><span class="line"><span class="string">        |limit 3</span></span><br><span class="line"><span class="string">        |&quot;&quot;&quot;</span>.stripMargin</span><br><span class="line"></span><br><span class="line">    <span class="keyword">val</span> sqlResult = spark.sql(sql)</span><br><span class="line">    <span class="comment">//    sqlResult.show(truncate = false)</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">val</span> querySQL =</span><br><span class="line">      <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        |select userId,queryWords,count(*) as query_count from sogou_view</span></span><br><span class="line"><span class="string">        |group by userId,queryWords</span></span><br><span class="line"><span class="string">        |order by userid,query_count desc</span></span><br><span class="line"><span class="string">        |&quot;&quot;&quot;</span>.stripMargin</span><br><span class="line"></span><br><span class="line">    <span class="keyword">val</span> queryResult = spark.sql(querySQL)</span><br><span class="line"></span><br><span class="line">    <span class="comment">//    queryResult.show(truncate = false)</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">val</span> timeSQL =</span><br><span class="line">      <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        |select substring(queryTime,0,5) as query_time,count(*) as query_count from sogou_view</span></span><br><span class="line"><span class="string">        |group by substring(queryTime,0,5)</span></span><br><span class="line"><span class="string">        |order by query_time,query_count desc</span></span><br><span class="line"><span class="string">        |&quot;&quot;&quot;</span>.stripMargin</span><br><span class="line"></span><br><span class="line">    <span class="keyword">val</span> timeResult = spark.sql(timeSQL)</span><br><span class="line">    timeResult.show(truncate = <span class="literal">false</span>)</span><br><span class="line">    timeResult.rdd.coalesce(<span class="number">1</span>).saveAsTextFile(<span class="string">&quot;/Volumes/KeQing/Documents/IntelliJ IDEA Ultimate/SparkTraning/src/main/resources/output/timeResult&quot;</span>)</span><br><span class="line">    spark.stop()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h3><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> schema = <span class="type">StructType</span>(<span class="type">Array</span>(</span><br><span class="line">  <span class="type">StructField</span>(<span class="string">&quot;queryTime&quot;</span>, <span class="type">StringType</span>, <span class="literal">false</span>),</span><br><span class="line">  <span class="type">StructField</span>(<span class="string">&quot;userId&quot;</span>, <span class="type">StringType</span>, <span class="literal">false</span>),</span><br><span class="line">  <span class="type">StructField</span>(<span class="string">&quot;queryWords&quot;</span>, <span class="type">StringType</span>, <span class="literal">false</span>),</span><br><span class="line">  <span class="type">StructField</span>(<span class="string">&quot;resultRank&quot;</span>, <span class="type">IntegerType</span>, <span class="literal">false</span>),</span><br><span class="line">  <span class="type">StructField</span>(<span class="string">&quot;clickRank&quot;</span>, <span class="type">IntegerType</span>, <span class="literal">false</span>),</span><br><span class="line">  <span class="type">StructField</span>(<span class="string">&quot;clickUrl&quot;</span>, <span class="type">StringType</span>, <span class="literal">false</span>)</span><br><span class="line">))</span><br></pre></td></tr></table></figure><p>这段代码定义了一个Spark SQL的Schema，用于描述数据的结构和字段类型。Spark SQL是Spark的模块，它提供了用于处理结构化数据的高级数据处理接口。</p><ol><li><p><code>val schema = StructType(Array(...))</code>: 这行代码创建了一个<code>StructType</code>对象，该对象表示了数据的结构。<code>StructType</code>是Spark SQL中用于表示数据结构的类，它包含一个包含了多个<code>StructField</code>的数组。</p></li><li><p><code>StructField(&quot;queryTime&quot;, StringType, false)</code>: 这行代码创建了一个<code>StructField</code>对象，表示数据的一个字段。<code>StructField</code>接受三个参数：字段名称（”queryTime”）、字段类型（StringType）和是否可空（false）。</p></li><li><p><code>StructField(&quot;userId&quot;, StringType, false)</code>: 同上，创建了一个表示”userId”字段的<code>StructField</code>对象。</p></li><li><p><code>StructField(&quot;queryWords&quot;, StringType, false)</code>: 同上，创建了一个表示”queryWords”字段的<code>StructField</code>对象。</p></li><li><p><code>StructField(&quot;resultRank&quot;, IntegerType, false)</code>: 同上，创建了一个表示”resultRank”字段的<code>StructField</code>对象。这里字段类型是<code>IntegerType</code>，表示整数类型。</p></li><li><p><code>StructField(&quot;clickRank&quot;, IntegerType, false)</code>: 同上，创建了一个表示”clickRank”字段的<code>StructField</code>对象。</p></li><li><p><code>StructField(&quot;clickUrl&quot;, StringType, false)</code>: 同上，创建了一个表示”clickUrl”字段的<code>StructField</code>对象。</p></li></ol><p>综合起来，这段代码定义了一个包含六个字段的Schema，每个字段都有一个名称、一个字段类型和一个是否可空的标志。这个Schema描述了一个数据集，其中包含了查询时间（queryTime）、用户ID（userId）、查询词（queryWords）、结果排名（resultRank）、点击排名（clickRank）和点击URL（clickUrl）等六个字段。通过定义Schema，我们可以将RDD转换为DataFrame，从而利用Spark SQL的高级功能进行数据处理和查询。</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> rddRow = fileRDD.mapPartitions(it =&gt; &#123;</span><br><span class="line">  it.map(line =&gt; &#123;</span><br><span class="line">    <span class="keyword">val</span> contents = line.trim.split(<span class="string">&quot;\\s+&quot;</span>)</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="comment">// 封装的字段的时候，顺序要与定义的schema顺序完全一致</span></span><br><span class="line">      <span class="type">Row</span>(</span><br><span class="line">        contents(<span class="number">0</span>),</span><br><span class="line">        contents(<span class="number">1</span>),</span><br><span class="line">        contents(<span class="number">2</span>).replaceAll(<span class="string">&quot;[\\[|\\]]&quot;</span>, <span class="string">&quot;&quot;</span>),</span><br><span class="line">        contents(<span class="number">3</span>).toInt,</span><br><span class="line">        contents(<span class="number">4</span>).toInt,</span><br><span class="line">        contents(<span class="number">5</span>)</span><br><span class="line">      )</span><br><span class="line">    &#125; <span class="keyword">catch</span> &#123;</span><br><span class="line">      <span class="keyword">case</span> e: <span class="type">Exception</span> =&gt; <span class="type">Row</span>(<span class="string">&quot;error&quot;</span>, <span class="string">&quot;error&quot;</span>, <span class="string">&quot;error&quot;</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="string">&quot;error&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>这段代码对之前的RDD <code>fileRDD</code> 进行了一系列转换操作，将每行文本数据转换为Spark SQL的<code>Row</code>对象，并得到一个新的RDD <code>rddRow</code>。</p><ol><li><p><code>val rddRow = fileRDD.mapPartitions(it =&gt; &#123; ... &#125;)</code>: 这行代码首先对RDD <code>fileRDD</code> 进行了 <code>mapPartitions</code> 转换操作。<code>mapPartitions</code> 方法对RDD的每个分区进行操作，并返回一个新的RDD，它的每个元素都是转换后的结果。这里使用了一个 Lambda 表达式来处理每个分区的数据。</p></li><li><p><code>it.map(line =&gt; &#123; ... &#125;)</code>: 在 <code>mapPartitions</code> 中，对每个分区的元素（即每行文本）进行转换操作。</p></li><li><p><code>val contents = line.trim.split(&quot;\\s+&quot;)</code>: 将当前行去除首尾空格后按空格进行拆分，将结果保存在 <code>contents</code> 数组中。</p></li><li><p><code>try &#123; ... &#125; catch &#123; ... &#125;</code>: 这是一个异常处理结构，用于捕获可能的异常。在这里，代码尝试根据之前定义的Schema封装每行数据为<code>Row</code>对象。如果成功封装，则返回封装好的<code>Row</code>对象；如果出现异常（例如数组越界或类型转换失败），则将异常捕获，并返回一个包含错误信息的<code>Row</code>对象。</p></li><li><p><code>Row(...)</code>: 在 <code>try</code> 块中，根据之前定义的Schema构造<code>Row</code>对象。<code>Row</code>对象是Spark SQL中的一种数据结构，它用于表示一行数据，其中的参数按照之前定义的Schema的顺序对应各个字段。</p></li><li><p><code>contents(2).replaceAll(&quot;[\\[|\\]]&quot;, &quot;&quot;)</code>: 这行代码对第三个字段（contents(2)）进行处理，去除其中的方括号 “[ ]”。</p></li><li><p><code>contents(3).toInt, contents(4).toInt</code>: 这行代码将第四个字段（contents(3)）和第五个字段（contents(4)）转换为整数类型。</p></li><li><p><code>case e: Exception =&gt; Row(&quot;error&quot;, &quot;error&quot;, &quot;error&quot;, 0, 0, &quot;error&quot;)</code>: 在 <code>catch</code> 块中，捕获异常，并返回一个包含错误信息的<code>Row</code>对象。如果出现异常，则用”error”字符串代替无法解析的字段，并将数值类型字段设为0。</p></li></ol><p>综合起来，这段代码的作用是将每行文本数据转换为Spark SQL的<code>Row</code>对象，并根据之前定义的Schema对字段进行类型转换和处理。如果能成功转换，则得到一个包含正确数据的<code>Row</code>对象；如果出现异常，则返回一个包含错误信息的<code>Row</code>对象。最终得到的RDD <code>rddRow</code> 包含了经过处理的<code>Row</code>对象，可以用于构建DataFrame并使用Spark SQL的高级功能进行数据处理和查询。</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> df = spark.createDataFrame(rddRow, schema)</span><br></pre></td></tr></table></figure><p>这段代码使用之前得到的RDD <code>rddRow</code> 和之前定义的Schema <code>schema</code> 来创建一个DataFrame。DataFrame是Spark SQL中的一个分布式数据表，它可以使用结构化的数据和Schema进行处理和查询。</p><ol><li><p><code>val df = spark.createDataFrame(rddRow, schema)</code>: 这行代码调用了SparkSession对象的 <code>createDataFrame</code> 方法，用于创建一个DataFrame。<code>createDataFrame</code> 方法接受两个参数：第一个参数是之前创建的RDD <code>rddRow</code>，第二个参数是之前定义的Schema <code>schema</code>。</p></li><li><p><code>rddRow</code>: 这是之前转换得到的RDD，其中的每个元素都是一个Spark SQL的<code>Row</code>对象。该RDD包含了处理后的数据，每个<code>Row</code>对象按照之前定义的Schema的顺序对应各个字段。</p></li><li><p><code>schema</code>: 这是之前定义的Schema，它描述了DataFrame中每个字段的名称和类型。</p></li></ol><p>综合起来，这段代码的作用是利用之前处理得到的<code>rddRow</code> 和定义好的 <code>schema</code>，创建一个DataFrame <code>df</code>。DataFrame是一个结构化的、可分布式处理的数据表，现在我们可以使用<code>df</code> 来使用Spark SQL的高级功能进行数据处理和查询。DataFrame提供了更方便的数据处理接口，可以使用SQL语句或DataFrame API来进行数据分析、过滤、聚合、连接等操作。</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.createOrReplaceTempView(<span class="string">&quot;sogou_view&quot;</span>)</span><br></pre></td></tr></table></figure><p>这段代码在Spark SQL中将DataFrame <code>df</code> 注册为一个临时视图（Temporary View），使其可以在当前SparkSession中被查询。临时视图是一种临时的数据表，仅在当前SparkSession的生命周期内有效，通常用于执行SQL查询。</p><ol><li><p><code>df.createOrReplaceTempView(&quot;sogou_view&quot;)</code>: 这行代码调用了DataFrame <code>df</code> 的 <code>createOrReplaceTempView</code> 方法，用于创建或替换一个临时视图。<code>createOrReplaceTempView</code> 方法接受一个字符串参数，表示视图的名称。在这里，视图名称被设置为”sogou_view”。</p></li><li><p>“sogou_view”: 这是临时视图的名称。通过此名称，可以在当前SparkSession中使用SQL语句查询DataFrame <code>df</code> 的数据。</p></li></ol><p>综合起来，这段代码的作用是在当前SparkSession中将DataFrame <code>df</code> 注册为一个临时视图，使得我们可以在后续的操作中使用SQL语句查询临时视图的数据。通过创建临时视图，我们可以使用更熟悉的SQL语法来进行数据查询和分析。视图只在当前SparkSession的生命周期内有效，不会被持久化到存储系统中。如果需要在不同的SparkSession中访问相同的视图，可以使用<code>createGlobalTempView</code>方法，创建一个全局临时视图。</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> timeSQL =</span><br><span class="line">  <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    |select substring(queryTime,0,5) as query_time,count(*) as query_count from sogou_view</span></span><br><span class="line"><span class="string">    |group by substring(queryTime,0,5)</span></span><br><span class="line"><span class="string">    |order by query_time,query_count desc</span></span><br><span class="line"><span class="string">    |&quot;&quot;&quot;</span>.stripMargin</span><br><span class="line"></span><br><span class="line"><span class="keyword">val</span> timeResult = spark.sql(timeSQL)</span><br><span class="line">timeResult.show(truncate = <span class="literal">false</span>)</span><br></pre></td></tr></table></figure><p>这段代码使用Spark SQL查询之前创建的临时视图 <code>sogou_view</code>，并统计查询时间（<code>queryTime</code>字段）的每年月份（截取前5个字符）的查询次数。然后按照查询时间（年月份）进行分组，并按查询次数降序排序，最后将查询结果打印输出。</p><ol><li><p><code>val timeSQL = &quot;&quot;&quot; ... &quot;&quot;&quot;</code>: 这是一个包含SQL查询语句的多行字符串。在Scala中，可以使用三个双引号 <code>&quot;&quot;&quot; ... &quot;&quot;&quot;</code> 来定义多行字符串，其中的换行符和缩进都会被保留。这个SQL查询语句用于统计查询时间（<code>queryTime</code>字段）的每年月份的查询次数，并按照年月份进行分组和排序。</p></li><li><p><code>select substring(queryTime,0,5) as query_time, count(*) as query_count from sogou_view group by substring(queryTime,0,5) order by query_time, query_count desc</code>: 这是SQL查询语句的主体部分。在这里，使用<code>substring</code>函数截取<code>queryTime</code>字段的前5个字符（即年月份），并将其命名为<code>query_time</code>。然后使用<code>count(*)</code>函数对查询结果进行计数，得到每个年月份的查询次数。接着使用<code>group by</code>子句对结果按照年月份进行分组，最后使用<code>order by</code>子句按照年月份和查询次数降序排序。</p></li><li><p><code>val timeResult = spark.sql(timeSQL)</code>: 这行代码使用<code>spark.sql</code>方法执行之前定义的SQL查询语句，并将结果保存在<code>timeResult</code>中。<code>spark.sql</code>方法接受一个SQL查询字符串作为参数，并返回一个DataFrame，其中包含了查询结果的数据。</p></li><li><p><code>timeResult.show(truncate = false)</code>: 最后，使用<code>show</code>方法打印输出查询结果。<code>show</code>方法用于显示DataFrame的内容，默认显示前20行，并且截断字段内容以便于显示。通过设置<code>truncate = false</code>，可以禁用字段内容的截断，以便完整显示字段的内容。</p></li></ol><p>综合起来，这段代码的作用是执行SQL查询，统计每个查询时间（年月份）的查询次数，并按照年月份进行分组和降序排序，然后将查询结果打印输出。</p>]]></content>
      
      
      <categories>
          
          <category> Computer Technology </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Scala </tag>
            
            <tag> Spark </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>7.13-7.16技术培训实记</title>
      <link href="/2023/07/12/7-13-7-16%E6%8A%80%E6%9C%AF%E5%9F%B9%E8%AE%AD%E5%AE%9E%E8%AE%B0/"/>
      <url>/2023/07/12/7-13-7-16%E6%8A%80%E6%9C%AF%E5%9F%B9%E8%AE%AD%E5%AE%9E%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<h1 id="培训报告"><a href="#培训报告" class="headerlink" title="培训报告"></a>培训报告</h1><p><strong>[学院组织]</strong></p><p><strong>[7.13-7.16]</strong></p><h2 id="培训目的"><a href="#培训目的" class="headerlink" title="培训目的"></a>培训目的</h2><p>本次技术培训的目的是提升参与人员在特定技术领域的知识和技能，以应对公司在该领域面临的挑战和需求。通过培训，参与人员将能够掌握相关技术，并将其应用于日常工作中，从而提高工作效率和质量。</p><h2 id="07-13-基础环境搭建"><a href="#07-13-基础环境搭建" class="headerlink" title="07-13 基础环境搭建"></a>07-13 基础环境搭建</h2><h3 id="基础环境"><a href="#基础环境" class="headerlink" title="基础环境"></a>基础环境</h3><p><strong>搭建步骤</strong></p><ol><li><p>修改主机名，便于识别节点；</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash"> 修改主机名</span></span><br><span class="line">hostnamectl set-hostname &lt;hostname&gt;</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">刷新</span></span><br><span class="line">bash</span><br></pre></td></tr></table></figure></li><li><p>修改hosts文件，添加集群节点映射，按照给出的节点IP和对应的主机名进行设置；</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">修改hosts文件内容</span></span><br><span class="line">vim /etc/hosts</span><br></pre></td></tr></table></figure><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 【局域网ip】 【主机名】</span><br><span class="line">[ip] [hostname]</span><br></pre></td></tr></table></figure></li><li><p>要求各节点时区修改为中国时区（ 中国标准时间CST+8）</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">修改为中国时区</span></span><br><span class="line">timedatectl set-timezone Asia/Shanghai</span><br></pre></td></tr></table></figure></li><li><p>安装ntp服务，要求主节点master为本地时钟源，从节点设置定时任务同步本地时间；</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">修改master节点NTP配置</span></span><br><span class="line">vim /etc/ntp.conf</span><br></pre></td></tr></table></figure><p>设置master为本地时间服务器，屏蔽默认server，服务器层级设为10</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># server &lt;默认服务器&gt;</span><br><span class="line">server 127.127.1.0</span><br><span class="line">fudge 127.127.1.0 stratum 10</span><br></pre></td></tr></table></figure><p>启动ntp服务</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">systemctl start ntp</span><br><span class="line">systemctl restart ntpd.service</span><br></pre></td></tr></table></figure><p>添加定时任务–在早十-晚五时间段内每隔半个小时同步一次本地服务器时间（24小时制、使用用户root任务调度crontab，服务器地址使用主机名）</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo crontab -e</span><br></pre></td></tr></table></figure><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">*/30 10-17 * * * /usr/sbin/ntpdate -u &lt;主机名&gt;</span><br></pre></td></tr></table></figure></li><li><p>集群中数据传输需要节点之间免密访问，要求设置主节点之间到从节点的免密访问；<br>主节点生成公钥文件id_rsa.pub(数字签名RSA，用户root，主机名master)</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen</span><br></pre></td></tr></table></figure><p>建⽴master⾃身使⽤root⽤户ssh访问localhost免密登录<br>若没有authorized_keys则使用下面命令创建</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /root/.ssh/id_rsa.pub &gt;&gt; /root/.ssh/authorized_keys</span><br></pre></td></tr></table></figure><p>建⽴master使⽤root⽤户到slave的ssh免密登录访问</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-copy-id root@&lt;从节点IP或主机名&gt;</span><br></pre></td></tr></table></figure><p>测试</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-copy-id root@&lt;从节点IP或主机名&gt;</span><br></pre></td></tr></table></figure></li><li><p>配置Java环境<br>解压下载的java JDK</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf [jdk]</span><br></pre></td></tr></table></figure><p>添加系统环境变量</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/profile</span><br></pre></td></tr></table></figure><p>添加内容</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">export JAVA_HOME=&lt;you_java_jdk_path&gt;</span><br><span class="line">export PATH=&quot;$JAVA_HOME/bin:$PATH&quot;</span><br></pre></td></tr></table></figure><p>配置生效</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source /etc/profile</span><br></pre></td></tr></table></figure></li><li><p>分发</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">scp -r /etc/profile root@slave:/etc/</span><br><span class="line">scp -r /usr/java root@slave:/usr/</span><br></pre></td></tr></table></figure></li></ol><h3 id="Zookeeper"><a href="#Zookeeper" class="headerlink" title="Zookeeper"></a>Zookeeper</h3><p><strong>概念</strong></p><p>ZooKeeper是一个开源的分布式协调服务，它为分布式应用程序提供了高度可靠的协调功能。它旨在解决分布式系统中的一些常见问题，如配置管理、命名服务、分布式锁、分布式协调等。</p><p>ZooKeeper的设计目标是提供一个简单而高效的分布式协调服务，它采用了基于观察者模式的数据模型。在ZooKeeper中，数据被组织为一个分层的命名空间（类似于文件系统的目录结构），称为ZooKeeper树（ZooKeeper<br>tree）或ZooKeeper命名空间（ZooKeeper namespace）。每个节点在树中都有一个唯一的路径标识，并可以存储一个小的数据块。</p><p>ZooKeeper提供了临时节点、顺序节点、观察者机制等特性，可以用于实现分布式锁、选主（Leader<br>Election）、集群管理、分布式队列等场景。它的核心是一个高可用的、基于主从架构的协调服务器集群，通过选举机制确保了服务的高可用性和可靠性。</p><p>在分布式系统中，ZooKeeper被广泛应用于各种场景，如大数据、分布式数据库、消息队列、分布式应用程序等。它为分布式应用程序提供了一个可靠的、高性能的基础设施，帮助开发人员简化了分布式系统的设计和实现。</p><p>Zookeeper是一个分布式服务框架，是Apache Hadoop 的一个子项目，它主要是用来解决分布式应用中经常遇到的一些数据管理问题，如：统一命名服务、状态同步服务、集群管理、分布式应用配置项的管理等。<br>预装的配置文件zoo_sample.cfg下面默认有五个属性，分别是：</p><ol><li><p>tickTime<br>心跳间隔，单位是毫秒，系统默认是2000毫秒，也就是间隔两秒心跳一次。<br>tickTime的意义：客户端与服务器或者服务器与服务器之间维持心跳，也就是每个tickTime时间就会发送一次心跳。通过心跳不仅能够用来监听机器的工作状态，还可以通过心跳来控制Flower跟Leader的通信时间，默认情况下FL的会话时常是心跳间隔的两倍。</p></li><li><p>initLimit<br>集群中的follower服务器(F)与leader服务器(L)之间初始连接时能容忍的最多心跳数（tickTime的数量）。</p></li><li><p>syncLimit<br>集群中flower服务器（F）跟leader（L）服务器之间的请求和答应最多能容忍的心跳数。</p></li><li><p>clientPort<br>客户端连接的接口，客户端连接zookeeper服务器的端口，zookeeper会监听这个端口，接收客户端的请求访问，端口默认是2181。</p></li><li><p>dataDir<br>该属性对应的目录是用来存放myid信息跟一些版本，日志，跟服务器唯一的ID信息等。<br>在集群Zookeeper服务在启动的时候，会回去读取zoo.cfg这个文件，从这个文件中找到这个属性然后获取它的值也就是dataDir<br>的路径，它会从这个路径下面读取myid这个文件，从这个文件中获取要启动的当前服务器的地址。</p></li></ol><p>集群信息的配置：<br>在配置文件中，配置集群信息是存在一定的格式：service.N &#x3D;YYY： A：B<br>N：代表服务器编号（准确对应对应服务器中myid里面的值）<br>YYY：服务器地址<br>A：表示 Flower 跟 Leader的通信端口，简称服务端内部通信的端口（默认2888）<br>B：表示是选举端口（默认是3888）</p><p>参考配置文件</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">tickTime=2000</span><br><span class="line">initLimit=10</span><br><span class="line">syncLimit=5</span><br><span class="line">clientPort=2181</span><br><span class="line"># 配置数据存储路径</span><br><span class="line">????</span><br><span class="line"># 配置日志文件路径</span><br><span class="line">????</span><br><span class="line"># 配置集群列表</span><br><span class="line">server.1=????</span><br><span class="line">server.2=????</span><br><span class="line">server.3=????</span><br></pre></td></tr></table></figure><p><strong>搭建步骤</strong></p><ol><li><p>将zookeeper安装包解压</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf [zookeeper]</span><br></pre></td></tr></table></figure></li><li><p>配置系统变量ZOOKEEPER_HOME，同时将Zookeeper安装路径中bin目录加入PATH系统变量</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/profile</span><br></pre></td></tr></table></figure><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># zookeeper</span><br><span class="line">export ZOOKEEPER_HOME=/usr/zookeeper/zookeeper-3.4.14</span><br><span class="line">export PATH=&quot;$ZOOKEEPER_HOME/bin:$PATH&quot;</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source /etc/profile</span><br></pre></td></tr></table></figure></li><li><p>Zookeeper的默认配置文件为Zookeeper安装路径下conf&#x2F;zoo_sample.cfg，将其修改为zoo.cfg</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd zookeeper/zookeeper-3.4.14/conf/</span><br><span class="line">mv zoo_sample.cfg zoo.cfg</span><br></pre></td></tr></table></figure></li><li><p>设置数据存储路径(dataDir)为&#x2F;usr&#x2F;zookeeper&#x2F;zookeeper-3.4.14&#x2F;zkdata</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim zoo.cfg</span><br></pre></td></tr></table></figure><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dataDir=/usr/zookeeper/zookeeper-3.4.14/zkdata</span><br></pre></td></tr></table></figure></li><li><p>设置日志文件路径(dataLogDir)为&#x2F;usr&#x2F;zookeeper&#x2F;zookeeper-3.4.14&#x2F;zkdatalog</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim zoo.cfg</span><br></pre></td></tr></table></figure><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dataLogDir=/usr/zookeeper/zookeeper-3.4.14/zkdatalog</span><br></pre></td></tr></table></figure></li><li><p>设置集群列表（要求master为1号服务器，slave1为2号服务器，slave2为3号服务器）</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim zoo.cfg</span><br></pre></td></tr></table></figure><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">server.1=master:2888:3888</span><br><span class="line">server.2=slave1:2888:3888</span><br><span class="line">server.3=slave2:2888:3888</span><br></pre></td></tr></table></figure></li><li><p>创建所需数据存储文件夹、日志存储文件夹</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p /usr/zookeeper/zookeeper-3.4.14/&#123;zkdata,zkdatalog&#125;</span><br></pre></td></tr></table></figure></li><li><p>数据存储路径下创建myid，写入对应的标识主机服务器序号</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /usr/zookeeper/zookeeper-3.4.14/zkdata</span><br><span class="line">vim myid</span><br></pre></td></tr></table></figure><p>server.1 中的 1 就是主机服务器的序号</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1</span><br></pre></td></tr></table></figure></li><li><p>分发</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">scp -r /usr/zookeeper/ root@slave:/usr</span><br><span class="line">scp /etc/profile root@slave:/etc</span><br></pre></td></tr></table></figure></li><li><p>启动服务，查看进程QuorumPeerMain是否存在</p>   <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">zkServer.sh start</span><br></pre></td></tr></table></figure></li><li><p>查看各节点服务器角色是否正常(leader&#x2F;follower)</p>   <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">zkServer.sh status</span><br></pre></td></tr></table></figure></li></ol><h3 id="Hadoop"><a href="#Hadoop" class="headerlink" title="Hadoop"></a>Hadoop</h3><p><strong>概述</strong></p><p>Hadoop是一个开源的分布式计算框架，旨在处理大规模数据集的存储和处理。它提供了可靠性、可扩展性和容错性，适用于在集群中并行处理大量数据的场景。</p><p>Hadoop的核心组件包括：</p><ol><li><p>Hadoop Distributed File System (HDFS)：这是一个分布式文件系统，用于存储大规模数据集。它将数据分散存储在集群中的多个节点上，并提供高容错性和高可靠性，以支持大规模数据的存储和处理。</p></li><li><p>MapReduce：这是一个分布式数据处理模型，用于在Hadoop集群上并行处理大规模数据。MapReduce将计算任务分解为可并行执行的“映射”（Map）和“归约”（Reduce）阶段，允许在分布式环境中处理海量数据。</p></li></ol><p>除了核心组件之外，Hadoop生态系统还包括许多其他工具和组件，如：</p><ul><li>YARN (Yet Another Resource Negotiator)：作为Hadoop的资源管理器，负责集群资源的管理和任务调度。</li><li>Hive：一个基于Hadoop的数据仓库和查询工具，提供类似于SQL的查询语言，用于分析和处理存储在Hadoop上的数据。</li><li>Spark：一个快速、通用的大数据处理引擎，提供高级别的API，支持内存计算和更复杂的数据处理模式。</li><li>HBase：一个分布式、可扩展的列式数据库，用于存储和访问结构化数据。</li><li>Pig：一种高级数据流脚本语言，用于编写复杂的数据转换和分析任务。</li><li>ZooKeeper：一个分布式协调服务，用于管理和协调分布式系统中的各种任务。</li></ul><p>Hadoop被广泛应用于大数据领域，它可以处理海量数据并提供可靠的数据存储和分析能力。它的设计理念和架构使得它适用于构建可扩展的分布式系统，以满足日益增长的大数据需求。</p><p>Hadoop是由Java语言编写的，在分布式服务器集群上存储海量数据并运行分布式分析应用的开源框架，其核心部件是HDFS与MapReduce。</p><ol><li>HDFS是一个分布式文件系统：引入存放文件元数据信息的服务器Namenode和实际存放数据的服务器Datanode，对数据进行分布式储存和读取。</li><li>MapReduce是一个计算框架：MapReduce的核心思想是把计算任务分配给集群内的服务器里执行。通过对计算任务的拆分（Map计算&#x2F;Reduce计算）再根据任务调度器（JobTracker）对任务进行分布式计算。</li></ol><table><thead><tr><th>配置文件</th><th>配置对象</th><th>主要内容</th></tr></thead><tbody><tr><td>hadoop-env.sh</td><td>hadoop运行环境</td><td>用来定义Hadoop运行环境相关的配置信息；</td></tr><tr><td>core-site.xml</td><td>集群全局参数</td><td>定义系统级别的参数，包括HDFS URL、Hadoop临时目录等；</td></tr><tr><td>hdfs-site.xml</td><td>HDFS参数</td><td>定义名称节点、数据节点的存放位置、文本副本的个数、文件读取权限等；</td></tr><tr><td>mapred-site.xml</td><td>MapReduce参数</td><td>包括JobHistory Server 和应用程序参数两部分，如reduce任务的默认个数、任务所能够使用内存的默认上下限等；</td></tr><tr><td>yarn-site.xml</td><td>集群资源管理系统参数</td><td>配置ResourceManager ，nodeManager的通信端口，web监控端口等；</td></tr></tbody></table><p>Hadoop的配置类是由资源指定的，资源可以由一个String或Path来指定,资源以XML形式的数据表示，由一系列的键值对组成。资源可以用String或path命名（示例如下），</p><ol><li>String:指示hadoop在classpath中查找该资源；</li><li>Path:指示hadoop在本地文件系统中查找该资源。</li></ol><p><strong>配置示例</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>fs.default.name<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>????<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure><ol><li><p>core-site.xml</p><table><thead><tr><th>配置参数</th><th>说明</th></tr></thead><tbody><tr><td>fs.default.name</td><td>用于指定NameNode的地址</td></tr><tr><td>hadoop.tmp.dir</td><td>Hadoop运行时产生文件的临时存储目录</td></tr></tbody></table></li><li><p>hdfs-site.xml</p><table><thead><tr><th>配置参数</th><th>说明</th></tr></thead><tbody><tr><td>dfs.replication</td><td>指定备份数</td></tr><tr><td>dfs.namenode.name.dir</td><td>NameNode在本地文件系统中持久存储命名空间和事务日志的路径</td></tr><tr><td>dfs.datanode.data.dir</td><td>DataNode在本地文件系统中存放块的路径</td></tr><tr><td>dfs.permissions</td><td>集群权限系统校验</td></tr><tr><td>dfs.datanode.use.datanode.hostname</td><td>datanode之间通过域名方式通信</td></tr></tbody></table><blockquote><p>注意：外域机器通信需要用外网IP，未配置hostname访问会访问异常。可以在Java api客户端使用conf.set(“<br>fs.client.use.datanode.hostname”,”true”);。</p></blockquote></li><li><p>mapreduce-site.xml</p><table><thead><tr><th>配置参数</th><th>说明</th></tr></thead><tbody><tr><td>mapreduce.framework.name</td><td>指定执行MapReduce作业的运行时框架。属性值可以是local，classic或yarn</td></tr></tbody></table></li><li><p>yarn-site.xml</p><table><thead><tr><th>配置参数</th><th>说明</th></tr></thead><tbody><tr><td>yarn.resourcemanager.admin.address</td><td>用于指定RM管理界面的地址（主机:端口）</td></tr><tr><td>yarn.nodemanager.aux-services</td><td>mapreduce 获取数据的方式，指定在进行mapreduce作业时，yarn使用mapreduce_shuffle混洗技术。这个混洗技术是hadoop的一个核心技术，非常重要。</td></tr><tr><td>yarn.nodemanager.auxservices.mapreduce.shuffle.class</td><td>用于指定混洗技术对应的字节码文件，值为org.apache.hadoop.mapred.ShuffleHandler</td></tr></tbody></table></li></ol><p><strong>配置步骤</strong></p><ol><li><p>Hadoop安装包解压</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf [hadoop]</span><br></pre></td></tr></table></figure></li><li><p>配置环境变量HADOOP_HOME，将Hadoop安装路径中bin目录和sbin目录加入PATH系统变量</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/profile</span><br></pre></td></tr></table></figure><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># hadoop</span><br><span class="line">export HADOOP_HOME=/usr/hadoop/hadoop-2.7.7</span><br><span class="line">export PATH=&quot;$HADOOP_HOME/sbin:$HADOOP_HOME/bin:$PATH&quot;</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source /etc/profile</span><br></pre></td></tr></table></figure></li><li><p>配置Hadoop运行环境JAVA_HOME</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /usr/hadoop/hadoop-2.7.7/etc/hadoop</span><br><span class="line">vim hadoop-env.sh</span><br></pre></td></tr></table></figure><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">export JAVA_HOME=/usr/java/jdk1.8.0_221</span><br></pre></td></tr></table></figure></li><li><p>设置全局参数，指定HDFS上NameNode地址为master,端口默认为9000；指定临时存储目录为本地&#x2F;root&#x2F;hadoopData&#x2F;tmp(要求为绝对路径，下同)</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim core-site.xml</span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>fs.default.name<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>hdfs://master:9000<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>hadoop.tmp.dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>/root/hadoopData/tmp<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>设置HDFS参数，指定备份文本数量为2；设置HDFS参数，指定NN存放元数据信息路径为本地&#x2F;root&#x2F;hadoopData&#x2F;name；指定DN存放元数据信息路径为本地&#x2F;root&#x2F;hadoopData&#x2F;data(要求为绝对路径)；设置HDFS参数，关闭hadoop集群权限校验（安全配置），允许其他用户连接集群；指定datanode之间通过域名方式进行通信</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim hdfs-site.xml</span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.replication<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>2<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.namenode.name.dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>/root/hadoopData/name<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.datanode.data.dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>/root/hadoopData/data<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.permissions<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>false<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.datanode.use.datanode.hostname<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>设置YARN运行环境$JAVA_HOME参数</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim yarn-env.sh</span><br></pre></td></tr></table></figure><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">export JAVA_HOME=/usr/java/jdk1.8.0_221</span><br></pre></td></tr></table></figure></li><li><p>设置YARN核心参数，指定ResourceManager进程所在主机为master，端口为18141;指定mapreduce 获取数据的方式为mapreduce_shuffle</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim yarn-site.xml</span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.admin.address<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>master:18141<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.nodemanager.aux-services<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>mapreduce_shuffle<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.nodemanager.auxservices.mapreduce.shuffle.class<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>org.apache.hadoop.mapred.shuffleHandler<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>设置计算框架参数，指定MR运行在yarn上</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cp mapred-site.xml.template mapred-site.xml</span><br><span class="line">vim mapred-site.xml</span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.framework.name<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>yarn<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>设置节点文件，要求master为主节点； slave1、slave2为子节点<br>这里填入从节点</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim slaves</span><br></pre></td></tr></table></figure><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">slave</span><br></pre></td></tr></table></figure><p>这里填入主节点</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim master</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">master</span><br></pre></td></tr></table></figure></li><li><p>分发</p>   <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">scp -r /usr/hadoop/ root@slave:/usr/</span><br><span class="line">scp /etc/profile root@slave:/etc/</span><br></pre></td></tr></table></figure></li><li><p>对文件系统进行格式化</p>   <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hdfs namenode -format</span><br></pre></td></tr></table></figure><p>   出现一下内容就是成功了</p>   <figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">INFO common.Storage: Storage directory /root/hadoopData/name has been successfully formatted.</span><br></pre></td></tr></table></figure></li><li><p>启动Hadoop集群查看各节点服务</p>   <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">start-all.sh </span><br><span class="line">hadoop-daemon.sh start datanode</span><br><span class="line">jps</span><br></pre></td></tr></table></figure></li><li><p>查看集群运行状态是否正常</p>   <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hadoop dfsadmin -report</span><br></pre></td></tr></table></figure></li></ol><h3 id="Hive"><a href="#Hive" class="headerlink" title="Hive"></a>Hive</h3><p><strong>概念</strong></p><p>Hive是基于Hadoop的数据仓库基础架构，它提供了一种类似于SQL的查询语言（HiveQL）和用于处理大规模数据集的数据处理能力。Hive使得用户可以使用SQL语言进行数据查询、转换和分析，而无需编写复杂的MapReduce程序。</p><p>Hive的核心思想是将结构化查询语言（SQL）映射到Hadoop分布式文件系统（HDFS）上的大规模数据集。它将SQL查询转换为一系列MapReduce作业，从而能够在Hadoop集群上并行处理数据。</p><p>Hive的特性包括：</p><ol><li><p>数据模型：Hive提供了类似于关系型数据库的表结构，支持基于模式的数据存储和查询。它可以将数据映射到表和分区，并支持复杂的数据类型和数据模型。</p></li><li><p>查询语言：Hive的查询语言HiveQL类似于SQL，允许用户使用SQL语句来查询和分析数据。HiveQL支持常见的查询操作，如SELECT、JOIN、GROUP<br>BY、ORDER BY等。</p></li><li><p>数据转换和ETL：Hive支持数据转换和ETL（抽取、转换、加载）操作，可以通过HiveQL进行数据清洗、转换和提取。</p></li><li><p>扩展性和集成：Hive可以与其他Hadoop生态系统组件集成，如HDFS、HBase、Spark等。它还支持自定义函数（UDF）和扩展插件，允许用户编写自定义逻辑和扩展功能。</p></li><li><p>元数据管理：Hive维护表和分区的元数据信息，包括表的结构、存储位置、分区信息等。这使得Hive能够提供更高级别的查询优化和查询计划生成。</p></li></ol><p>Hive广泛应用于大数据领域，特别是数据仓库、数据分析和数据处理场景。它提供了一种简化的方式来使用SQL语言进行大数据查询和处理，使得更多的人可以轻松地利用Hadoop集群进行数据分析和数据挖掘。</p><ol><li><p>环境中已经安装mysql-community-server，注意mysql5.7默认安装后为root用户随机生成一个密码；<br>直接查看密码：grep “temporary password” &#x2F;var&#x2F;log&#x2F;mysqld.log<br>登入数据库：mysql -uroot -p<br>输入随机密码即可登录</p></li><li><p>根据要求设置密码，注意对应的安全策略修改；<br>设置密码强度为低级：set global validate_password_policy&#x3D;????;<br>设置密码长度：set global validate_password_length&#x3D;????;<br>修改本地密码：alter user ‘root‘@’localhost’ identified by ‘????’;</p></li><li><p>根据要求满足任意主机节点root的远程访问权限(否则后续hive无法连接mysql)；</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GRANT</span> <span class="keyword">ALL</span> PRIVILEGES <span class="keyword">ON</span> <span class="operator">*</span>.<span class="operator">*</span> <span class="keyword">TO</span> <span class="string">&#x27;????&#x27;</span>@<span class="string">&#x27;%&#x27;</span> IDENTIFIED <span class="keyword">BY</span> <span class="string">&#x27;????&#x27;</span> <span class="keyword">WITH</span> <span class="keyword">GRANT</span> OPTION;</span><br></pre></td></tr></table></figure></li><li><p>注意刷新权限；</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flush privileges;</span><br></pre></td></tr></table></figure></li><li><p>参考命令</p><ol><li>启动mysql服务：systemctl start mysqld.service</li><li>关闭mysql服务：systemctl stop mysqld.service</li><li>查看mysql服务：systemctl status mysqld.service</li></ol></li></ol><p><strong>配置步骤</strong></p><ol><li><p>环境中已经安装mysql-community-server，关闭mysql开机自启服务</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl disable mysqld</span><br></pre></td></tr></table></figure></li><li><p>开启MySQL服务</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl start mysqld</span><br></pre></td></tr></table></figure></li><li><p>判断mysqld.log日志下是否生成初临时密码</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">grep &quot;temporary password&quot; /var/log/mysqld.log </span><br></pre></td></tr></table></figure><p>观察初始密码并复制下来</p></li><li><p>设置mysql数据库本地root用户密码为123456<br>登录mysql，使用临时密码</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql -uroot -p</span><br></pre></td></tr></table></figure><p>sql中执行</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span> <span class="keyword">global</span> validate_password_policy<span class="operator">=</span><span class="number">0</span>;</span><br><span class="line"><span class="keyword">set</span> <span class="keyword">global</span> validate_password_length<span class="operator">=</span><span class="number">4</span>;</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">user</span> root<span class="variable">@localhost</span> identified <span class="keyword">by</span> ‘<span class="number">123456</span>’;</span><br></pre></td></tr></table></figure><p>退出</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">quit</span><br></pre></td></tr></table></figure></li><li><p>Hive安装包解压</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf [hive]</span><br></pre></td></tr></table></figure></li><li><p>配置环境变量HIVE_HOME,将Hive安装路径中的bin目录加入PATH系统变量</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/profile</span><br></pre></td></tr></table></figure><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">export HIVE_HOME=/usr/hive/apache-hive-2.3.4-bin</span><br><span class="line">export PATH=PATH : PATH:PATH:HIVE_HOME/bin</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source /etc/profile</span><br></pre></td></tr></table></figure></li><li><p>修改HIVE运行环境，配置Hadoop安装路径HADOOP_HOME；修改HIVE运行环境，配置Hive配置文件存放路径HIVE_CONF_DIR；修改HIVE运行环境，配置Hive运行资源库路径HIVE_AUX_JARS_PATH</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd /usr/hive/apache-hive-2.3.4-bin/conf/</span><br><span class="line">cp hive-env.sh.template hive-env.sh</span><br><span class="line">vim hive-env.sh</span><br></pre></td></tr></table></figure><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">export HADOOP_HOME=/usr/hadoop/hadoop-2.7.7</span><br><span class="line">export HIVE_CONF_DIR=/usr/hive/apache-hive-2.3.4-bin/conf</span><br><span class="line">export HIVE_AUX_JARS_PATH=/usr/hive/apache-hive-2.3.4-bin/lib</span><br></pre></td></tr></table></figure></li><li><p>解决jline的版本冲突，将$HIVE_HOME&#x2F;lib&#x2F;jline-2.12.jar同步至$HADOOP_HOME&#x2F;share&#x2F;hadoop&#x2F;yarn&#x2F;lib&#x2F;下</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cp /usr/package277/mysql-connector-java-5.1.47-bin.jar /usr/hive/apache-hive-2.3.4-bin/lib/</span><br></pre></td></tr></table></figure></li><li><p>分发</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">scp -r /usr/hive root@slave:/usr</span><br><span class="line">scp /etc/profile root@slave:/etc</span><br></pre></td></tr></table></figure><div class="note info"><p>接下来的操作请选择刚才进行分发的slave从节点进行操作</p></div></li><li><p>驱动JDBC拷贝至hive安装目录对应lib下（依赖包存放于&#x2F;usr&#x2F;package277&#x2F;）</p>   <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cp /usr/package277/mysql-connector-java-5.1.47-bin.jar /usr/hive/apache-hive-2.3.4-bin/lib/</span><br></pre></td></tr></table></figure></li><li><p>配置元数据数据存储位置为&#x2F;user&#x2F;hive_remote&#x2F;warehouse；配置连接JDBC的URL地址主机名及默认端口号3306，数据库为hive，如不存在自行创建，ssl连接方式为false；配置数据库连接用户；配置数据库连接密码</p>   <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /usr/hive/apache-hive-2.3.4-bin/conf/hive-site.xml</span><br></pre></td></tr></table></figure>   <figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">   <span class="comment">&lt;!-- Hive产生的元数据存放位置--&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">name</span>&gt;</span>hive.metastore.warehouse.dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">value</span>&gt;</span>/user/hive_remote/warehouse<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">   <span class="comment">&lt;!-- 数据库连接driver，即MySQL驱动--&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">name</span>&gt;</span>javax.jdo.option.ConnectionDriverName<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">value</span>&gt;</span>root<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">   <span class="comment">&lt;!-- 数据库连接JDBC的URL地址--&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">name</span>&gt;</span>javax.jdo.option.ConnectionURL<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">value</span>&gt;</span>jdbc:mysql://slave2:3306/hive?createDatabaseIfNotExist=true<span class="symbol">&amp;amp;</span>useSSL=false<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">   <span class="comment">&lt;!-- MySQL数据库用户名--&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">name</span>&gt;</span>javax.jdo.option.ConnectionUserName<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">value</span>&gt;</span>com.mysql.jdbc.Driver<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">   <span class="comment">&lt;!-- MySQL数据库密码--&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">name</span>&gt;</span>javax.jdo.option.ConnectionPassword<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">value</span>&gt;</span>123456<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>   <div class="note info"><p>接下来的操作请选择master节点进行操作</p></div></li><li><p>配置元数据存储位置为&#x2F;user&#x2F;hive_remote&#x2F;warehouse；关闭本地metastore模式；配置指向metastore服务的主机为slave1，端口为9083</p>   <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /usr/hive/apache-hive-2.3.4-bin/conf/hive-site.xml</span><br></pre></td></tr></table></figure>   <figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">   <span class="comment">&lt;!-- Hive产生的元数据存放位置--&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">name</span>&gt;</span>hive.metastore.warehouse.dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">value</span>&gt;</span>/user/hive_remote/warehouse<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">   <span class="comment">&lt;!--- 使用本地服务连接Hive,默认为true--&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">name</span>&gt;</span>hive.metastore.local<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">value</span>&gt;</span>false<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">   <span class="comment">&lt;!-- 连接服务器--&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">name</span>&gt;</span>hive.metastore.uris<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">value</span>&gt;</span>thrift://slave1:9083<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>服务器端初始化数据库，并启动metastore服务;</p>   <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">schematool -dbType mysql -initSchema</span><br><span class="line">hive --service metastore</span><br></pre></td></tr></table></figure></li><li><p>客户端开启进入hive，创建hive数据库</p>   <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hive</span><br></pre></td></tr></table></figure>   <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">create database hive;</span><br></pre></td></tr></table></figure></li></ol><h3 id="Spark"><a href="#Spark" class="headerlink" title="Spark"></a>Spark</h3><p>Hive是基于Hadoop的数据仓库基础架构，它提供了一种类似于SQL的查询语言（HiveQL）和用于处理大规模数据集的数据处理能力。Hive使得用户可以使用SQL语言进行数据查询、转换和分析，而无需编写复杂的MapReduce程序。</p><p>Hive的核心思想是将结构化查询语言（SQL）映射到Hadoop分布式文件系统（HDFS）上的大规模数据集。它将SQL查询转换为一系列MapReduce作业，从而能够在Hadoop集群上并行处理数据。</p><p>Hive的特性包括：</p><ol><li><p>数据模型：Hive提供了类似于关系型数据库的表结构，支持基于模式的数据存储和查询。它可以将数据映射到表和分区，并支持复杂的数据类型和数据模型。</p></li><li><p>查询语言：Hive的查询语言HiveQL类似于SQL，允许用户使用SQL语句来查询和分析数据。HiveQL支持常见的查询操作，如SELECT、JOIN、GROUP<br>BY、ORDER BY等。</p></li><li><p>数据转换和ETL：Hive支持数据转换和ETL（抽取、转换、加载）操作，可以通过HiveQL进行数据清洗、转换和提取。</p></li><li><p>扩展性和集成：Hive可以与其他Hadoop生态系统组件集成，如HDFS、HBase、Spark等。它还支持自定义函数（UDF）和扩展插件，允许用户编写自定义逻辑和扩展功能。</p></li><li><p>元数据管理：Hive维护表和分区的元数据信息，包括表的结构、存储位置、分区信息等。这使得Hive能够提供更高级别的查询优化和查询计划生成。</p></li></ol><p>Hive广泛应用于大数据领域，特别是数据仓库、数据分析和数据处理场景。它提供了一种简化的方式来使用SQL语言进行大数据查询和处理，使得更多的人可以轻松地利用Hadoop集群进行数据分析和数据挖掘。</p><p>Spark是Hadoop的子项目。 环境中将Spark安装到基于Linux的系统中。</p><p>相关配置变量如下：</p><ol><li>JAVA_HOME：Java安装目录</li><li>HADOOP_HOME：Hadoop安装目录</li><li>HADOOP_CONF_DIR：Hadoop集群的配置文件的目录</li><li>SPARK_MASTER_IP：Spark集群的Master节点的ip地址</li><li>SPARK_WORKER_MEMORY：每个worker节点能够最大分配给exectors的内存大小</li></ol><p><strong>配置步骤</strong></p><ol><li><p>将Spark安装包解压</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -zvxf [spark]</span><br></pre></td></tr></table></figure></li><li><p>文件&#x2F;etc&#x2F;profile中配置环境变量SPARK_HOME，将Spark安装路径中的bin目录加入PATH系统变量</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/profile</span><br></pre></td></tr></table></figure><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">export SPARK_HOME=/usr/spark/spark-2.4.3-bin-hadoop2.7</span><br><span class="line">export PATH=$SPARK_HOME/bin:$SPARK_HOME/sbin:$PATH</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source /etc/profile</span><br></pre></td></tr></table></figure></li><li><p>修改配置文件spark-env.sh，设置主机节点为master，设置java安装路径，设置节点内存为8g，设置hadoop安装目录、hadoop集群的配置文件的目录，添加spark从节点</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cd /usr/spark/spark-2.4.3-bin-hadoop2.7/conf</span><br><span class="line">cp spark-defaults.sh.template spark-env.sh</span><br><span class="line"></span><br><span class="line">vim spark-env.sh</span><br></pre></td></tr></table></figure><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">export JAVA_HOME=/usr/java/jdk1.8.0_221</span><br><span class="line">export SPARK_MASTER_IP=master</span><br><span class="line">export HADOOP_CONF_DIR=/usr/hadoop/hadoop-2.7.7/etc/hadoop</span><br><span class="line">export HADOOP_HOME=/usr/hadoop/hadoop-2.7.7</span><br><span class="line">export SPARK_WORKER_MEMORY=8g</span><br></pre></td></tr></table></figure><p>添加从节点</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cp slaves.template slaves</span><br><span class="line">vim slaves</span><br></pre></td></tr></table></figure><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">slave</span><br></pre></td></tr></table></figure></li><li><p>分发</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">scp -r /usr/spark root@slave:/usr</span><br><span class="line">scp /etc/profile root@slave:/etc</span><br></pre></td></tr></table></figure></li><li><p>开启集群，查看各节点进程(主节点进程为Master，子节点进程为Worker)</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /usr/spark/spark-2.4.3-bin-hadoop2.7/sbin</span><br><span class="line">./start-all.sh</span><br></pre></td></tr></table></figure></li></ol><h2 id="07-14-Hadoop-MapReduce"><a href="#07-14-Hadoop-MapReduce" class="headerlink" title="07-14 Hadoop MapReduce"></a>07-14 Hadoop MapReduce</h2><p><strong>概念</strong><br>Hadoop MapReduce是Hadoop生态系统中的一个计算模型和编程框架，用于处理大规模数据集的分布式计算任务。</p><p>MapReduce模型旨在解决大规模数据处理的并行化和分布式计算问题。它将计算任务分解为两个主要阶段：Map阶段和Reduce阶段。</p><p>在Map阶段，数据被分割成小的数据块，并由多个Map任务并行处理。每个Map任务将输入数据块转换为一系列键值对，其中键表示中间结果的标识，值表示相关数据。</p><p>在Reduce阶段，通过对Map阶段输出的中间结果进行整理和归并，将具有相同键的值聚合在一起。这样，Reduce任务可以对每个键的值进行处理，生成最终的计算结果。</p><p>Hadoop<br>MapReduce提供了一个编程模型和框架，使开发人员能够编写并行计算任务，并将其自动分布到Hadoop集群中的多个节点上执行。开发人员可以使用Java等编程语言编写MapReduce作业，利用Hadoop框架提供的API来处理输入数据、定义Map和Reduce函数，并设置作业的配置参数。</p><p>通过利用Hadoop MapReduce的分布式计算能力，可以有效地处理大规模数据集，实现数据处理、数据挖掘、日志分析等各种应用场景。</p><h3 id="WordCount程序"><a href="#WordCount程序" class="headerlink" title="WordCount程序"></a>WordCount程序</h3><p><strong>数据说明</strong></p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">Shakespeare Sonnet</span><br><span class="line">Shall I compare thee to a summer&#x27;s day?</span><br><span class="line">Thou art more lovely and more temperate:</span><br><span class="line">Rough winds do shake the darling buds of May,</span><br><span class="line">And summer&#x27;s lease hath all too short a date:</span><br><span class="line">Sometime too hot the eye of heaven shines,</span><br><span class="line">And often is his gold complexion dimm&#x27;d;</span><br><span class="line">And every fair from fair sometime declines,</span><br><span class="line">By chance or nature&#x27;s changing course untrimm&#x27;d</span><br><span class="line">But thy eternal summer shall not fade</span><br><span class="line">Nor lose possession of that fair thou owest;</span><br><span class="line">Nor shall Death brag thou wander&#x27;st in his shade,</span><br><span class="line">When in eternal lines to time thou growest:</span><br><span class="line">So long as men can breathe or eyes can see,</span><br><span class="line">So long lives this and this gives life to thee.</span><br></pre></td></tr></table></figure><p><strong>程序实现</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.hadoop.conf.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.fs.Path;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.io.IntWritable;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.io.Text;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapreduce.Job;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapreduce.lib.input.FileInputFormat;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapreduce.lib.output.FileOutputFormat;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WordCountDriver</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException, InterruptedException, ClassNotFoundException &#123;</span><br><span class="line">        <span class="comment">//1、获取Job</span></span><br><span class="line">        <span class="type">Configuration</span> <span class="variable">conf</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Configuration</span>();</span><br><span class="line">        <span class="type">Job</span> <span class="variable">job</span> <span class="operator">=</span> Job.getInstance(conf);</span><br><span class="line">        <span class="comment">//设置jar包路径</span></span><br><span class="line">        job.setJarByClass(WordCountDriver.class);</span><br><span class="line">        <span class="comment">//3、关联map和reducer</span></span><br><span class="line">        job.setMapperClass(WordCountMapper.class);</span><br><span class="line">        job.setReducerClass(WordCountReducer.class);</span><br><span class="line">        <span class="comment">//4、设置map的输出kv类型</span></span><br><span class="line">        job.setMapOutputKeyClass(Text.class);</span><br><span class="line">        job.setMapOutputValueClass(IntWritable.class);</span><br><span class="line">        <span class="comment">//5、设置最终输出的kv类型</span></span><br><span class="line">        job.setOutputKeyClass(Text.class);</span><br><span class="line">        job.setOutputValueClass(IntWritable.class);</span><br><span class="line">        <span class="comment">//6、设置输入输出路径</span></span><br><span class="line">        FileInputFormat.setInputPaths(job, <span class="keyword">new</span> <span class="title class_">Path</span>(args[<span class="number">0</span>]));</span><br><span class="line">        FileOutputFormat.setOutputPath(job, <span class="keyword">new</span> <span class="title class_">Path</span>(args[<span class="number">1</span>]));</span><br><span class="line">        <span class="comment">//7、提交job</span></span><br><span class="line">        <span class="type">boolean</span> <span class="variable">result</span> <span class="operator">=</span> job.waitForCompletion(<span class="literal">true</span>);</span><br><span class="line">        System.exit(result ? <span class="number">0</span> : <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.hadoop.io.IntWritable;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.io.LongWritable;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.io.Text;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapreduce.Mapper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WordCountMapper</span> <span class="keyword">extends</span> <span class="title class_">Mapper</span>&lt;LongWritable, Text, Text, IntWritable&gt; &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">Text</span> <span class="variable">k</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Text</span>();</span><br><span class="line">    <span class="keyword">private</span> <span class="type">IntWritable</span> <span class="variable">v</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">IntWritable</span>(<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">map</span><span class="params">(LongWritable key, Text value, Mapper&lt;LongWritable, Text, Text, IntWritable&gt;.Context context)</span> <span class="keyword">throws</span> IOException, InterruptedException &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">line</span> <span class="operator">=</span> value.toString();</span><br><span class="line">        String[] words = line.split(<span class="string">&quot; &quot;</span>);</span><br><span class="line">        <span class="keyword">for</span> (String word : words) &#123;</span><br><span class="line">            k.set(word);</span><br><span class="line">            context.write(k, v);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.hadoop.io.IntWritable;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.io.Text;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapreduce.Reducer;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WordCountReducer</span> <span class="keyword">extends</span> <span class="title class_">Reducer</span>&lt;Text, IntWritable, Text, IntWritable&gt; &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">IntWritable</span> <span class="variable">v</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">IntWritable</span>();</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">reduce</span><span class="params">(Text key, Iterable&lt;IntWritable&gt; values, Reducer&lt;Text, IntWritable, Text, IntWritable&gt;.Context context)</span> <span class="keyword">throws</span> IOException, InterruptedException &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">sum</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (IntWritable value : values) &#123;</span><br><span class="line">            sum += value.get();</span><br><span class="line">        &#125;</span><br><span class="line">        v.set(sum);</span><br><span class="line">        context.write(key, v);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="07-15-Hive数据分析"><a href="#07-15-Hive数据分析" class="headerlink" title="07-15 Hive数据分析"></a>07-15 Hive数据分析</h2><p><strong>概述</strong></p><p>Hive是基于Hadoop的数据仓库基础设施，它提供了一种类SQL的查询语言（HiveQL）来进行数据分析。Hive使得使用类似于传统关系型数据库的查询语言进行大规模数据处理和分析变得更加容易。</p><p>以下是使用Hive进行数据分析的一般步骤：</p><ol><li><p>创建数据表：首先，你需要在Hive中创建适合你数据的表。使用Hive的数据定义语言（DDL），你可以定义表的结构、字段和数据类型。你可以选择将数据加载到表中，或者使用外部表引用现有的数据。</p></li><li><p>导入数据：如果你的数据尚未在Hive中可用，你可以使用Hive的数据导入功能将数据加载到表中。Hive支持从各种数据源导入数据，如文本文件、CSV文件、Parquet文件、HBase等。</p></li><li><p>执行查询：使用HiveQL编写查询语句来执行数据分析操作。HiveQL类似于传统的SQL语言，你可以使用SELECT语句、WHERE子句、GROUP BY子句、JOIN操作等来进行数据查询、过滤、聚合等操作。</p></li><li><p>存储结果：根据需要，你可以将查询结果存储到新的表中，以供后续分析使用。Hive支持将查询结果存储为新表或以其他格式导出到文件系统中。</p></li><li><p>优化查询性能：为了提高查询性能，你可以使用Hive的优化技术，如分区、分桶、索引等。这些技术可以减少数据扫描量和提高查询效率。</p></li><li><p>定期维护和管理：作为数据仓库，你需要定期维护和管理Hive环境。这包括数据清理、分区维护、表结构变更等。</p></li></ol><p>请注意，Hive适用于批处理和离线分析场景，对于实时查询和低延迟要求较高的场景，可能需要考虑其他技术或框架。</p><p>使用Hive进行数据分析需要一定的学习和了解，特别是HiveQL查询语言和Hive的表现行为。根据你的具体需求和数据情况，你可能需要深入学习和使用Hive的高级功能和技术。</p><h3 id="案例：房屋数据分析"><a href="#案例：房屋数据分析" class="headerlink" title="案例：房屋数据分析"></a>案例：房屋数据分析</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre></td><td class="code"><pre><span class="line"># 标题                                           ,户型               ,区县,商圈,小区        ,房租,地铁,亮点1,亮点2,亮点3</span><br><span class="line"># 绿地 精装套二 随时看房 实图拍摄 临千盛 欧尚 优博 穿巷子,整租|2室2厅|84㎡|朝南,武侯,簇桥,绿地圣路易名邸,2400,,家电齐全,,</span><br><span class="line"># 警官公寓 合租 次卧103平米2室1厅1卫限女生,合租次卧|2户合租|103㎡,高新区,中和镇,警官公寓,860,,交通便利,合租女生,</span><br><span class="line"># 高新区大源嘉祥瑞庭南城 35平米1室1厅1卫,整租|1室1厅|35㎡|朝南北,高新区,大源,嘉祥瑞庭南城,2300,,采光好,,</span><br><span class="line"># 国光一环大厦1室1厅1卫,整租|1室1厅|60㎡|朝南,成华,建设路伊藤,国光一环大厦,1300,红星桥站,随时入住,,</span><br><span class="line"># 双流蛟龙港世纪华都高层 93平米3室1厅1卫,整租|3室1厅|93㎡|朝南北,双流,蛟龙港,世纪华都高层,1400,,家电齐全,,</span><br><span class="line"># 浣花苑1室1厅1卫,整租|1室1厅|64㎡|朝南,青羊,杜甫草堂,浣花苑,600,草堂北路站,随时入住,,</span><br><span class="line"># 华宇阳光水岸 合租 次卧80平米2室1厅1卫性别不限,合租次卧|2户合租|80㎡|朝南,成华,驷马桥,华宇阳光水岸,700,昭觉寺南路站,性别不限,随时入住,</span><br><span class="line"># 润扬川大河畔一期1室1厅1卫,整租|1室1厅|60㎡|朝南,双流,航空港,润扬川大河畔一期,1300,,交通便利,随时入住,</span><br><span class="line"># 东立光华杏林 整租 1室1厅1卫 50平米(个人),整租|1室1厅|50㎡|朝南,青羊,万家湾,东立光华杏林,1600,中坝站,精装修,,</span><br><span class="line"></span><br><span class="line"># 在hive数据库下构建数据表house</span><br><span class="line">create table if not exists house</span><br><span class="line">(</span><br><span class="line">    title string comment &#x27;标题&#x27;,</span><br><span class="line">    layout string comment &#x27;户型&#x27;,</span><br><span class="line">    district string comment &#x27;区县&#x27;,</span><br><span class="line">    area string comment &#x27;商圈&#x27;,</span><br><span class="line">    estate string comment &#x27;楼盘&#x27;,</span><br><span class="line">    rent int comment &#x27;房租&#x27;,</span><br><span class="line">    station string comment &#x27;地铁&#x27;,</span><br><span class="line">    merit1 string comment &#x27;亮点1&#x27;,</span><br><span class="line">    merit2 string comment &#x27;亮点2&#x27;,</span><br><span class="line">    merit3 string comment &#x27;亮点3&#x27;</span><br><span class="line">) row format delimited</span><br><span class="line">fields terminated by &#x27;,&#x27;</span><br><span class="line">tblproperties(&#x27;skip.header.line.count&#x27;=&#x27;1&#x27;);</span><br><span class="line"></span><br><span class="line"># 导入数据house.csv</span><br><span class="line">load data local inpath &#x27;/root/house/house.csv&#x27;overwrite into table house;</span><br><span class="line"></span><br><span class="line"># 计算房屋出租量前十的楼盘排名，结果写入本地/college2020/01/000000_0 （二维数组：楼盘 数量,不计入空值）</span><br><span class="line">insert overwrite local directory &#x27;/college2020/01&#x27;</span><br><span class="line">row format delimited fields terminated by &#x27;\t&#x27;</span><br><span class="line">select estate, count(*) as row_count</span><br><span class="line">from house</span><br><span class="line">where estate is not null</span><br><span class="line">group by estate</span><br><span class="line">order by row_count desc, estate</span><br><span class="line">limit 10;</span><br><span class="line"></span><br><span class="line"># 计算房屋出租量前十的商圈排名，结果写入本地/college2020/02/000000_0 （二维数组：商圈 数量,不计入空值）</span><br><span class="line">insert overwrite local directory &#x27;/college2020/02&#x27;</span><br><span class="line">row format delimited fields terminated by &#x27;\t&#x27;</span><br><span class="line">select area, count(*) as area_count</span><br><span class="line">from house</span><br><span class="line">where area is not null</span><br><span class="line">group by area</span><br><span class="line">order by area_count desc, area</span><br><span class="line">limit 10;</span><br><span class="line"></span><br><span class="line"># 整理双流区整租三室一厅不同楼盘价格，结果写入本地/college2020/03/000000_0 (二维数组：楼盘 价格，为均价降序)</span><br><span class="line">insert overwrite local directory &#x27;/college2020/03&#x27;</span><br><span class="line">row format delimited fields terminated by &#x27;\t&#x27;</span><br><span class="line">select estate, avg(rent) as avg_rent</span><br><span class="line">from house</span><br><span class="line">where district like &#x27;%双流%&#x27;</span><br><span class="line">  and split(layout, &#x27;\\|&#x27;)[0] = &#x27;整租&#x27;</span><br><span class="line">  and split(layout, &#x27;\\|&#x27;)[1] = &#x27;3室1厅&#x27;</span><br><span class="line">group by estate</span><br><span class="line">order by avg_rent desc;</span><br><span class="line"></span><br><span class="line"># 现想在中坝站万家湾附近进行合租，试给出户型及房租信息进行参考，结果写入本地/college2020/04/000000_0 (二维数组：户型 价格降序)</span><br><span class="line">insert overwrite local directory &#x27;/college2020/04&#x27;</span><br><span class="line">row format delimited fields terminated by &#x27;\t&#x27;</span><br><span class="line">select layout, rent</span><br><span class="line">from house</span><br><span class="line">where station = &#x27;中坝站&#x27;</span><br><span class="line">  and area = &#x27;万家湾&#x27;</span><br><span class="line">  and split(layout, &#x27;\\|&#x27;)[0] like &#x27;%合租%&#x27;</span><br><span class="line">order by rent desc;</span><br><span class="line"></span><br><span class="line"># 现想在保利星座进行租房，预算为1000-1500，试给出参考户型信息，结果写入本地/college2020/05/000000_0 (二维数组：户型 价格降序)</span><br><span class="line">insert overwrite local directory &#x27;/college2020/05&#x27;</span><br><span class="line">row format delimited fields terminated by &#x27;\t&#x27;</span><br><span class="line">select layout, rent</span><br><span class="line">from house</span><br><span class="line">where estate like &#x27;%保利星座%&#x27;</span><br><span class="line">  and rent between 1000 and 1500</span><br><span class="line">order by rent desc;</span><br><span class="line"></span><br><span class="line"># 试列出不同商圈整租1室1厅的价格TOP3，结果写入本地/college2020/06/000000_0 (二维数组：商圈 价格，均值降序)</span><br><span class="line">insert overwrite local directory &#x27;/college2020/06&#x27;</span><br><span class="line">row format delimited fields terminated by &#x27;\t&#x27;</span><br><span class="line">select area, avg(rent) as avg_rent</span><br><span class="line">from house</span><br><span class="line">where split(layout, &#x27;\\|&#x27;)[0] = &#x27;整租&#x27;</span><br><span class="line">  and split(layout, &#x27;\\|&#x27;)[1] = &#x27;1室1厅&#x27;</span><br><span class="line">group by area</span><br><span class="line">order by avg_rent desc</span><br><span class="line">limit 3;</span><br><span class="line"></span><br><span class="line"># 试列出高新区不同户型的整租价格清单，结果写入本地/college2020/07/000000_0 (二维数组示例：3室2厅 4000，均值向下取整降序)</span><br><span class="line">insert overwrite local directory &#x27;/college2020/07&#x27;</span><br><span class="line">row format delimited fields terminated by &#x27;\t&#x27;</span><br><span class="line">select split(layout, &#x27;\\|&#x27;)[1], floor(avg(rent)) as avg_rent</span><br><span class="line">from house</span><br><span class="line">where district like &#x27;%高新区%&#x27;</span><br><span class="line">  and split(layout, &#x27;\\|&#x27;)[0] like &#x27;%整租%&#x27;</span><br><span class="line">group by split(layout, &#x27;\\|&#x27;)[1]</span><br><span class="line">order by avg_rent desc;</span><br><span class="line"></span><br><span class="line"># 合并房屋出租亮点(特点),给出常用亮点TOP5,结果写入本地/college2020/08/000000_0 (二维数组:亮点 数量，不计入空值，降序)</span><br><span class="line">insert overwrite local directory &#x27;/college2020/08&#x27;</span><br><span class="line">row format delimited fields terminated by &#x27;\t&#x27;</span><br><span class="line">select merit, count(*) as merit_count</span><br><span class="line">from (select merit1 as merit</span><br><span class="line">      from house</span><br><span class="line">      union all</span><br><span class="line">      select merit2 as merit</span><br><span class="line">      from house</span><br><span class="line">      union all</span><br><span class="line">      select merit3 as merit</span><br><span class="line">      from house) t</span><br><span class="line">group by merit</span><br><span class="line">order by merit_count desc</span><br><span class="line">limit 5;</span><br></pre></td></tr></table></figure><h2 id="07-16-Spark数据分析"><a href="#07-16-Spark数据分析" class="headerlink" title="07-16 Spark数据分析"></a>07-16 Spark数据分析</h2><h3 id="案例：WordCount"><a href="#案例：WordCount" class="headerlink" title="案例：WordCount"></a>案例：WordCount</h3><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.log4j.&#123;<span class="type">Level</span>, <span class="type">Logger</span>&#125;</span><br><span class="line"><span class="keyword">import</span> org.apache.spark.&#123;<span class="type">SparkConf</span>, <span class="type">SparkContext</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">WordCount</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line">    <span class="type">Logger</span></span><br><span class="line">      .getLogger(<span class="string">&quot;org.apache.spark&quot;</span>)</span><br><span class="line">      .setLevel(<span class="type">Level</span>.<span class="type">ERROR</span>)</span><br><span class="line">    <span class="comment">// 新建SparkConf对象</span></span><br><span class="line">    <span class="keyword">val</span> conf = <span class="keyword">new</span> <span class="type">SparkConf</span>()</span><br><span class="line">      .setAppName(<span class="string">&quot;WordCount&quot;</span>)</span><br><span class="line">      .setMaster(<span class="string">&quot;local[*]&quot;</span>)</span><br><span class="line">    <span class="comment">// 创建SparkContext对象</span></span><br><span class="line">    <span class="keyword">val</span> sparkContext = <span class="keyword">new</span> <span class="type">SparkContext</span>(config = conf)</span><br><span class="line">    <span class="comment">// 定义打开的文件</span></span><br><span class="line">    <span class="keyword">val</span> fileRDD = sparkContext.textFile(<span class="string">&quot;/Volumes/KeQing/Documents/IntelliJ IDEA Ultimate/SparkTraning/src/main/resources/words.txt&quot;</span>)</span><br><span class="line">    <span class="comment">// 按行分割单词</span></span><br><span class="line">    <span class="keyword">var</span> wordCountResultRDD = fileRDD.mapPartitions(it =&gt; &#123;</span><br><span class="line">      it.flatMap(_.split(<span class="string">&quot; &quot;</span>).map((_, <span class="number">1</span>)))</span><br><span class="line">    &#125;)</span><br><span class="line">      <span class="comment">// (word1,3) (word2, 2) (word3, 5)</span></span><br><span class="line">      .reduceByKey(_ + _).sortBy(_._2, ascending = <span class="literal">false</span>)</span><br><span class="line">    <span class="comment">// output</span></span><br><span class="line">    wordCountResultRDD.collect().foreach(println)</span><br><span class="line">    wordCountResultRDD.saveAsTextFile(<span class="string">&quot;/Volumes/KeQing/Documents/IntelliJ IDEA Ultimate/SparkTraning/src/main/resources/output/WordCountResult&quot;</span>)</span><br><span class="line">    <span class="comment">// 关闭</span></span><br><span class="line">    sparkContext.stop()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="案例：搜索引擎日志分析"><a href="#案例：搜索引擎日志分析" class="headerlink" title="案例：搜索引擎日志分析"></a>案例：搜索引擎日志分析</h3><ol><li><p>封装数据</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">queryTime  访问时间，格式为：HH:mm:ss</span></span><br><span class="line"><span class="comment">userId     用户ID</span></span><br><span class="line"><span class="comment">queryWords 查询词</span></span><br><span class="line"><span class="comment">resultRank 该URL在返回结果中的排名</span></span><br><span class="line"><span class="comment">clickRank  用户点击的顺序号</span></span><br><span class="line"><span class="comment">clickUrl   用户点击的URL</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">case</span> <span class="class"><span class="keyword">class</span> <span class="title">SogouRecord</span>(<span class="params"></span></span></span><br><span class="line"><span class="params"><span class="class">                        queryTime:<span class="type">String</span>,</span></span></span><br><span class="line"><span class="params"><span class="class">                        userId:<span class="type">String</span>,</span></span></span><br><span class="line"><span class="params"><span class="class">                        queryWords:<span class="type">String</span>,</span></span></span><br><span class="line"><span class="params"><span class="class">                        resultRank:<span class="type">Int</span>,</span></span></span><br><span class="line"><span class="params"><span class="class">                        clickRank:<span class="type">Int</span>,</span></span></span><br><span class="line"><span class="params"><span class="class">                        clickUrl:<span class="type">String</span></span></span></span><br><span class="line"><span class="params"><span class="class">                      </span>)</span></span><br></pre></td></tr></table></figure></li><li><p>使用case class反射，适用于简单分析</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.hankcs.hanlp.<span class="type">HanLP</span></span><br><span class="line"><span class="keyword">import</span> com.hankcs.hanlp.seg.common.<span class="type">Term</span></span><br><span class="line"><span class="keyword">import</span> org.apache.log4j.&#123;<span class="type">Level</span>, <span class="type">Logger</span>&#125;</span><br><span class="line"><span class="keyword">import</span> org.apache.spark.storage.<span class="type">StorageLevel</span></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.&#123;<span class="type">SparkConf</span>, <span class="type">SparkContext</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">SearchEngineLogAnalysis</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line">    <span class="type">Logger</span></span><br><span class="line">      .getLogger(<span class="string">&quot;org.apache.spark&quot;</span>)</span><br><span class="line">      .setLevel(<span class="type">Level</span>.<span class="type">ERROR</span>)</span><br><span class="line">    <span class="comment">// 新建SparkConf对象</span></span><br><span class="line">    <span class="keyword">val</span> conf = <span class="keyword">new</span> <span class="type">SparkConf</span>()</span><br><span class="line">      .setAppName(<span class="string">&quot;SearchEngineLogAnalysis&quot;</span>)</span><br><span class="line">      .setMaster(<span class="string">&quot;local[*]&quot;</span>)</span><br><span class="line">    <span class="comment">// 创建SparkContext对象</span></span><br><span class="line">    <span class="keyword">val</span> sparkContext = <span class="keyword">new</span> <span class="type">SparkContext</span>(config = conf)</span><br><span class="line">    <span class="keyword">val</span> file = <span class="string">&quot;/Volumes/KeQing/Documents/IntelliJ IDEA Ultimate/SparkTraning/src/main/resources/reduced.txt&quot;</span></span><br><span class="line">    <span class="keyword">val</span> outputPath1 = <span class="string">&quot;/Volumes/KeQing/Documents/IntelliJ IDEA Ultimate/SparkTraning/src/main/resources/output/queryWordsWordCountRDD&quot;</span></span><br><span class="line">    <span class="keyword">val</span> outputPath2 = <span class="string">&quot;/Volumes/KeQing/Documents/IntelliJ IDEA Ultimate/SparkTraning/src/main/resources/output/userQueryAnalysisRDD&quot;</span></span><br><span class="line">    <span class="keyword">val</span> outputPath3 = <span class="string">&quot;/Volumes/KeQing/Documents/IntelliJ IDEA Ultimate/SparkTraning/src/main/resources/output/timeQueryCountAnalysisRDD&quot;</span></span><br><span class="line">    <span class="keyword">val</span> rddSougouRecord = sparkContext.textFile(file)</span><br><span class="line">      <span class="comment">// 过滤空行数据、过滤字段数量不等于6</span></span><br><span class="line">      .filter(line =&gt; line != <span class="literal">null</span> &amp;&amp; line.trim.split(<span class="string">&quot;\\s+&quot;</span>).length == <span class="number">6</span>)</span><br><span class="line">      <span class="comment">// 将RDD[String]=&gt;RDD[SogouRecord]</span></span><br><span class="line">      .mapPartitions(it =&gt; &#123;</span><br><span class="line">        it.map(line =&gt; &#123;</span><br><span class="line">          <span class="keyword">val</span> contents = line.trim.split(<span class="string">&quot;\\s+&quot;</span>)</span><br><span class="line">          <span class="comment">// 注意字段格式</span></span><br><span class="line">          <span class="type">SogouRecord</span>(</span><br><span class="line">            contents(<span class="number">0</span>),</span><br><span class="line">            contents(<span class="number">1</span>),</span><br><span class="line">            <span class="comment">// [360安全卫士]</span></span><br><span class="line">            contents(<span class="number">2</span>).replaceAll(<span class="string">&quot;[\\[|\\]]&quot;</span>, <span class="string">&quot;&quot;</span>),</span><br><span class="line">            contents(<span class="number">3</span>).toInt,</span><br><span class="line">            contents(<span class="number">4</span>).toInt,</span><br><span class="line">            contents(<span class="number">5</span>)</span><br><span class="line">          )</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;)</span><br><span class="line">    rddSougouRecord.persist(<span class="type">StorageLevel</span>.<span class="type">MEMORY_AND_DISK</span>).count()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">val</span> queryWordsWordCountRDD = rddSougouRecord.mapPartitions(it =&gt; &#123;</span><br><span class="line">      it.flatMap(record =&gt; &#123;</span><br><span class="line">        <span class="keyword">val</span> terms: util.<span class="type">List</span>[<span class="type">Term</span>] = <span class="type">HanLP</span>.segment(record.queryWords.trim)</span><br><span class="line">        <span class="keyword">import</span> scala.collection.<span class="type">JavaConverters</span>._</span><br><span class="line">        terms.asScala.map(_.word)</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;).map((_, <span class="number">1</span>)).reduceByKey(_ + _).sortBy(_._2, ascending = <span class="literal">false</span>)</span><br><span class="line"></span><br><span class="line">    queryWordsWordCountRDD.coalesce(numPartitions = <span class="number">1</span>).saveAsTextFile(outputPath1)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">val</span> userQueryAnalysisRDD = rddSougouRecord.mapPartitions(it =&gt; &#123;</span><br><span class="line">      it.map(record =&gt; &#123;</span><br><span class="line">        ((record.userId, record.queryWords), <span class="number">1</span>)</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;).reduceByKey(_ + _).sortBy(_._2, ascending = <span class="literal">false</span>)</span><br><span class="line">    userQueryAnalysisRDD.coalesce(<span class="number">1</span>).saveAsTextFile(outputPath2)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">val</span> timeQueryCountAnalysisRDD = rddSougouRecord.mapPartitions(it =&gt; &#123;</span><br><span class="line">      it.map(record =&gt; &#123;</span><br><span class="line">        (record.queryTime.substring(<span class="number">0</span>, <span class="number">2</span>), <span class="number">1</span>)</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;).reduceByKey(_ + _).sortBy(_._2, ascending = <span class="literal">false</span>)</span><br><span class="line">    timeQueryCountAnalysisRDD.coalesce(<span class="number">1</span>).saveAsTextFile(outputPath3)</span><br><span class="line"></span><br><span class="line">    rddSougouRecord.unpersist()</span><br><span class="line">    sparkContext.stop()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>使用StructType编程，适用于复杂分析</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.log4j.&#123;<span class="type">Level</span>, <span class="type">Logger</span>&#125;</span><br><span class="line"><span class="keyword">import</span> org.apache.spark.sql.&#123;<span class="type">Row</span>, <span class="type">SparkSession</span>&#125;</span><br><span class="line"><span class="keyword">import</span> org.apache.spark.sql.types.&#123;<span class="type">IntegerType</span>, <span class="type">StringType</span>, <span class="type">StructField</span>, <span class="type">StructType</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">SogouAnalysisSQL</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line">    <span class="comment">// 设置输出的日志级别</span></span><br><span class="line">    <span class="type">Logger</span>.getLogger(<span class="string">&quot;org.apache.spark&quot;</span>).setLevel(<span class="type">Level</span>.<span class="type">ERROR</span>)</span><br><span class="line">    <span class="keyword">val</span> spark = <span class="type">SparkSession</span>.builder()</span><br><span class="line">      .appName(<span class="string">&quot;SogouAnalysisSQL&quot;</span>)</span><br><span class="line">      .master(<span class="string">&quot;local[*]&quot;</span>)</span><br><span class="line">      .getOrCreate()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">val</span> file = <span class="string">&quot;/Volumes/KeQing/Documents/IntelliJ IDEA Ultimate/SparkTraning/src/main/resources/reduced.txt&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">val</span> fileRDD = spark.sparkContext.textFile(file)</span><br><span class="line">      .filter(line =&gt; line != <span class="literal">null</span> &amp;&amp; line.trim.split(<span class="string">&quot;\\s+&quot;</span>).length == <span class="number">6</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">val</span> schema = <span class="type">StructType</span>(<span class="type">Array</span>(</span><br><span class="line">      <span class="type">StructField</span>(<span class="string">&quot;queryTime&quot;</span>, <span class="type">StringType</span>, <span class="literal">false</span>),</span><br><span class="line">      <span class="type">StructField</span>(<span class="string">&quot;userId&quot;</span>, <span class="type">StringType</span>, <span class="literal">false</span>),</span><br><span class="line">      <span class="type">StructField</span>(<span class="string">&quot;queryWords&quot;</span>, <span class="type">StringType</span>, <span class="literal">false</span>),</span><br><span class="line">      <span class="type">StructField</span>(<span class="string">&quot;resultRank&quot;</span>, <span class="type">IntegerType</span>, <span class="literal">false</span>),</span><br><span class="line">      <span class="type">StructField</span>(<span class="string">&quot;clickRank&quot;</span>, <span class="type">IntegerType</span>, <span class="literal">false</span>),</span><br><span class="line">      <span class="type">StructField</span>(<span class="string">&quot;clickUrl&quot;</span>, <span class="type">StringType</span>, <span class="literal">false</span>)</span><br><span class="line">    ))</span><br><span class="line"></span><br><span class="line">    <span class="comment">// RDD[String] =&gt; RDD[Row]</span></span><br><span class="line">    <span class="keyword">val</span> rddRow = fileRDD.mapPartitions(it =&gt; &#123;</span><br><span class="line">      it.map(line =&gt; &#123;</span><br><span class="line">        <span class="keyword">val</span> contents = line.trim.split(<span class="string">&quot;\\s+&quot;</span>)</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">          <span class="comment">// 封装的字段的时候，顺序要与定义的schema顺序完全一致</span></span><br><span class="line">          <span class="type">Row</span>(</span><br><span class="line">            contents(<span class="number">0</span>),</span><br><span class="line">            contents(<span class="number">1</span>),</span><br><span class="line">            contents(<span class="number">2</span>).replaceAll(<span class="string">&quot;[\\[|\\]]&quot;</span>, <span class="string">&quot;&quot;</span>),</span><br><span class="line">            contents(<span class="number">3</span>).toInt,</span><br><span class="line">            contents(<span class="number">4</span>).toInt,</span><br><span class="line">            contents(<span class="number">5</span>)</span><br><span class="line">          )</span><br><span class="line">        &#125; <span class="keyword">catch</span> &#123;</span><br><span class="line">          <span class="keyword">case</span> e: <span class="type">Exception</span> =&gt; <span class="type">Row</span>(<span class="string">&quot;error&quot;</span>, <span class="string">&quot;error&quot;</span>, <span class="string">&quot;error&quot;</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="string">&quot;error&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// RDD[Row] ==&gt; DataFrame</span></span><br><span class="line">    <span class="keyword">val</span> df = spark.createDataFrame(rddRow, schema)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 将DataFrame注册为临时视图</span></span><br><span class="line">    df.createOrReplaceTempView(<span class="string">&quot;sogou_view&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 定义查询的sql</span></span><br><span class="line">    <span class="keyword">val</span> sql =</span><br><span class="line">      <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        |select * from sogou_view where clickUrl like &#x27;www%&#x27;</span></span><br><span class="line"><span class="string">        |limit 3</span></span><br><span class="line"><span class="string">        |&quot;&quot;&quot;</span>.stripMargin</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 执行sql</span></span><br><span class="line">    <span class="keyword">val</span> sqlResult = spark.sql(sql)</span><br><span class="line">    <span class="comment">//    sqlResult.show(truncate = false)</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">val</span> querySQL =</span><br><span class="line">      <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        |select userId,queryWords,count(*) as query_count from sogou_view</span></span><br><span class="line"><span class="string">        |group by userId,queryWords</span></span><br><span class="line"><span class="string">        |order by userid,query_count desc</span></span><br><span class="line"><span class="string">        |&quot;&quot;&quot;</span>.stripMargin</span><br><span class="line"></span><br><span class="line">    <span class="keyword">val</span> queryResult = spark.sql(querySQL)</span><br><span class="line"></span><br><span class="line">    <span class="comment">//    queryResult.show(truncate = false)</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">val</span> timeSQL =</span><br><span class="line">      <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        |select substring(queryTime,0,5) as query_time,count(*) as query_count from sogou_view</span></span><br><span class="line"><span class="string">        |group by substring(queryTime,0,5)</span></span><br><span class="line"><span class="string">        |order by query_time,query_count desc</span></span><br><span class="line"><span class="string">        |&quot;&quot;&quot;</span>.stripMargin</span><br><span class="line"></span><br><span class="line">    <span class="keyword">val</span> timeResult = spark.sql(timeSQL)</span><br><span class="line">    timeResult.show(truncate = <span class="literal">false</span>)</span><br><span class="line">    timeResult.rdd.coalesce(<span class="number">1</span>).saveAsTextFile(<span class="string">&quot;/Volumes/KeQing/Documents/IntelliJ IDEA Ultimate/SparkTraning/src/main/resources/output/timeResult&quot;</span>)</span><br><span class="line">    spark.stop()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>示例数据</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">00:00:002982199073774412[360安全卫士]8 3download.it.com.cn/softweb/software/firewall/antivirus/20067/17938.html</span><br><span class="line">00:00:0007594220010824798[哄抢救灾物资]1 1news.21cn.com/social/daqian/2008/05/29/4777194_1.shtml</span><br><span class="line">00:00:005228056822071097[75810部队]14 5www.greatoo.com/greatoo_cn/list.asp?link_id=276&amp;title=%BE%DE%C2%D6%D0%C2%CE%C5</span><br><span class="line">00:00:006140463203615646[绳艺]62 36www.jd-cd.com/jd_opus/xx/200607/706.html</span><br><span class="line">00:00:008561366108033201[汶川地震原因]3 2www.big38.net/</span><br><span class="line">00:00:0023908140386148713[莫衷一是的意思]1 2www.chinabaike.com/article/81/82/110/2007/2007020724490.html</span><br><span class="line">00:00:001797943298449139[星梦缘全集在线观看]8 5www.6wei.net/dianshiju/????\xa1\xe9|????do=index</span><br></pre></td></tr></table></figure></li></ol><h3 id="案例：手机基站日志分析"><a href="#案例：手机基站日志分析" class="headerlink" title="案例：手机基站日志分析"></a>案例：手机基站日志分析</h3><ol><li><p>示例数据<br><strong>基站信息数据（基站ID 经度 纬度 信号辐射类型）</strong></p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">9F36407EAD0629FC166F14DDE7970F68,116.304864,40.050645,6</span><br><span class="line">CC0710CC94ECC657A8561DE549D940E0,116.303955,40.041935,6</span><br><span class="line">16030401EAFB68F1E3CDF819735E1C66,116.296302,40.032296,6</span><br></pre></td></tr></table></figure><p><strong>用户信息数据（手机号 时间(时间戳) 基站ID 连接状态（“1”为连接，“0”为断开））</strong></p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">13554756349,20211202082000,16030401EAFB68F1E3CDF819735E1C66,1</span><br><span class="line">13236723613,20211202082500,16030401EAFB68F1E3CDF819735E1C66,1</span><br><span class="line">13554756349,20211202180000,16030401EAFB68F1E3CDF819735E1C66,0</span><br><span class="line">13236723613,20211202180000,16030401EAFB68F1E3CDF819735E1C66,0</span><br><span class="line">13236723613,20211202075000,9F36407EAD0629FC166F14DDE7970F68,1</span><br><span class="line">13554756349,20211202075100,9F36407EAD0629FC166F14DDE7970F68,1</span><br><span class="line">13236723613,20211202081000,9F36407EAD0629FC166F14DDE7970F68,0</span><br><span class="line">13554756349,20211202081300,9F36407EAD0629FC166F14DDE7970F68,0</span><br><span class="line">13554756349,20211202175000,9F36407EAD0629FC166F14DDE7970F68,1</span><br><span class="line">13236723613,20211202182000,9F36407EAD0629FC166F14DDE7970F68,1</span><br><span class="line">13554756349,20211202220000,9F36407EAD0629FC166F14DDE7970F68,0</span><br><span class="line">13236723613,20211202230000,9F36407EAD0629FC166F14DDE7970F68,0</span><br><span class="line">13236723613,20211202081100,CC0710CC94ECC657A8561DE549D940E0,1</span><br><span class="line">13554756349,20211202081200,CC0710CC94ECC657A8561DE549D940E0,1</span><br><span class="line">13554756349,20211202081900,CC0710CC94ECC657A8561DE549D940E0,0</span><br><span class="line">13236723613,20211202082000,CC0710CC94ECC657A8561DE549D940E0,0</span><br><span class="line">13554756349,20211202171000,CC0710CC94ECC657A8561DE549D940E0,1</span><br><span class="line">13554756349,20211202171600,CC0710CC94ECC657A8561DE549D940E0,0</span><br><span class="line">13236723613,20211202180500,CC0710CC94ECC657A8561DE549D940E0,1</span><br><span class="line">13236723613,20211202181500,CC0710CC94ECC657A8561DE549D940E0,0</span><br></pre></td></tr></table></figure></li><li><p>case Class</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">case</span> <span class="class"><span class="keyword">class</span> <span class="title">BaseStation</span>(<span class="params"></span></span></span><br><span class="line"><span class="params"><span class="class">                        baseStationId: <span class="type">String</span>,</span></span></span><br><span class="line"><span class="params"><span class="class">                        longitude: <span class="type">Double</span>,</span></span></span><br><span class="line"><span class="params"><span class="class">                        latitude: <span class="type">Double</span>,</span></span></span><br><span class="line"><span class="params"><span class="class">                        signalRadiationType: <span class="type">Int</span></span></span></span><br><span class="line"><span class="params"><span class="class">                      </span>)</span></span><br></pre></td></tr></table></figure><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">case</span> <span class="class"><span class="keyword">class</span> <span class="title">UserRecord</span>(<span class="params"></span></span></span><br><span class="line"><span class="params"><span class="class">                       phone: <span class="type">String</span>,</span></span></span><br><span class="line"><span class="params"><span class="class">                       time: <span class="type">Long</span>,</span></span></span><br><span class="line"><span class="params"><span class="class">                       baseStationId: <span class="type">String</span>,</span></span></span><br><span class="line"><span class="params"><span class="class">                       connectionStatus: <span class="type">Int</span></span></span></span><br><span class="line"><span class="params"><span class="class">                     </span>)</span></span><br></pre></td></tr></table></figure></li><li><p>main</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.log4j.&#123;<span class="type">Level</span>, <span class="type">Logger</span>&#125;</span><br><span class="line"><span class="keyword">import</span> org.apache.spark.rdd.<span class="type">RDD</span></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.storage.<span class="type">StorageLevel</span></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.&#123;<span class="type">SparkConf</span>, <span class="type">SparkContext</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">需求一：要求使用Sparkcore对分析数据进行分割处理获取业务需求所使用到的数据，根据不同用户在基站停留的时长数据统计出用户与停留地点的关系。</span></span><br><span class="line"><span class="comment">（1）根据用户信息中&quot;手机号,基站ID&quot;做为唯一标识，和时间戳构成新的元组--&gt;((手机号, 站点), 时间戳)</span></span><br><span class="line"><span class="comment">（2）以（手机号，基站ID）作为key，通过reduceByKey算子进行聚合，计算出在基站的停留时间，构成新的数据结构，以便和坐标数据进行join，生成元组--&gt;(基站ID,(手机号,停留时间))</span></span><br><span class="line"><span class="comment">（3）将基站坐标数据信息进行拆分，通过map，构建成包含基站ID、经纬度的元组 --&gt;(基站ID,(经度,纬度))</span></span><br><span class="line"><span class="comment">（4）将2、3结果根据基站ID进行join操作，构成新的数据类型--&gt;(手机号,基站ID,停留时间,(经度,纬度))</span></span><br><span class="line"><span class="comment">（5）按手机号进行分组--&gt;(手机号,(手机号,基站ID,停留时间,(经度,纬度)))</span></span><br><span class="line"><span class="comment">（6）对时间进行排序取出停留时间最长的基站ID（top1），则可能是居住地点和工作地点。</span></span><br><span class="line"><span class="comment">（7）格式结果：(手机号,List(手机号,停留时间,基站ID,(经度,纬度)))</span></span><br><span class="line"><span class="comment">（8）注意：按照手机号进行分组时，运算结果按照顺序为part-00000,part-00001...</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">MobileLocation</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line">    <span class="type">Logger</span></span><br><span class="line">      .getLogger(<span class="string">&quot;org.apache.spark&quot;</span>)</span><br><span class="line">      .setLevel(<span class="type">Level</span>.<span class="type">ERROR</span>)</span><br><span class="line">    <span class="keyword">val</span> sparkConf = <span class="keyword">new</span> <span class="type">SparkConf</span>().setAppName(<span class="string">&quot;MobileLocation&quot;</span>).setMaster(<span class="string">&quot;local[*]&quot;</span>)</span><br><span class="line">    <span class="keyword">val</span> sparkContext = <span class="keyword">new</span> <span class="type">SparkContext</span>(config = sparkConf)</span><br><span class="line">    <span class="keyword">val</span> infoFile = <span class="string">&quot;/Volumes/KeQing/Documents/IntelliJ IDEA Ultimate/SparkTraning/src/main/resources/mobilebasestationloganalysis/info.txt&quot;</span></span><br><span class="line">    <span class="keyword">val</span> userFile = <span class="string">&quot;/Volumes/KeQing/Documents/IntelliJ IDEA Ultimate/SparkTraning/src/main/resources/mobilebasestationloganalysis/user.txt&quot;</span></span><br><span class="line">    <span class="keyword">val</span> outputPath = <span class="string">&quot;/Volumes/KeQing/Documents/IntelliJ IDEA Ultimate/SparkTraning/src/main/resources/output/mobilebasestationloganalysis&quot;</span></span><br><span class="line">    <span class="keyword">val</span> rddUserRecord = sparkContext.textFile(userFile)</span><br><span class="line">      .filter(line =&gt; line != <span class="literal">null</span>)</span><br><span class="line">      .mapPartitions(it =&gt; &#123;</span><br><span class="line">        it.map(line =&gt; &#123;</span><br><span class="line">          <span class="keyword">val</span> contents = line.trim.split(<span class="string">&quot;,&quot;</span>)</span><br><span class="line">          <span class="comment">// 注意字段格式</span></span><br><span class="line">          <span class="type">UserRecord</span>(</span><br><span class="line">            contents(<span class="number">0</span>),</span><br><span class="line">            contents(<span class="number">1</span>).toLong,</span><br><span class="line">            contents(<span class="number">2</span>),</span><br><span class="line">            contents(<span class="number">3</span>).toInt</span><br><span class="line">          )</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;)</span><br><span class="line"></span><br><span class="line">    rddUserRecord.persist(<span class="type">StorageLevel</span>.<span class="type">MEMORY_AND_DISK</span>).count()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">val</span> basePhoneTime = rddUserRecord.mapPartitions(it =&gt; &#123;</span><br><span class="line">      it.map(record =&gt; &#123;</span><br><span class="line">        ((record.phone, record.baseStationId, record.connectionStatus), record.time)</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;).reduceByKey(_ + _).sortBy(_._2, ascending = <span class="literal">false</span>)</span><br><span class="line">      .mapPartitions(line =&gt; &#123;</span><br><span class="line">        line.map(</span><br><span class="line">          line =&gt; &#123;</span><br><span class="line">            ((line._1._1, line._1._2), line._2)</span><br><span class="line">          &#125;</span><br><span class="line">        )</span><br><span class="line">      &#125;).reduceByKey(_ - _)</span><br><span class="line">      .mapPartitions(it =&gt; &#123;</span><br><span class="line">        it.map(line =&gt; &#123;</span><br><span class="line">          (line._1._2, (line._1._1, line._2))</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;).sortBy(_._2._2, ascending = <span class="literal">false</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">val</span> rddInfoRecord = sparkContext.textFile(infoFile)</span><br><span class="line">      .filter(line =&gt; line != <span class="literal">null</span>)</span><br><span class="line">      .mapPartitions(it =&gt; &#123;</span><br><span class="line">        it.map(line =&gt; &#123;</span><br><span class="line">          <span class="keyword">val</span> contents = line.trim.split(<span class="string">&quot;,&quot;</span>)</span><br><span class="line">          <span class="type">BaseStation</span>(</span><br><span class="line">            contents(<span class="number">0</span>),</span><br><span class="line">            contents(<span class="number">1</span>).toDouble,</span><br><span class="line">            contents(<span class="number">2</span>).toDouble,</span><br><span class="line">            contents(<span class="number">3</span>).toInt</span><br><span class="line">          )</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">val</span> baseLongLat = rddInfoRecord.mapPartitions(it =&gt; &#123;</span><br><span class="line">      it.map(record =&gt; &#123;</span><br><span class="line">        (record.baseStationId, (record.longitude, record.latitude))</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="comment">// (手机号,基站ID,停留时间,(经度,纬度))</span></span><br><span class="line">    <span class="keyword">val</span> basePhoneTimeLongLat = basePhoneTime.join(baseLongLat).mapPartitions(it =&gt; &#123;</span><br><span class="line">      it.map(line =&gt; &#123;</span><br><span class="line">        (line._2._1._1, line._1, line._2._1._2, (line._2._2._1, line._2._2._2))</span><br><span class="line">      &#125;)</span><br><span class="line">        <span class="comment">// (手机号,(手机号,基站ID,停留时间,(经度,纬度))</span></span><br><span class="line">        .map(line =&gt; &#123;</span><br><span class="line">          (line._1, (line._2, line._3, line._4))</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;).groupByKey()</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 假设dataRDD是一个RDD，包含了键值对（手机号，数据记录迭代器）</span></span><br><span class="line">    <span class="comment">// (手机号,停留时间,基站ID,(经度,纬度)</span></span><br><span class="line">    <span class="keyword">val</span> dataRDD: <span class="type">RDD</span>[(<span class="type">String</span>, <span class="type">Iterable</span>[(<span class="type">String</span>, <span class="type">Long</span>, (<span class="type">Double</span>, <span class="type">Double</span>))])] = basePhoneTimeLongLat</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 转换成指定格式的RDD，并按照停留时间进行排序</span></span><br><span class="line">    <span class="keyword">val</span> resultRDD: <span class="type">RDD</span>[(<span class="type">String</span>, <span class="type">List</span>[(<span class="type">String</span>, <span class="type">Long</span>, <span class="type">String</span>, (<span class="type">Double</span>, <span class="type">Double</span>))])] = dataRDD.map &#123; <span class="keyword">case</span> (phoneNumber, records) =&gt;</span><br><span class="line">      <span class="keyword">val</span> resultData = records.map(record =&gt; (phoneNumber, record._2, record._1, (record._3._1, record._3._2))).toList</span><br><span class="line">      <span class="keyword">val</span> sortedResultData = resultData.sortBy(_._2)(<span class="type">Ordering</span>.<span class="type">Long</span>.reverse) <span class="comment">// 按照停留时间降序排序</span></span><br><span class="line">      (phoneNumber, sortedResultData)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 获取每个手机号的top1基站ID</span></span><br><span class="line">    <span class="keyword">val</span> top1BaseStationRDD: <span class="type">RDD</span>[(<span class="type">String</span>, <span class="type">String</span>)] = resultRDD.map &#123; <span class="keyword">case</span> (phoneNumber, sortedResultData) =&gt;</span><br><span class="line">      <span class="keyword">if</span> (sortedResultData.nonEmpty) &#123;</span><br><span class="line">        <span class="keyword">val</span> top1BaseStationID = sortedResultData.head._3</span><br><span class="line">        (phoneNumber, top1BaseStationID)</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        (phoneNumber, <span class="string">&quot;Unknown&quot;</span>) <span class="comment">// 若没有停留记录，则标记为Unknown</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 输出结果</span></span><br><span class="line">    top1BaseStationRDD.foreach &#123; <span class="keyword">case</span> (phoneNumber, top1BaseStationID) =&gt;</span><br><span class="line">      println(<span class="string">s&quot;手机号 <span class="subst">$phoneNumber</span> 的停留时间最长的基站ID为 <span class="subst">$top1BaseStationID</span>&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    resultRDD.saveAsTextFile(outputPath)</span><br><span class="line">    sparkContext.stop()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><h2 id="学习目标评估"><a href="#学习目标评估" class="headerlink" title="学习目标评估"></a>学习目标评估</h2><p>在本次培训开始之前，我们明确了学习目标，并与参与人员共享，以便让他们了解培训的预期成果。我们希望通过本次培训，参与人员能够：</p><ol><li>理解 MapReduce 的基本概念和原理，掌握分布式计算的基本思想。</li><li>掌握 Hive 的使用，了解如何利用 Hive 进行数据仓库和数据分析。</li><li>熟悉 Spark 的核心概念和编程模型，能够使用 Spark 进行大规模数据处理和分析。</li></ol><h2 id="培训成果"><a href="#培训成果" class="headerlink" title="培训成果"></a>培训成果</h2><p>通过本次培训，参与人员在以下方面取得了显著的进步：</p><h3 id="MapReduce"><a href="#MapReduce" class="headerlink" title="MapReduce"></a>MapReduce</h3><ul><li>参与人员深入理解了 MapReduce 的基本原理和分布式计算的概念。</li><li>他们学会了如何使用 Hadoop 生态系统来实现 MapReduce 任务，并在实际练习中体验了分布式计算的优势和挑战。</li></ul><h3 id="Hive-1"><a href="#Hive-1" class="headerlink" title="Hive"></a>Hive</h3><ul><li>参与人员掌握了 Hive 的基本使用方法，包括创建表、数据导入导出、查询数据等操作。</li><li>他们了解了 Hive 的数据仓库和数据分析能力，能够使用 Hive 进行复杂的数据查询和数据处理。</li></ul><h3 id="Spark-1"><a href="#Spark-1" class="headerlink" title="Spark"></a>Spark</h3><ul><li>参与人员熟悉了 Spark 的核心概念，包括 RDD、DataFrame 和 Spark SQL 等。</li><li>他们学会了使用 Spark 进行大规模数据处理和分析，并在实际实验中体验了 Spark 的高性能和灵活性。</li></ul><h3 id="专业成长"><a href="#专业成长" class="headerlink" title="专业成长"></a>专业成长</h3><ul><li>通过本次培训，参与人员在大数据处理和分析领域获得了实际动手经验，提升了相关技能。</li><li>培训中的案例和实践让他们对大数据处理技术有了更深入的理解，为未来在数据领域的工作提供了坚实的基础。</li></ul><p>总结：<br>本次 MapReduce、Hive 和 Spark 的培训为参与人员提供了一次高质量的学习机会。参与人员在专业技能和知识水平方面取得了显著进步，他们对大数据处理和分析有了更深入的了解。通过持续改进培训内容和反馈机制，我们将继续提高培训的质量，帮助更多的人在大数据领域取得成功。</p>]]></content>
      
      
      <categories>
          
          <category> Computer Technology </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Hadoop </tag>
            
            <tag> Scala </tag>
            
            <tag> Spark </tag>
            
            <tag> Hive </tag>
            
            <tag> Java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>我的树</title>
      <link href="/2023/07/10/%E6%88%91%E7%9A%84%E6%A0%91/"/>
      <url>/2023/07/10/%E6%88%91%E7%9A%84%E6%A0%91/</url>
      
        <content type="html"><![CDATA[<h1 id="我的树"><a href="#我的树" class="headerlink" title="我的树"></a>我的树</h1><p>在一个春日的清晨，我亲手种下了一颗八重樱树。这三个月的时光里，我目睹着山泉逐渐成长，一片片嫩绿的叶子在枝条上舒展开来。山泉以山泉的生命力和美丽，为这个季节注入了一份新的生机。</p><p>在那个春天的时刻，当我将那颗娇小的八重樱树插入土壤中时，我心中充满了期待和希望。随着春风的吹拂，山泉开始展示出山泉的成长之美。渐渐地，新叶在山泉的枝条上长出，迎接着温暖的阳光。这些嫩绿的叶子如同小小的温暖拥抱，为整个树冠增添了一抹生机。</p><p>这三个月的时光里，我注视着山泉的每一个细微的变化。每一片新叶的展开都仿佛是一次小小的奇迹，为这颗小树注入了更多的活力和魅力。我看着山泉的叶子渐渐成熟，变得更加浓绿，仿佛是大自然对我忍耐和耐心的回报。</p><p>这棵八重樱树在春天的怀抱中成长，山泉以山泉那婀娜多姿的枝条和嫩绿的叶子，向着阳光伸展着。山泉告诉我，生命的力量是如此的顽强和美好。即使在最初的时刻，山泉可能只是一颗小树，但山泉所散发出的生机和成长的韵律，已经在这片土地上留下了独特的足迹。</p><p>每一次我静静地站在山泉的旁边，感受着春风拂面，看着山泉的成长，我都感受到了希望和生命的力量。这颗八重樱树，山泉不仅仅是一棵树，更是一份美好和勇气的象征。</p><div class="timeline"><div class="timenode"><div class="meta"><p><p>2023-03-10</p></p></div><div class="body"><p>它叫做山泉。</p><img src="https://s1.imagehub.cc/images/2023/07/10/79cc2969d2443f727ca4edd8cc007d.jpeg" class="lazyload placeholder" data-srcset="https://s1.imagehub.cc/images/2023/07/10/79cc2969d2443f727ca4edd8cc007d.jpeg" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="" width="300px"></div></div><div class="timenode"><div class="meta"><p><p>2023-04-29</p></p></div><div class="body"><p>我盼着山泉能快快长大。</p><img src="https://s1.imagehub.cc/images/2023/07/10/IMG_8004.jpeg" class="lazyload placeholder" data-srcset="https://s1.imagehub.cc/images/2023/07/10/IMG_8004.jpeg" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="" width="300px"></div></div><div class="timenode"><div class="meta"><p><p>2023-05-09</p></p></div><div class="body"><p>经过漫长的等待，终于看到了新叶。</p><img src="https://s1.imagehub.cc/images/2023/07/10/IMG_8085.jpeg" class="lazyload placeholder" data-srcset="https://s1.imagehub.cc/images/2023/07/10/IMG_8085.jpeg" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="" width="300px"></div></div><div class="timenode"><div class="meta"><p><p>2023-05-14</p></p></div><div class="body"><p>经常在回宿舍的时候去看山泉。</p><img src="https://s1.imagehub.cc/images/2023/07/10/IMG_8122.jpeg" class="lazyload placeholder" data-srcset="https://s1.imagehub.cc/images/2023/07/10/IMG_8122.jpeg" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="" width="300px"></div></div><div class="timenode"><div class="meta"><p><p>2023-05-23</p></p></div><div class="body"><p>经常在山泉旁边喝酒、聚餐</p><img src="https://s1.imagehub.cc/images/2023/07/10/IMG_8222.jpeg" class="lazyload placeholder" data-srcset="https://s1.imagehub.cc/images/2023/07/10/IMG_8222.jpeg" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="" width="300px"></div></div><div class="timenode"><div class="meta"><p><p>2023-06-30</p></p></div><div class="body"><p>端午节回来之后，第一场雨。</p><p>我把我的红绳，挂在了山泉的身上</p><img src="https://s1.imagehub.cc/images/2023/07/10/IMG_8556.jpeg" class="lazyload placeholder" data-srcset="https://s1.imagehub.cc/images/2023/07/10/IMG_8556.jpeg" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="" width="300px"></div></div><div class="timenode"><div class="meta"><p><p>2023-07-10</p></p></div><div class="body"><p>快放假了。</p><img src="https://s1.imagehub.cc/images/2023/07/10/IMG_8596.jpeg" class="lazyload placeholder" data-srcset="https://s1.imagehub.cc/images/2023/07/10/IMG_8596.jpeg" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp" alt="" width="300px"></div></div><div class="timenode"><div class="meta"><p><p>202?-??-??</p></p></div><div class="body"></div></div></div>]]></content>
      
      
      <categories>
          
          <category> Pointless small talk </category>
          
      </categories>
      
      
        <tags>
            
            <tag> tree </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>GPT API使用教程</title>
      <link href="/2023/07/09/GPT-API%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/"/>
      <url>/2023/07/09/GPT-API%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[<h1 id="什么是GPT"><a href="#什么是GPT" class="headerlink" title="什么是GPT"></a>什么是GPT</h1><p>ChatGPT是OpenAI开发的一种基于语言模型的聊天代理工具。它建立在强大的GPT（Generative Pre-trained<br>Transformer）模型的基础上，可以对自然语言进行理解和生成。</p><p>GPT是一种基于Transformer架构的语言模型，通过大规模的预训练来学习语言的潜在模式和结构。在预训练阶段，模型使用了大量的公开可用的互联网文本数据，从而获得了丰富的语言知识。在预训练之后，通过微调和特定任务的训练，模型可以用于各种自然语言处理任务，包括对话生成。</p><p>ChatGPT是GPT模型在对话生成任务上的应用。它经过训练，使得模型能够理解和生成连贯的对话。您可以向ChatGPT提供一个对话历史或问题，并从模型中获得相应的回复。ChatGPT可以用于构建智能聊天机器人、客服代理、语言翻译等应用。</p><p>OpenAI通过对大规模数据集进行训练，使ChatGPT能够生成流畅、有逻辑的回复，并且具备一定的上下文理解能力。然而，它也可能存在生成不准确、含有偏见或不恰当回答的情况，因此在使用ChatGPT时需要注意对输出进行筛选和审查，以确保生成的回复符合期望和要求。</p><h2 id="GPT-3-5与GPT-4的区别"><a href="#GPT-3-5与GPT-4的区别" class="headerlink" title="GPT-3.5与GPT-4的区别"></a>GPT-3.5与GPT-4的区别</h2><p>我并没有实际的比较过GPT-3.5与GPT-4，但可以看到的是GPT-4新增了插件支持，支持联网，也就是GPT-4可以进行半自主学习，我在前一段时间就看到了GPT-4的一个插件，声称可以快速的帮你读论文，甚至你可以不给出论文，而是根据GPT-4联网的论文库中查找，你只需要给出名字即可。</p><p>网页版GPT-3.5是免费的，而GPT-4是收费的，月费率为$20。</p><p>另外，在API价格方面也有一定差别。这个可以看我前段时间发的tokens。</p><div class="tagLink"><a class="link-card" title="About-GPT-Token" href="/2023/07/07/About-GPT-Token/"><span class="link-card-backdrop" style="background-image: url(https://s1.imagehub.cc/images/2023/07/08/2023-07-08-20.32.05.png)"></span><div class="left"><img src="https://s1.imagehub.cc/images/2023/07/08/2023-07-08-20.32.05.png" class="lazyload placeholder" data-srcset="https://s1.imagehub.cc/images/2023/07/08/2023-07-08-20.32.05.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div><div class="right"><p class="text">About-GPT-Token</p><p class="url">/2023/07/07/About-GPT-Token/</p></div></a></div><h2 id="模型使用方法与主观评价"><a href="#模型使用方法与主观评价" class="headerlink" title="模型使用方法与主观评价"></a>模型使用方法与主观评价</h2><p>OpenAI即今为止发布了非常多的模型，今天早些的时候我每个都去使用了一下，接下来就说一说我的主观感受与使用方法和体验。</p><p>详细的使用教程在OpenAI官网有讲。</p><div class="tagLink"><a class="link-card" title="API REFERENCE" href="https://platform.openai.com/docs/api-reference/introduction"><span class="link-card-backdrop" style="background-image: url(https://yt3.googleusercontent.com/UqT_vCkJIn1P2fH1pchr6lbe3xeEekY61h4bUpJkVuityqKOEtUYcNy3pLiJ5OKdj4uKA81FWE8=s176-c-k-c0x00ffffff-no-rj)"></span><div class="left"><img src="https://yt3.googleusercontent.com/UqT_vCkJIn1P2fH1pchr6lbe3xeEekY61h4bUpJkVuityqKOEtUYcNy3pLiJ5OKdj4uKA81FWE8=s176-c-k-c0x00ffffff-no-rj" class="lazyload placeholder" data-srcset="https://yt3.googleusercontent.com/UqT_vCkJIn1P2fH1pchr6lbe3xeEekY61h4bUpJkVuityqKOEtUYcNy3pLiJ5OKdj4uKA81FWE8=s176-c-k-c0x00ffffff-no-rj" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div><div class="right"><p class="text">API REFERENCE</p><p class="url">https://platform.openai.com/docs/api-reference/introduction</p></div></a></div><h3 id="GPT"><a href="#GPT" class="headerlink" title="GPT"></a>GPT</h3><h4 id="使用方法"><a href="#使用方法" class="headerlink" title="使用方法"></a>使用方法</h4><p>GPT是OpenAI发布的最为广为人知的模型，也是我个人认为最强大的模型。根据OpenAI官方网站的介绍，如果要使用GPT的API，最佳选择是使用Node.js和Python。我曾尝试过使用Node.js、Python、Java和Curl这几种方式，总的来说它们之间差别不大。</p><p>我通常最常使用的是<code>gpt-3.5-turbo</code>模型，不过听说这个模型将在年底下架，并被新一代的3.5模型所取代。对于这个消息，我并没有深入了解。</p><p>起初，我并不擅长进行多轮对话，感觉自己很可笑。但今天我学了一下，发现其实非常简单。</p><p>首先，让我们了解一下发送请求的组成部分（以Curl为例）：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">curl https://api.openai.com/v1/chat/completions \</span><br><span class="line">  -H &quot;Content-Type: application/json&quot; \</span><br><span class="line">  -H &quot;Authorization: Bearer $OPENAI_API_KEY&quot; \</span><br><span class="line">  -d &#x27;&#123;</span><br><span class="line">     &quot;model&quot;: &quot;gpt-3.5-turbo&quot;,</span><br><span class="line">     &quot;messages&quot;: [&#123;&quot;role&quot;: &quot;user&quot;, &quot;content&quot;: &quot;Say this is a test!&quot;&#125;],</span><br><span class="line">     &quot;temperature&quot;: 0.7</span><br><span class="line">   &#125;&#x27;</span><br></pre></td></tr></table></figure><p>API接口为：<a href="https://api.openai.com/v1/chat/completions">https://api.openai.com/v1/chat/completions</a></p><p><code>-H</code>部分包含了两个头信息参数，分别是<code>Content-Type</code>和<code>Authorization</code>，用于指定请求体的类型和授权令牌。需要在官网申请获取OPENAI_API_KEY，并将其替换为实际的密钥。</p><p><code>-d</code>部分是请求体，根据前文中<code>Content-Type</code>为<code>application/json</code>，所以这部分需要符合JSON格式。</p><p>其中，<code>model</code>指定了要使用的模型，<code>messages</code>是对话内容，每个消息包含一个<code>role</code>角色和<code>content</code>内容，用户默认角色为<code>user</code><br>。这两个参数是必需的。</p><p>响应示例：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;chatcmpl-abc123&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;object&quot;</span><span class="punctuation">:</span> <span class="string">&quot;chat.completion&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;created&quot;</span><span class="punctuation">:</span> <span class="number">1677858242</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;model&quot;</span><span class="punctuation">:</span> <span class="string">&quot;gpt-3.5-turbo-0301&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;usage&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;prompt_tokens&quot;</span><span class="punctuation">:</span> <span class="number">13</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;completion_tokens&quot;</span><span class="punctuation">:</span> <span class="number">7</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;total_tokens&quot;</span><span class="punctuation">:</span> <span class="number">20</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;choices&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;message&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;role&quot;</span><span class="punctuation">:</span> <span class="string">&quot;assistant&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;content&quot;</span><span class="punctuation">:</span> <span class="string">&quot;\n\nThis is a test!&quot;</span></span><br><span class="line">      <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;finish_reason&quot;</span><span class="punctuation">:</span> <span class="string">&quot;stop&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;index&quot;</span><span class="punctuation">:</span> <span class="number">0</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>最重要的部分是<code>choices</code>中的<code>message</code>内容，其中<code>role</code>为assistant，表示这是AI助手的回复，<code>content</code>则是AI助手的回复内容。</p><p>以上是基本的请求和响应内容。实现多轮对话也非常简单，只需将前面的对话内容全部传回即可。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">curl https://api.openai.com/v1/chat/completions \</span><br><span class="line">  -H &quot;Content-Type: application/json&quot; \</span><br><span class="line">  -H &quot;Authorization: Bearer $OPENAI_API_KEY&quot; \</span><br><span class="line">  -d &#x27;&#123;</span><br><span class="line">      &quot;model&quot;: &quot;gpt-3.5-turbo&quot;,</span><br><span class="line">      &quot;messages&quot;: [</span><br><span class="line">        &#123;</span><br><span class="line">          &quot;role&quot;: &quot;system&quot;,</span><br><span class="line">          &quot;content&quot;: &quot;You are a helpful assistant.&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          &quot;role&quot;: &quot;user&quot;,</span><br><span class="line">          &quot;content&quot;: &quot;What is 1+1?&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          &quot;role&quot;: &quot;assistant&quot;,</span><br><span class="line">          &quot;content&quot;: &quot;1+1 equals 2.&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          &quot;role&quot;: &quot;user&quot;,</span><br><span class="line">          &quot;content&quot;: &quot;And if we add 3?&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          &quot;role&quot;: &quot;assistant&quot;,</span><br><span class="line">          &quot;content&quot;: &quot;1 + 1 + 3 = 5. So, 1+1 plus 3 equals 5.&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          &quot;role&quot;: &quot;user&quot;,</span><br><span class="line">          &quot;content&quot;: &quot;What if we multiply it by 5?&quot;</span><br><span class="line">        &#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;&#x27;</span><br></pre></td></tr></table></figure><p>可以看到，这里出现了多个<code>assistant</code>和<code>user</code>，还有一个<code>system</code>角色。个人而言，我将<code>user</code>视为自己，而其他角色都是AI助手。这段对话可以看作是多轮对话的示例。</p><p>通过以上方法，我们已经学会了最基本的多轮对话请求方式。</p><h4 id="评价"><a href="#评价" class="headerlink" title="评价"></a>评价</h4><p>GPT-3.5模型是OpenAI发布的一款强大的自然语言处理模型，它具有以下几个方面的优点：</p><ol><li><p><strong>语言生成能力强大</strong>：GPT-3.5模型在语言生成任务上表现出色，能够生成流畅、准确、连贯的文本。它能够根据上下文理解用户的意图并生成相关回复，具备一定的语义理解和逻辑推理能力。</p></li><li><p><strong>多领域适用</strong>：GPT-3.5模型在多个领域都有应用潜力，可以用于编写文章、回答问题、提供建议、创作故事等。无论是技术领域、商业应用还是创意创作，该模型都可以提供有用的信息和帮助。</p></li><li><p><strong>灵活的对话交互</strong>：GPT-3.5模型支持多轮对话，可以进行复杂的对话交互。它能够记住先前的对话历史并根据上下文进行回复，使得对话更加连贯和一致。</p></li><li><p><strong>可定制性强</strong>：GPT-3.5模型允许用户根据实际需求进行定制，可以通过指定不同的角色、添加系统级指示等方式来控制模型的行为。这种灵活性使得模型可以根据特定的应用场景进行定制化的使用。</p></li></ol><p>尽管GPT-3.5模型具有许多优点，但也存在一些考虑因素：</p><ol><li><p><strong>模型训练成本高</strong>：由于GPT-3.5模型的复杂性，其训练和部署成本相对较高，可能对某些个人开发者或小型团队而言不太可承受。</p></li><li><p><strong>对大量数据的依赖</strong>：GPT-3.5模型的性能与其所训练的大规模数据集密切相关。在某些领域或特定任务上，模型可能需要更多的领域专业知识或数据来取得最佳效果。</p></li><li><p><strong>缺乏常识和实际知识</strong>：尽管GPT-3.5模型在生成文本方面表现出色，但它并没有实际的常识和背景知识。在处理需要具备实际知识或复杂推理的任务时，模型可能会出现一些不准确或不合理的回复。</p></li></ol><blockquote><p>当然这是ChatGPT自己对自己的评价。</p></blockquote><h3 id="Image"><a href="#Image" class="headerlink" title="Image"></a>Image</h3><p>OpenAI推出的Image模型还是满垃圾的，也不知道是我自己的问题还是什么。</p><blockquote><p>这个Image图像生成模型并不是DALL·E模型</p></blockquote><h4 id="使用方法-1"><a href="#使用方法-1" class="headerlink" title="使用方法"></a>使用方法</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">curl https://api.openai.com/v1/images/generations \</span><br><span class="line">  -H &quot;Content-Type: application/json&quot; \</span><br><span class="line">  -H &quot;Authorization: Bearer $OPENAI_API_KEY&quot; \</span><br><span class="line">  -d &#x27;&#123;</span><br><span class="line">    &quot;prompt&quot;: &quot;A cute baby sea otter&quot;,</span><br><span class="line">    &quot;n&quot;: 2,</span><br><span class="line">    &quot;size&quot;: &quot;1024x1024&quot;</span><br><span class="line">  &#125;&#x27;</span><br></pre></td></tr></table></figure><p><code>prompt</code>是提示词，使用过<a href="https://www.midjourney.com/">midjourney</a>或者其他的图像生成模型应该满熟悉了，如何使用我不多说了</p><p><code>n</code>生成图像的数量</p><p><code>size</code>生成图像的大小，现在可选为<code>256x256</code>, <code>512x512</code>, <code>1024x1024</code></p><h4 id="评价-1"><a href="#评价-1" class="headerlink" title="评价"></a>评价</h4><p>并不推荐使用，这里推荐midjourney、DALL·E、Diffusion Model这三个应该是主流的了</p><p>以至于后来的图像编辑、图像变化的api我都不想多说了，这里就给出使用方法示例。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">curl https://api.openai.com/v1/images/edits \</span><br><span class="line">  -H &quot;Authorization: Bearer $OPENAI_API_KEY&quot; \</span><br><span class="line">  -F image=&quot;@otter.png&quot; \</span><br><span class="line">  -F mask=&quot;@mask.png&quot; \</span><br><span class="line">  -F prompt=&quot;A cute baby sea otter wearing a beret&quot; \</span><br><span class="line">  -F n=2 \</span><br><span class="line">  -F size=&quot;1024x1024&quot;</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">curl https://api.openai.com/v1/images/variations \</span><br><span class="line">  -H &quot;Authorization: Bearer $OPENAI_API_KEY&quot; \</span><br><span class="line">  -F image=&quot;@otter.png&quot; \</span><br><span class="line">  -F n=2 \</span><br><span class="line">  -F size=&quot;1024x1024&quot;</span><br></pre></td></tr></table></figure><p>使用方法在官方文档中有详细参数</p><h3 id="Audio"><a href="#Audio" class="headerlink" title="Audio"></a>Audio</h3><p>语音转文字这个模型我觉得还是蛮使用的</p><h4 id="使用方法-2"><a href="#使用方法-2" class="headerlink" title="使用方法"></a>使用方法</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">curl https://api.openai.com/v1/audio/transcriptions \</span><br><span class="line">  -H &quot;Authorization: Bearer $OPENAI_API_KEY&quot; \</span><br><span class="line">  -H &quot;Content-Type: multipart/form-data&quot; \</span><br><span class="line">  -F file=&quot;@/path/to/file/audio.mp3&quot; \</span><br><span class="line">  -F model=&quot;whisper-1&quot;</span><br></pre></td></tr></table></figure><p><code>-F</code>代表使用form-data，这就对应了上文中<code>Content-Type: multipart/form-data</code></p><p><code>file</code>需要上传的音频文件，支持的格式有<code>mp3</code>, <code>mp4</code>, <code>mpeg</code>, <code>mpga</code>, <code>m4a</code>, <code>wav</code>, <code>webm</code></p><p><code>model</code>使用的模型，目前，用于音频的模型仅有<code>whisper-1</code></p><h4 id="评价-2"><a href="#评价-2" class="headerlink" title="评价"></a>评价</h4><p>个人使用的次数不多，但总体感受是，蛮好用的。</p><h2 id="资料分享"><a href="#资料分享" class="headerlink" title="资料分享"></a>资料分享</h2><p>关于OpenAI的论文，官网已经发表了连接<a href="https://openai.com/research">在这里</a></p><h2 id="最后的话"><a href="#最后的话" class="headerlink" title="最后的话"></a>最后的话</h2><p>目前我还并没有去研究微调模型，不过在今后说不定会感兴趣。</p>]]></content>
      
      
      <categories>
          
          <category> Computer Technology </category>
          
      </categories>
      
      
        <tags>
            
            <tag> GPT </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>期末复习-习近平思想和中国特色社会主义理论体系概论</title>
      <link href="/2023/07/08/%E6%9C%9F%E6%9C%AB%E5%A4%8D%E4%B9%A0-%E4%B9%A0%E8%BF%91%E5%B9%B3%E6%80%9D%E6%83%B3%E5%92%8C%E4%B8%AD%E5%9B%BD%E7%89%B9%E8%89%B2%E7%A4%BE%E4%BC%9A%E4%B8%BB%E4%B9%89%E7%90%86%E8%AE%BA%E4%BD%93%E7%B3%BB%E6%A6%82%E8%AE%BA/"/>
      <url>/2023/07/08/%E6%9C%9F%E6%9C%AB%E5%A4%8D%E4%B9%A0-%E4%B9%A0%E8%BF%91%E5%B9%B3%E6%80%9D%E6%83%B3%E5%92%8C%E4%B8%AD%E5%9B%BD%E7%89%B9%E8%89%B2%E7%A4%BE%E4%BC%9A%E4%B8%BB%E4%B9%89%E7%90%86%E8%AE%BA%E4%BD%93%E7%B3%BB%E6%A6%82%E8%AE%BA/</url>
      
        <content type="html"><![CDATA[<h1 id="习近平思想和中国特色社会主义理论体系概论"><a href="#习近平思想和中国特色社会主义理论体系概论" class="headerlink" title="习近平思想和中国特色社会主义理论体系概论"></a>习近平思想和中国特色社会主义理论体系概论</h1><h2 id="单项选择"><a href="#单项选择" class="headerlink" title="单项选择"></a>单项选择</h2><ol><li>经过长期努力，中国特色社会主义进入新时代，这是我国发展新的<code>历史方位</code></li><li><code>人民至上</code>是贯彻习近平新时代中国特色社会主义思想的一根红线。</li><li>坚持和发展中国特色社会主义，总任务是<code>实现社会主义现代化和中华民族伟大复兴，在全面建成小康社会的基础上，分两步走在本世纪中叶建成富强民主文明和谐美丽的社会主义现代化强国</code>。</li><li>中国特色社会主义的战略布局是<code>“四个全面”</code>。</li><li>世界未有之大变局正在加速演变。<code>和平与发展</code>仍然是时代主题，但是不稳定不确定性更加突出。</li><li>实现中国梦必须凝聚中国力量，这就是<code>各族人民大团结的力量</code>。</li><li>实现中国梦必须弘扬中国精神，这就是<code>以爱国主义为核心的民族精神和以改革创新为核心的时代精神</code>。</li><li>实现中国梦必须走中国道路。中国道路是指<code>中国特色社会主义道路</code>。</li><li>全面建设社会主义现代化国家进程中的第一个阶段，从2020年到2035年，<code>基本实现社会主义现代化</code>。</li><li>中国特色社会主义的总体布局是<code>“五位一体”</code>。</li><li><code>中国特色社会主义文化</code>是中华民族的根和魂，是中国特色社会主义植根的文化沃土。</li><li>党的十八大以来，我们党的全部理论和实践探索都是围绕<code>坚持和发展中国特色社会主义</code>这个主题来展开、深化和拓展的。</li><li>进入新时代，我国社会主要矛盾已经转化为<code>人民日益增长的美好生活需要和不平衡不充分的发展之间的矛盾</code>。</li><li>中国特色社会主义最本质的特征是<code>中国共产党领导</code>。</li><li>中国梦归根到底是<code>人民的梦</code>，必须紧紧依靠人民来实现，必须不断为人民造福。</li><li>改革开放之后，我们党提出的“三步走”战略的第三步，即基本实现现代化，将提前<code>15年</code>完成。</li><li>中国共产党的性质决定了党的宗旨是<code>全心全意为人民服务</code>。</li><li>中国共产党作为马克思主义政党，其最大的政治优势是<code>密切联系群众</code>。</li><li><code>实现中华民族伟大复兴</code>是党百年奋斗的主题。</li><li>中国梦的本质是<code>国家富强、民族振兴、人民幸福</code>。</li><li><code>群众路线</code>始终是党的生命线和根本工作路线，是我们党永葆青春活力和战斗力的重要传家宝。</li><li>马克思主义政党站在人民立场上，始终将最广大人民群众的根本利益作为自己的<code>最高利益</code>。</li><li>党自成立之日起，就把“人民”二字铭刻在心，把坚持<code>人民利益</code>高于一切鲜明地写在自己的旗帜上。</li><li><code>人的全面发展</code>是中国特色社会主义的价值目标。</li><li><code>共同富裕</code>是社会主义的本质要求，是中国式现代化的重要特征。</li><li>党的十九届六中全会进一步明确，必须坚持<code>以人民为中心</code>的发展思想，发展全过程人民民主，推动人的全面发展、全体人民共同富裕取得更为明显的实质性进展。</li><li>我们乘势而上开启全面建设社会主义现代化国家新征程、向第二个百年奋斗目标进军，这标志着我国进入了一个<code>新发展阶段</code>。</li><li>我国经济已由高速增长阶段转向<code>高质量发展阶段</code>，正处在转变发展方式、优化经济结构、转换增长动力的攻关期。</li><li>经济进入新常态后，伴随着经济增长速度的下降，推动<code>供给侧改革</code>成为经济生活中的主旋律。</li><li><code>新发展格局</code>是根据我国发展阶段、环境、条件变化提出来的，是重塑我国国际合作和竞争新优势的战略抉择，是把握未来发展主动权的战略性布局和先手棋。</li><li>经济改革的方向是要让<code>市场</code>在资源配置中发挥决定性作用。</li><li>国有企业是中国特色社会主义的重要物质基础和政治基础，关系<code>公有制主体</code>地位的巩固，关系我们党的执政地位和执政能力，关系我国社会主义制度。</li><li>建设充分发挥<code>市场作用</code>，更好发挥政府作用的经济体制。</li><li>党的十九大提出，到<code>2035年</code>“各方面制度更加完善，国家治理体系和治理能力现代化基本实现”。</li><li>中国特色社会主义制度和国家治理体系是以<code>马克思主义</code>为指导、植根中国大地、具有深厚中华文化根基、深得人民拥护的制度和治理体系。</li><li>坚持和完善中国特色社会主义制度、推进国家治理体系和治理能力现代化，不仅要建立完善的制度体系，还要在不断<code>提高制度执行力和治理能力</code>上狠下功夫。</li><li><code>党的十八届三中全会</code>作出了全面深化改革的决定。</li><li>党的十九届四中全会，对坚持和完善中国特色社会主义制度、推进国家治理体系和治理能力现代化作出总体擘画。以下表述不正确的是<code>本世纪中叶，全面建成符合社会主义现代化发展的国家治理体系</code>。</li><li>推进改革的目的是要不断推进我国社会主义制度<code>自我完善和发展</code>，赋予社会主义新的生机活力。</li><li><code>引进来和走出去</code>是“一带一路”国际合作的重要内容，如同车之两轮、鸟之两翼。国家富强、民族振兴、人民幸福。</li><li><code>自力更生</code>是中华民族自立于世界民族之林的奋斗基点，自主创新是我们攀登世界科技高峰的必由之路。</li><li><code>中国共产党领导</code>是中国特色科技创新事业不断前进的根本政治保证。</li><li>办好人民满意的教育必须深化教育领域综合改革、必须促进教育公平、必须<code>建设高质量教育体系</code>、必须加强教师队伍建设。</li><li>党的十八大以来，在以习近平同志为核心的党中央的坚强领导下，我国把<code>科技自立自强</code>作为国家发展的战略支撑，持续深入实施创新驱动发展战略，大力建设创新型国家和科技强国，我国已成功进入创新型国家行列。</li><li>全球科技革命发展的主要特征是从<code>科学</code>到<code>技术</code>转化，基本要求是重大基础研究成果产业化。</li><li>必须坚持科技是第一生产力、<code>人才</code>是第一资源、创新是第一动力，深入实施科教兴国战略、人才强国战略、创新驱动发展战略，开辟发展新领域新赛道，不断塑造发展新动能新优势。</li><li><code>人民民主</code>是社会主义的生命，没有民主就没有社会主义，就没有社会主义的现代化，就没有中华民族伟大复兴。</li><li><code>中国共产党的领导</code>是中国发展全过程人民民主的根本保证。</li><li>全过程人民民主首次提出是在<code>2019年11月</code>。</li><li>社会主义民主的实质是<code>人民当家作主</code>。</li><li><code>民主</code>是统治阶级用来实现其阶级利益的政治形式和手段。</li><li>中华民族要实现伟大复兴中国梦，不仅要创造高度的物质文明、精神文明、社会文明、生态文明，而且要建设高度的<code>政治文明</code>。</li><li>国家治理高效在于，始终把<code>中国人民</code>利益放在第一位。</li><li><code>程序民主</code>是指民主的制度安排，实质民主是指民主始终追求的价值目标，二者有机结合。</li><li>完善行政组织和行政程序法律制度，推进<code>机构、职能、权限、程序、责任</code>法定化。</li><li>办好法学教育，必须坚持走中国特色社会主义法治道路，坚持以<code>马克思主义</code>法学思想和中国特色社会主义法治理论为指导。</li><li><code>中国特色社会主义法治体系</code>是推进全面依法治国的总抓手。</li><li><code>宪法</code>是国家根本法，是党和人民意志的集中体现，是国家各种制度和法律法规的总依据。</li><li>我们讲坚持依宪治国、依宪执政，就包括坚持宪法确定的<code>中国共产党领导</code>地位不动摇。</li><li><code>党内法规</code>既是全面从严治党的重要依据，也是全面依法治国的有力保障。</li><li><code>文化自信</code>是更基础、更广泛、更深厚的自信，是一个国家、一个民族发展中最基本、最深沉、最持久的力量。</li><li>以下不是反映中华优秀传统文化中蕴含着丰富的国家安全战略思想的是<code>“美人之美，美美与共”</code>。</li><li>每年<code>4月15日</code>被确定为全民国家安全教育日。</li><li>基层治理是国家治理的基石，统筹推进乡镇（街道）和城乡社区治理，是实现<code>国家治理体系和治理能力现代化</code>的基础工程。</li><li>要树立尊重自然、顺应自然、保护自然的生态文明理念，增强<code>绿水青山就是金山银山</code>的意识。</li><li><code>生态系统</code>是一个系统整体，山水林田湖草沙构成相依共存、有机关联的生命共同体。这个生命共同体的生生循环、绵延不息葆有着人类生存发展的物质根基。</li><li><code>政治安全</code>攸关党和国家生死存亡，是国家安全的根本。</li><li><code>就业</code>是最大的民生工程、民心工程、根基工程，是社会稳定的重要保障。</li><li>习近平“两山论”的突出贡献是<code>马克思主义生产力观的新成果</code>。</li><li>关于繁荣发展文化事业和文化产业，以下说法错误的是<code>坚持以市场效益为核心的创作导向，推出更多受市场欢迎的优秀作品</code>。</li><li>从意识形态领域看，<code>互联网</code>已经成为舆论斗争的主战场，直接关系我国意识形态安全和政权安全。</li><li>党的二十大报告强调，坚持以<code>人民</code>为中心的创作导向，推出更多增强人民精神力量的优秀作品，培育造就大批德艺双馨的文学艺术家和规模宏大的文化文艺人才队伍。</li><li><code>民生在勤，勤则不匮</code>是民生概念在中国历史上的最早表述。</li><li>如期实现建军一百年奋斗目标，加快把人民军队建成世界一流军队，必须贯彻新时代党的强军思想，贯彻新时代军事战略方针，坚持党对人民军队的绝对领导，坚持政治建军、改革强军、<code>科技强军</code>、人才强军、依法治军。</li><li>推动形成<code>绿色生产方式和生活方式</code>是贯彻新发展理念的必然要求，必须把生态文明建设摆在全局工作的突出地位。</li><li>人因自然而生，人与自然是一种<code>共生关系</code>。生态环境没有替代品，用之不觉，失之难存。如果竭泽而渔，最后必然是什么鱼也没有了。</li><li>党的二十大报告中强调，坚持房子是用来住的、不是用来炒的定位，加快建立多主体供给、多渠道保障、<code>租购并举</code>的住房制度。</li><li>我们经过接续奋斗，实现了小康这个中华民族的千年梦想，打赢了人类历史上规模最大的脱贫攻坚战，全国832个贫困县全部摘帽，近<code>一亿</code>农村贫困人口实现脱贫，960多万贫困人口实现易地搬迁。</li><li>一个政权的瓦解往往是从<code>思想</code>领域开始的，这一防线被攻破了，其他防线就很难守住。</li><li>发展和安全，是一个国家、一个民族生存与进步必须处理好的首要问题。发展解决的是<code>动力问题</code>，是推动国家和民族赓续绵延的根本支撑，安全解决的是<code>保障问题</code>，是确保国家和民族行稳致远的坚强柱石，发展和安全是一体之两翼、驱动之双轮。</li><li>党对军队的<code>绝对领导</code>是中国特色社会主义的本质特征，是党和国家的重要政治优势，是人民军队的建军之本、强军之魂。</li><li>强国必须强军，军强才能国安。在全面建设社会主义现代化国家、实现第二个百年奋斗目标的历史进程中，必须把<code>国防和军队建设</code>摆在更加重要的位置。</li><li>适应国家发展战略和安全战略新要求，与时俱进创新军事战略指导，调整优化军事战略布局，完善新时代军事战略体系，不断赋予<code>积极防御</code>战略思想新的内涵。</li><li>新时代全军必须夯实<code>依法治军</code>、从严治军这个强军之基，持之以恒推进作风建设和反腐败斗争，自觉践行人民军队根本宗旨，保持人民军队长期形成的良好形象。</li><li>军队是要打仗的，要牢固树立<code>战斗力</code>这个唯一的根本的标准，坚持把这个标准贯彻到全军各项建设和工作之中。</li><li>“一国两制”构想最早是针对<code>台湾</code>问题提出来的。</li><li>2022年7月1日，习近平总书记在庆祝香港回归祖国25周年大会暨香港特别行政区第六届政府就职典礼上的重要讲话中指出：”‘一国两制’是前无古人的伟大创举。’一国两制’的根本宗旨是<code>维护国家主权、安全、发展利益，保持香港、澳门长期繁荣稳定</code>。”</li><li>中国始终坚持<code>维护世界和平、促进共同发展</code>的外交政策宗旨，致力于推动构建人类命运共同体。</li><li>经过持续努力，中国特色大国外交全面推进，<code>构建人类命运共同体</code>成为引领时代潮流和人类前进方向的鲜明旗帜。</li><li>中国坚定奉行<code>独立自主</code>的和平外交政策，始终根据事情本身的是非曲直决定自己的立场和政策。</li><li>中国坚持对外开放的基本国策，坚定奉行<code>互利共赢</code>的开放战略，不断以中国新发展为世界提供新机遇，推动建设开放型世界经济，更好惠及各国人民。</li><li>中国坚持在<code>和平共处五项原则</code>基础上同各国发展友好合作，推动构建新型国际关系，深化拓展平等、开放、合作的全球伙伴关系，致力于扩大同各国利益的汇合点。</li><li>十年来，我们提出<code>新时代解决台湾问题的总体方略</code>，促进两岸交流合作，坚决反对”台独”分裂行径，坚决反对外部势力干涉，牢牢把握两岸关系主导权和主动权。</li><li>党的二十大报告指出，经过不懈努力，党找到了<code>自我革命</code>这一跳出治乱兴衰历史周期率的第二个答案。</li><li>习近平总书记在中国共产党第十九次全国代表大会上的报告中强调，坚持和<code>加强党的全面领导，坚持党要管党、全面从严治党，以加强党的长期执政能力建设、先进性和纯洁性建设</code>为主线。</li><li>把<code>政治建设</code>摆在首位，抓住了全面从严治党的根本性问题。</li><li>用党的创新理论武装全党是党的<code>思想建设</code>根本任务。</li><li>党的<code>作风</code>就是党的形象，关系人心向背，关系党的生死存亡。</li><li>我们要践行<code>共商共建共享</code>全球治理观，弘扬全人类共同价值，倡导不同文明交流互鉴。</li></ol><h2 id="多项选择"><a href="#多项选择" class="headerlink" title="多项选择"></a>多项选择</h2><p>实现“两个结合”是我们推进马克思主义中国化时代化的根本途径，具体是指____。<br>坚持马克思主义基本原理同中国具体实际相结合<br>坚持马克思主义基本原理同中华优秀传统文化相结合</p><p>习近平新时代中国特色社会主义思想回答的重大时代课题包括____。<br>新时代坚持和发展什么样的中国特色社会主义、怎样坚持和发展中国特色社会主义<br>建设什么样的社会主义现代化强国、怎样建设社会主义现代化强国<br>建设什么样的长期执政的马克思主义政党、怎样建设长期执政的马克思主义政党</p><p>以下属于习近平新时代中国特色社会主义思想的世界观和方法论的是____。<br>坚持人民至上<br>坚持自信自立<br>坚持守正创新</p><p>实现中华民族伟大复兴进入了不可逆转的历史进程，我国发展的战略性有利条件包括<br>____。<br>中国共产党的坚强领导<br>中国特色社会主义制度的显著优势<br>持续快速发展积累的坚实基础<br>长期稳定的社会环境和自信自强的精神力量</p><p>中国式现代化是中国共产党领导的社会主义现代化，既有各国现代化的共同特征，更有基于自己国情的中国特色。中国式现代化是____。<br>人口规模巨大的现代化<br>全体人民共同富裕的现代化<br>走和平发展道路姿和的现代化</p><p>“五个必由之路”是多年来我国党和人民在历史实践历程中得到的宝贵答案，揭示了新时代坚持和发展中国特色社会主义的规律性认识，具体包括____。<br>坚持党的全面领导和中国特色社会主义<br>贯彻新发展理念<br>坚持全面从严治党。</p><p>党的十八届六中全会正式确立习近平总书记党中央的核心、全党的核心地位，要求全党必须牢固树立“四个意识”。“四个意识”是指____。<br>政治意识<br>大局意识<br>核心意识<br>看齐意识</p><p>中国共产党是中国特色社会主义事业的开创者、推动者、引领者，团结带领人民____。<br>开辟了中国特色社会主义道路<br>创立了中国特色社会主义理论<br>创建了中国特色社会主义制度<br>发展了中国特色社会主义文化</p><p>中国梦的本质是____。<br>国家富强<br>民族振兴<br>人民幸福</p><p>坚定中国特色社会主义“四个自信”，具体包括____。<br>道路自信<br>理论自信<br>制度自信<br>文化自信</p><p>以人民为中心的发展思想，不是高高在上的宣传口号，绝对不能只停留在口头上，要全方位贯穿于经济社会发展的各个环节，体现在人民群众____的扎实提升上。<br>获得感<br>幸福感<br>安全感</p><p>不忘初心、牢记使命，说到底是为什么人、靠什么人的问题。以百姓心为心，与人民____，是党的初心，也是党的恒心。<br>同呼吸<br>共命运<br>心连心</p><p>____与____相统一，既是马克思主义的价值追求，也是社会主义的本质要求，更是中国共产党人的奋斗目标。<br>促进人的全面发展<br>促进共同富裕</p><p>我国经济发展处于____阶段，我国发展进入新常态。<br>增长速度换挡期<br>结构调整阵痛期<br>前期刺激政策消化期</p><p>要推进供给侧结构性改革作为经济发展的主线，坚持____方针<br>巩固<br>增强<br>提升<br>畅通</p><p>进入____、贯彻____、构建____，是由我国经济社会发展的理论逻辑、历史逻辑、现实逻辑决定的，三者紧密关联。<br>新发展阶段<br>新发展理念<br>新发展格局</p><p>治理能力是运用国家制度管理国家各方面事务的能力，它包括____等各个方面各个领域的治理能力。<br>改革发展稳定<br>内政外交国防<br>治党治国治军</p><p>全面深化改革必须坚持和完善____。<br>中国特色社会主义制度<br>国家治理体系</p><p>五四运动以来，我国发生的三大历史性事件____，是近代以来实现中华民族伟大复兴的三大里程碑。<br>建立中国共产党<br>成立中华人民共和国<br>推进改革开放和中国特色社会主义事业</p><p>全面深化改革的总目标是____。<br>完善和发展中国特色社会主义制度<br>推进国家治理体系和治理能力现代化</p><p>我们必须站在战略高度上看问题，真正把教育摆在先行官的位置，努力实现____相互支持、相互促进的良性循环。<br>教育<br>科技<br>经济</p><p>教育强国、科技强国和人才强国是新时代科教兴国战略的总体部署，目的是____<br>办好人民满意的教育<br>完善科技创新体系<br>创新驱动发展<br>优化高素质人才培养</p><p>要把重要领域的科技创新摆在更加突出的地位，以____为突破口，加强对关系根本和全局的科学问题的研究部署，在战略必争领域打破重大关键核心技术受制于人的局面，加快构筑支撑高端引领的先发优势。坚持人民至上<br>关键共性技术<br>前沿引领技术<br>现代工程技术<br>颠覆性技术创新</p><p>人民既是民主的____，也是民主的____，智慧力量充分激发，既为自己也为国家、民族拼搏奋斗。<br>参与者<br>受益者</p><p>在人民民主的共同旗帜下，中国共产党与各民主党派____。<br>长期共存<br>互相监督<br>肝胆相照<br>荣辱与共</p><p>要坚持和完善人民当家作主制度体系，不断推进社会主义民主政治____，更好把制度优势转化为治理效能。<br>制度化<br>规范化<br>程序化</p><p>走中国特色社会主义政治发展道路，必须坚持____有机统一。<br>党的领导<br>人民当家作主，依法治国</p><p>准确把握全面推进依法治国重点任务，着力推进____。<br>科学立法<br>严格执法<br>公正司法<br>全民守法</p><p>坚持以宪法为最高法律规范，完善以宪法为核心的中国特色社会主义法律体系，加强____立法，把国家各项事业和各项工作纳入法制轨道。<br>重点领域<br>新兴领域<br>涉外领域</p><p>全面推进依法治国，必须大力提高法治工作队伍思想政治素质、业务工作能力、职业道德水准，着力建设一支____的社会主义法治工作队伍。<br>忠于党<br>忠于国家<br>忠于人民<br>忠于法律</p><p>伟大抗疫精神包括____。<br>生命至上<br>举国同心<br>舍生忘死<br>尊重科学<br>命运与共</p><p>加强和创新社会治理，改进社会治理方式，要坚持____。<br>系统治理<br>综合治理<br>依法治理<br>源头治理</p><p>中国特色社会主义文化的根本所在、深厚基础、不竭源泉分别是____。<br>马克思主义指导下形成的革命文化和社会主义先进文化<br>中华优秀传统文化<br>中国特色社会主义伟大实践</p><p>社会主义核心价值观涉及国家、社会、公民三个层面的价值要求，具体表达为____<br>富强、民主、文明、和谐<br>爱国、敬业、诚信、友善<br>自由、平等、公正、法治</p><p>共同富裕是全体人民共同富裕，是人民群众____都富裕。<br>物质生活<br>精神生活</p><p>做好意识形态工作事关____，任何时候任何情况下，我们都不能忽视思想的力量、忽视意识形态的作用。<br>党的前途命运<br>国家长治久安<br>民族凝聚力和向心力</p><p>讲好中国故事，要着重讲好____，展示文明大国、东方大国、负责任大国、社会主义大国形象，让当代中国形象在世界上不断树立和闪亮起来。<br>中国的故事<br>中国共产党的故事<br>中国特色社会主义的故事<br>中国人民的故事</p><p>新时代维护国家安全的实践要求____。<br>加强国家安全体系和能力建设<br>提高防范化解重大风险能力</p><p>增强意识形态领域主导权和话语权，就要坚定广大干部群众的____。<br>道路自信<br>理论自信<br>制度自信<br>文化自信</p><p>推动经济社会发展绿色化、低碳化是实现高质量发展的关键环节。为此，我们要积极推动____的绿色转型，打造国家重大战略绿色发展高地。<br>产业结构<br>能源结构<br>交通运输结构<br>消费方式</p><p>推动构建新型国际关系，就是要秉持____，摒弃传统的以强凌弱的丛林法则，走出一条对话而不对抗、结伴而不结盟的国与国交往新路。<br>合作共赢<br>相互尊重<br>公平正义</p><p>近年来，保护主义、单边主义抬头，逆全球化思潮发酵，发展空间不平衡成为全球治理面临的突出问题，世界正面临着____几大赤字。<br>发展<br>信任<br>和平<br>治理</p><p>____是全人类的共同价值，也是联合国的崇高目标。目标远未完成，我们仍须努力。<br>公平、正义<br>和平、发展<br>民主、自由</p><p>当今世界正经历百年未有之大变局，这样的大变局不是一时一事、一域一国之变，是____。<br>世界之变<br>历史之变<br>时代之变</p><p>积极发展全球伙伴关系，扩大同各国的利益汇合点，不断完善我国____的外交布局，打造覆盖全球的”朋友圈”。<br>多层次<br>全方位<br>立体化</p><p>构建人类命运共同体思想的内涵是：建设持久和平、____的世界。<br>普遍安全<br>开放包容<br>共同繁荣<br>清洁美丽</p><p>一个国家的安全不能建立在别国的动荡之上，各方应该树立____的安全观，统筹应对传统和非传统安全威胁，反对一切形式的恐怖主义。<br>共同<br>可持续<br>合作<br>综合</p><p>全军必须坚决落实党中央、中央军委和习近平主席决策部署，强化____，做到全部精力向打仗聚焦，全部工作向打仗用劲，完成党和人民赋予的新时代使命任务。<br>危机意识<br>忧患意识<br>打仗意识</p><p>着力抓好军队党的政治建设，严肃政治纪律和政治规矩，确保部队____，确保枪杆子永远听党指挥。<br>绝对纯洁<br>绝对可靠<br>绝对忠诚</p><p>《中共中央关于党的百年奋斗重大成就和历史经验的决议》中明确党在新时代的强军目标是建设一支____的人民军队，把人民军队建设成为世界一流军队。<br>能打胜仗<br>听党指挥<br>作风优良</p><p>在重塑人民军队组织形态方面，按照”____”原则，强化军委集中统一领导和战略指挥、战略管理功能，打破长期实行的总部体制、大军区体制、大陆军体制，构建新的军队领导管理和作战指挥体制。<br>战区主战<br>军种主建<br>军委管总</p><p>党提出新时代人民军队使命任务，创新军事战略指导，调整优化军事战略布局，强化人民军队____的战略功能。<br>遏制战争<br>打赢战争<br>塑造态势<br>管控危机</p><p>全面加强练兵备战，提高人民军队打赢能力，要深入推进实战化军事训练，深化____。<br>科技练兵<br>对抗训练<br>联合训练</p><p>两岸同胞血脉相连，是血浓于水的一家人。我们始终尊重、关爱、造福台湾同胞，继续致力于____。<br>促进两岸经济文化交流合作，<br>深化两岸各领域融合发展，<br>完善增进台湾同胞福祉的制度和政策，<br>推动两岸共同弘扬中华文化，促进两岸同胞心灵契合。</p><p>支持香港、澳门发展经济、改善民生、破解经济社会发展中的深层次矛盾和问题。发挥香港、澳门优势和特点，<br>巩固提升香港、澳门在国际金融、贸易、航运航空、创新科技、文化旅游等领域的地位<br>深化香港、澳门同各国各地区更加开放、更加密切的交往合作<br>推进粤港澳大湾区建设<br>支持香港、澳门更好融入国家发展大局，为实现中华民族伟大复兴更好发挥作用</p><p>在确保国家____的前提下，和平统一后，台湾同胞的社会制度和生活方式等将得到充分尊重，台湾同胞的私人财产、宗教信仰、合法权益将得到充分保障。<br>发展利益<br>主权<br>安全</p><p>百年来，中国共产党____从最初50多名党员发展到今天拥有9600多万名党员的世界上最大的马克思主义执政党，历经千锤百炼而朝气蓬勃，正带领中国人民以不可阻挡的步伐迈向伟大复兴。<br>坚持性质宗旨<br>坚持理想信念<br>坚守初心使命<br>勇于自我革命</p><p>全面加强党的思想建设，坚持用习近平新时代中国特色社会主义思想____，组织实施党的创新理论学习教育计划，建设马克思主义学习型政党。<br>统一思想<br>统一意志<br>统一行动</p><p>新时代党的组织路线,全面贯彻新时代中国特色社会主义思想，____为坚持和加强党的全面领导、坚持和发展中国特色社会主义提供坚强组织保证。<br>以组织体系建设为重点<br>着力培养忠诚干净担当的高素质干部<br>着力集聚爱国奉献的各方面优秀人才<br>坚持德才兼备、以德为先、任人唯贤</p><p>突出工作重点，抓紧建立和完善主干性、支撑性党内法规制度，健全相关配套法规制度，统筹推进立改废释工作，形成____的党内法规制度体系。以改革创新精神解决突出问题、补齐法规制度短板，提高党内法规制度质量。<br>内容科学<br>程序严密<br>配套完备<br>运行有效</p><h2 id="主观题"><a href="#主观题" class="headerlink" title="主观题"></a>主观题</h2><h3 id="人类命运共同体的内涵？"><a href="#人类命运共同体的内涵？" class="headerlink" title="人类命运共同体的内涵？"></a>人类命运共同体的内涵？</h3><ol><li>坚持对话协商，推动建设一个持久和平的世界;</li><li>坚持共建共享，推动建设一个普遍安全的世界;</li><li>坚持合作共赢，推动建设一个共同繁荣的世界;</li><li>坚持交流互鉴，推动建设一个开放包容的世界;</li><li>坚特绿色低碳，推动建设一个清洁美丽的世界。</li></ol><h3 id="中国特色社会主义进入新时代的历史意义是什么？"><a href="#中国特色社会主义进入新时代的历史意义是什么？" class="headerlink" title="中国特色社会主义进入新时代的历史意义是什么？"></a>中国特色社会主义进入新时代的历史意义是什么？</h3><ol><li>意味着近代以来久经磨难的中华民族迎来了从站起来、富起来到强起来的伟大飞跃，迎来了实现中华民族伟大复兴的光明前景;</li><li>意味着科学社会主义在二十一世纪的中国焕发出强大生机活力，在世界上高高类起了中国特色社会主义伟大旗帜;</li><li>意味着中国特色社会主义道路、理论、制度。文化不断发展，拓展了发展中国家走向现代化的途径，给世界上那些既希望加快发展又希望保持自身独立性的国家和民族提供了全新选择，为解决人类问题贡献了中国智慧和中国方案。</li></ol><h3 id="习近平新时代中国特色社会主义思想回答了什么重大时代课题？"><a href="#习近平新时代中国特色社会主义思想回答了什么重大时代课题？" class="headerlink" title="习近平新时代中国特色社会主义思想回答了什么重大时代课题？"></a>习近平新时代中国特色社会主义思想回答了什么重大时代课题？</h3><ol><li>新时代坚持和发展什么样的中国特色社会主义、怎样坚持和发展中国特色社会主义</li><li>建设什么样的社会主义现代化强国、怎样建设社会主义现代化强国</li><li>建设什么样的长期执政的马克思主义政党，怎样建设长期执政的马克思主义政党</li></ol><h3 id="如何理解习近平新时代中国特色社会主义思想的历史地位？"><a href="#如何理解习近平新时代中国特色社会主义思想的历史地位？" class="headerlink" title="如何理解习近平新时代中国特色社会主义思想的历史地位？"></a>如何理解习近平新时代中国特色社会主义思想的历史地位？</h3><ol><li>当代中国马克思主义。三十一世纪马克思主义。</li><li>中华文化和中国精神的时代精华。</li><li>马克思主义中国化时代化新的飞跃。</li></ol><h3 id="如何奋力实现中国梦？"><a href="#如何奋力实现中国梦？" class="headerlink" title="如何奋力实现中国梦？"></a>如何奋力实现中国梦？</h3><ol><li>实现中国梦必领走中国道路，这就是中国特色社会主义道路;</li><li>实现中国梦必须弘扬中国精神——以爱国主义为核心的民族精神和以改革创新为核心的时代精神；</li><li>实现中国梦必须凝聚中国力量——中国各族人民大园结的力量。</li></ol><h3 id="实现全体人民共同富裕的实践举措有哪些？关注乡村振兴"><a href="#实现全体人民共同富裕的实践举措有哪些？关注乡村振兴" class="headerlink" title="实现全体人民共同富裕的实践举措有哪些？关注乡村振兴"></a>实现全体人民共同富裕的实践举措有哪些？关注乡村振兴</h3><ol><li>提高发展的平衡性、协调性、包容性。</li><li>着力扩大中等收入群体规模。</li><li>促进基本公共服务均等化。</li><li>加强对高收入的规范和调节。</li><li>促进人民精神生活共同富裕。</li><li>促进农民农村共同富裕。</li></ol><h3 id="如何构建对外开放新格局？"><a href="#如何构建对外开放新格局？" class="headerlink" title="如何构建对外开放新格局？"></a>如何构建对外开放新格局？</h3><ol><li>实行更加积极主动的开放战咯。<br>开放是当代中国的鲜明标识，觉的十八大以来，我国采取了更加积极主动的开放战略，我国对外开放水平持续提升，我们要推动更加包容的全球发展。人类文明己经进入21世纪，冷战思维早己过时。我们应该携手努力，开辟合作共赢的新境界。</li><li>构建互利共赢、多元平衡、 安全高效的开放型经济体系。<br>扩内需和增外需相互动，“引进来”和“走出去” 并举，促开放和护安全统筹，稳步扩大规则、规制、管理、标准等制度型开放。</li><li>推动共建“一带一路”高质量发展。经济发展、民生改善、文明进步。</li></ol><h3 id="我国现代化经济体系的内容是什么？"><a href="#我国现代化经济体系的内容是什么？" class="headerlink" title="我国现代化经济体系的内容是什么？"></a>我国现代化经济体系的内容是什么？</h3><ol><li>创新引领。协同发展的产业体系。统一开放、竞争有序的市场体系。</li><li>体现效率、促进公平的收入分配体系。彰显优势、协调联动的城乡区域发展体系。</li><li>资源节约。环境友好的绿色发展体系。多元平街、安全高效的全面开放体系。</li><li>充分发挥市场作用、重好发挥政府作用的经济体制。</li></ol><h3 id="供给侧结构性改革的必要性是什么？"><a href="#供给侧结构性改革的必要性是什么？" class="headerlink" title="供给侧结构性改革的必要性是什么？"></a>供给侧结构性改革的必要性是什么？</h3><ol><li>适应把握引领经济发展新常态的重大创新;</li><li>适应国际金融危机发生后综合国力竞争新形势的主动选择;</li><li>推动我国经济实现高质量发展的必然要求。</li></ol><h3 id="如何办好人民满意的教育？"><a href="#如何办好人民满意的教育？" class="headerlink" title="如何办好人民满意的教育？"></a>如何办好人民满意的教育？</h3><ol><li>必须深化教育领域線合改革。</li><li>必须促进教育公平，必须建设高质量教育体系。</li><li>必须加强教师队伍建设。</li></ol><h3 id="怎样加快建设科技强国？"><a href="#怎样加快建设科技强国？" class="headerlink" title="怎样加快建设科技强国？"></a>怎样加快建设科技强国？</h3><ol><li>发挥新型举国体制优势。<br>健全新型举国体制，强化国家战路科技力量，优化配置创新资源，使我国在重要科技领域成为全球领跑者，在前沿交叉领域成为开拓者，力争尽早成为世界主要科学中心和创新高地。发挥新型举国体制优势，要坚特党对科技事业的集中统一领导。发挥新型举国体制优势，要全面推进科技体制改革。</li><li>打豪关键接心技术攻坚战。<br>只有把关键核心技术掌握在自己手中，才能从根本上保障国家经济安全，国防安全和其他安全。只有把关健核心技术掌握在自己手中，才能真正掌握竞争和发展的主动权。打赢关健按心技术攻坚战，首要任务是加快实现“卡脖子〞 关健核心技术突破。</li><li>增强自主创新能力。<br>增强自主创新能力，要者力推进基础研究。增强自主创新能力，要着力推动应用研究。增强自主创新能力，要著力推动前沿研究。中国特色社会主义新时代是决胜全面建成小康社会，进而全面建设社会主义现代化强国的时代。</li></ol><h3 id="全过程人民民主好在哪里？"><a href="#全过程人民民主好在哪里？" class="headerlink" title="全过程人民民主好在哪里？"></a>全过程人民民主好在哪里？</h3><ol><li>人民民主参与不断扩大。</li><li>国家治理高效，社会和谐稳定。</li><li>权力运用得到有效制约和监督。</li></ol><h3 id="中国特色社会主义法治道路的核心要义是什么？"><a href="#中国特色社会主义法治道路的核心要义是什么？" class="headerlink" title="中国特色社会主义法治道路的核心要义是什么？"></a>中国特色社会主义法治道路的核心要义是什么？</h3><ol><li>坚持党的领导。</li><li>坚持中国特色社会主义制度。</li><li>贯彻中国特色社会主义法治理论。</li></ol><h3 id="为什么要建设中国特色社会主义文化？"><a href="#为什么要建设中国特色社会主义文化？" class="headerlink" title="为什么要建设中国特色社会主义文化？"></a>为什么要建设中国特色社会主义文化？</h3><ol><li>文化是一个国家、一个民族的灵魂，</li><li>没有文化繁荣兴盛就没有中华民族伟大复兴;</li><li>更好满足人民日益增长的精神文化需要。</li></ol><h3 id="“脱贫攻坚精神”的内涵？"><a href="#“脱贫攻坚精神”的内涵？" class="headerlink" title="“脱贫攻坚精神”的内涵？"></a>“脱贫攻坚精神”的内涵？</h3><ol><li>上下同心、尽说出战；</li><li>精准务实、开拓创新；</li><li>攻坚克难、不负人民;</li></ol><h3 id="怎样推进社会治理现代化？"><a href="#怎样推进社会治理现代化？" class="headerlink" title="怎样推进社会治理现代化？"></a>怎样推进社会治理现代化？</h3><ol><li>坚持系统治理、综合治理、依法治理、源头治理。</li><li>健全党组织领导的自治、 法治、德洽相结合的城乡基层治理体系。</li><li>加强社会治安综合治理。</li></ol><h3 id="社会主义生态文明观的主要内容？"><a href="#社会主义生态文明观的主要内容？" class="headerlink" title="社会主义生态文明观的主要内容？"></a>社会主义生态文明观的主要内容？</h3><ol><li>坚持人与自然和谐共生。</li><li>绿水青山就是金山银山。</li><li>良好生态环境是最普惠的民生福社。</li><li>统筹山水林田湖草沙系统治理。</li><li>用最严格制度最严密法治保护生态环境。</li><li>共谋全球生态文明建设。</li></ol><h3 id="国家安全"><a href="#国家安全" class="headerlink" title="国家安全"></a>国家安全</h3><p>国家安全是指国家政权、主权、统一和领士完整、人民福祉、经济社会可持续发展，和国家其他重大利益相对处于没有危险和不受内外威助的状态，以及保障持续安全状态的能力。</p><h3 id="怎样坚持和完善，—国两制〞制度体系？"><a href="#怎样坚持和完善，—国两制〞制度体系？" class="headerlink" title="怎样坚持和完善，—国两制〞制度体系？"></a>怎样坚持和完善，—国两制〞制度体系？</h3><ol><li>必须依法治港治澳，维护宪法和基本法确定的宪制秩序;</li><li>坚守“—国”原则，尊重“两制”差异;</li><li>完善特别行政区同宪法和基本法实施相关的制度和机制;健全中央依照宪法和基本法对特别行政区行使全面管治权制度。</li></ol>]]></content>
      
      
      <categories>
          
          <category> Final Review </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Politics </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>期末复习-hadoop</title>
      <link href="/2023/07/07/%E6%9C%9F%E6%9C%AB%E5%A4%8D%E4%B9%A0-hadoop/"/>
      <url>/2023/07/07/%E6%9C%9F%E6%9C%AB%E5%A4%8D%E4%B9%A0-hadoop/</url>
      
        <content type="html"><![CDATA[<h1 id="Hadoop"><a href="#Hadoop" class="headerlink" title="Hadoop"></a>Hadoop</h1><h2 id="Hadoop基本概念"><a href="#Hadoop基本概念" class="headerlink" title="Hadoop基本概念"></a>Hadoop基本概念</h2><ol><li>奠定大数据技术的理论基石的Google公司的三篇论文包括：GFS、MapReduce、BigTable，被称为Google公司的“三驾马车”。分别对应了Hadoop的HDFS、MapReduce、Hbase。</li><li>Hadoop的运行模式包括：单机（本地）模式，伪分布式模式，完全分布式模式</li><li>Hadoop能够使用户轻松开发和运行处理大数据的应用程序，它的优点是：处理能力强，实现了高效性和高可靠性；在集群间分配数据，高扩展性；能够保存多个数据副本，高容错性。</li><li>机架感知机制：同时兼顾节点之间的通信速度和提高数据的容错能力。</li><li>虚拟机是一种虚拟化技术，它能够在现有的操作系统上运行一个或多个操作系统。</li><li>Hadoop的安装方式包括：单机模式，伪分布式模式和完全分布式模式三种。</li><li>集群是指一组相互独立的、通过高速网络互联的计算机，它们构成了一个组，并以单一系统的模式加以管理。</li><li>分布式系统是指将多台服务器集中在一起， 每台服务器都实现总体中的不同业务，做不同的事情。</li></ol><p>在linux的命令行输入：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">命令，能够启动所有Hadoop相关的服务进程。</span></span><br><span class="line">stop-all.sh</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">命令，能够单独启动HDFS服务。</span></span><br><span class="line">start-dfs.sh</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">查看在当前系统中启动了几个java进程的信息的</span></span><br><span class="line">jps</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">实现显示本机IP</span> </span><br><span class="line">ifconfig</span><br></pre></td></tr></table></figure><h2 id="HDFS功能"><a href="#HDFS功能" class="headerlink" title="HDFS功能"></a>HDFS功能</h2><ol><li>HDFS是基于流数据模式访问和处理超大文件的需求而开发的，具有高容错、高可靠性、高可扩展性、高吞吐率等特征，适合的读写任务是一次写入，多次读。</li><li>在HDFS中通过分块来实现数据的分布式存储功能，一个数据块会在多个此类节点中进行冗余备份。</li><li>NameNode是HDFS的管理节点，负责管理和维护HDFS的命名空间和管理DataNode上的数据块，它可以接受客户端的文件操作请求。所管理命名空间的信息文件有两个：fsimage和edits。</li><li>SecondaryNameNode，其主要职责是定期把NameNode上的fsimage和edits下载并合并生成新的fsimage。</li><li>在Hadoop2.2以上版本中，HDFS默认Block Size的大小是128m。</li><li>HDFS的缺点是：不适合处理低延迟的数据访问，不适合多用户写入及任意修改文件，不适合处理大量的小文件。</li><li>高可用性：是指通过在同一集群中运行两个NameNode的方式来防止由于单个NameNode故障引起的整个HDFS集群无法使用。</li><li>配额：是指可以设置HDFS在某个目录下文件数量与目录数量之和最大值。</li><li>联邦：是指在HDFS中有多个NameNode或NameSpace是联合的，相互独立，各自分工，管理自己的区域。</li><li>在core-site.xml修改fs.trash.interval选项来设置已删除文件在回收站中的保留时间。</li></ol><p>HDFS Shell命令</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">创建目录（文件夹）</span></span><br><span class="line">hdfs dfs -mkdir</span><br></pre></td></tr></table></figure><p>HDFS API</p><ul><li>getBlockSize：获得指定文件的数据块大小</li><li>getLength：实现返回文件长度</li></ul><h2 id="YARN的功能"><a href="#YARN的功能" class="headerlink" title="YARN的功能"></a>YARN的功能</h2><ol><li>Hadoop2.0相比较Hadoop1.0增加了YARN模块以实现对上层应用提供统一的资源管理和调度功能。</li><li>Container是YARN中的资源抽象，它封装了某个节点上的内存、CPU、磁盘、网络等多维度资源。</li><li>YARN提供先入先出调度器，容器调度器，公平调度器三种调度机制。</li></ol><h2 id="MapReduce的功能"><a href="#MapReduce的功能" class="headerlink" title="MapReduce的功能"></a>MapReduce的功能</h2><ol><li>MapReduce的特点：易于编程，分布式程序可以在大量廉价的PC上运行；良好的扩展性，可以通过增加集群中计算机数来提高计算能力；高容错性，当一台主机出故障计算任务可以转移到其他节点上。</li><li>MapReduce在对大数据的计算过程至少分为Map和Reduce两个部分。</li><li>MapReduce在Map步骤后对数据进行分区，排序，溢写，合并的步骤可以统称为 Shuffle 过程。Shuffle功能根据其功能和在MapReduce过程中的步骤，可以分为Map<br>Shuffle和Reduce Shuffle。</li><li>Hadoop的内置类型IntWritable用来定义整形数据，与Java的int类型对应。</li><li>Hadoop的内置类型 LongWritable 用来定义长整型型数据，与Java的long类型对应。</li><li>序列化是一种将内存中的Java对象转化为其他可存储文件或可跨计算机传输数据流的技术。</li><li>Hadoop序列化实现了org.apche.hadoop.io.Writable接口，其中包含write()和readFields()两个方法。</li><li>LineRecordReader 类实现了MapReduce从文本文件中逐行读取文本内容，生成&lt;Key,Value&gt;格式数据。</li><li>MapReduce通过分片对数据进行逻辑划分，在进行Map计算时所划分的处理数据对MapTask一一对应。所保存的HDFS的数据块（Block）与MapReduce所处理的数据切片（split）大小关系是相等、整数倍、几分之一的关系。</li><li>在Map阶段的分区步骤实现了根据Key值对数据进行划分，使其分配给对应ReduceTask。</li></ol><h2 id="简答题"><a href="#简答题" class="headerlink" title="简答题"></a>简答题</h2><ol><li>简述大数据理念的四个特征：<br/><br>数据体量大：大数据的数据量从 TB级别跃升到PB级别。<br/><br>数据类型多：大数据的数据类型包括前文提到的网络日志、视频、图片、地理位置信息等。<br/><br>处理速度快：1秒定律。这是大数据技术与传统数据挖掘技术的本质区别。<br/><br>价值密度低：以视频为例，在连续不间断的视频监控过程中，可能有用的数据仅仅有一两秒。</li><li>简述Hadoop对 Google公司三篇论文思想的实现的功能：<br/><br>HDFS是分布式文件系统，实现了分布式计算中数据存储管理功能，它是对GFS论文思想的实现。<br/><br>MapReduce是用于大规模数据集（大于1TB）的并行运算编程模型，它是对MapReduce论文思想的实现。<br/><br>HBase是一个分布式的、面向列的开源数据库。它是在Hadoop之上提供了类似于 BigTable的能力，是对BigTable论文思想的实现。</li><li>简述对HDFS进行访问和操作的三种方式：<br/><br>通过Web界面进行HDFS操作，使用浏览器访问HDFS对应IP端口为50070的页面对HDFS进行访问和操作。<br/><br>HDFS命令是由一系列类使用Linux<br>Shell的命令组成的，命令分为操作命令，管理命令和其他命令。可以通过Linux或远程控制段的命令行输入Shell名称来对HDFS进行访问和操作。<br/><br>Hadoop提供了多种HDFS的访问接口，Hadoop Java API位于“org.apache.hadoop.fs”包中，能够实现通过Java语言对HDFS进行文件操作和文件系统管理的访问功能。</li><li>简述HDFS的三个优点：<br/><br>处理超大文件：HDFS能够处理TB级甚至PB级的数据。<br/><br>支持流式数据访问：HDFS<br>设计建立在“一次写入，多次读取”的基础上，意味着一个数据集一旦生成，就会被复制分发到不同的存储节点，然后响应各种数据分析任务请求。<br/><br>低成本运行：HDFS可运行在低廉的商用硬件集群上。</li><li>简述MapReduce的四个特点：<br/><br>易于编程：用它的一些简单接口，就可以完成一个分布式程序，<br/><br>良好的扩展性：当计算资源不能得到满足的时候，可以通过简单地增加计算机来扩展它的计算能力。<br/><br>高容错性：一台主机出问题了，它可以把上面的计算任务转移到另外一个节点上运行，不至于使这个任务运行失败，而且这个过程不需要人工干预，完全由MapReduce在内部完成。<br/><br>能对PB级以上海量数据进行离线处理：MapReduce适合离线处理而不适合实时处理比如毫秒级别地返回一个结果，MapReduce很难做到。</li><li>简述Hadoop的三种安装模式：<br/><br>单机模式：指Hadoop运行在一台主机上，按默认配置以非分布式模式运行一个独的Java进程。单机模式是Hadoop的默认模式。<br/><br>伪分布式模式：指Hadoop运行在一台主机上，使用多个Java进程，模仿完全分布式的各类节点。伪分布式模式具备完全分布式的所有功能，常用调试程序。<br/><br>完全分布式模式：也叫集群模式，是将 Hadoop运行在多台主机中，各个主机按照相关配置运行相立的Hadoop守护进程。完全分布式模式是真正的分布式环境，可用于实际的生产环境。</li></ol><h2 id="易错概念"><a href="#易错概念" class="headerlink" title="易错概念"></a>易错概念</h2><ol><li>Hadoop是Java开发的，所以 MapReduce只支持Java语言编写。</li><li>Mapreduce的input split就是一个block。</li><li>客户端上传的数据首先发送给NameNode，根据NameNode所管理的DataNode的分工再逐个发送给DataNode。</li><li>为了实现环形缓冲区功能，Hadoop需要配置特殊结构的环形内存芯片。</li><li>MapReduce是Java语言开发的，因此其数据类型也沿用了Java的数据类型。</li><li>如果NameNode意外终止，SecondaryNameNode会接替它使集群继续工作。</li><li>为了保证数据的稳定性，数据切片（Split）的大小必须是数据块（block）的一样大。</li><li>高可用性HA通过在一个集群中同时处于Active状态的两个NameNode来保证HDFS能够正常运行。</li><li>数据块的大小（BlockSize）是不可以修改的。</li><li>在MapReduce计算中为了提高数据计算速度，当单个MapTask完成后数据会直接被拉取到Reduce阶段进行后续计算。</li><li>由于会出现相同的Key在不同的ReduceTask进行统计的情况，因此在Reduce阶段最后需要对所有节点所生成所有文件进行合并。</li></ol><h2 id="HDFS-Shell命令操作"><a href="#HDFS-Shell命令操作" class="headerlink" title="HDFS Shell命令操作"></a>HDFS Shell命令操作</h2><ol><li>在HDFS的根目录中上创建一个目录结构，为<code>new/folder</code><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hdfs dfs -mkdir -p /new/folder</span><br></pre></td></tr></table></figure></li><li>在HDFS根目录的<code>new</code>目录中创建文件<code>1.txt</code><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hdfs dfs -touchz /new/1.txt</span><br></pre></td></tr></table></figure></li><li>将用户目录下的<code>context.txt</code>内容追加到HDFS文件<code>/new/1.txt</code>中<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hdfs dfs -appendToFile context.txt /new/1.txt</span><br></pre></td></tr></table></figure></li><li>查看HDFS文件<code>/new/1.txt</code>的文件内容<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hdfs dfs -cat /new/1.txt</span><br></pre></td></tr></table></figure></li><li>查看HDFS文件目录<code>/new</code>所占的磁盘空间大小<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hdfs dfs -du /new</span><br></pre></td></tr></table></figure></li><li>删除HDFS文件目录<code>/new</code><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hdfs dfs -rm /new</span><br></pre></td></tr></table></figure></li><li>在HDFS的根目录中上创建一个目录结构，为<code>dir1/dir2/dir3</code><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hdfs dfs -mkdir -p /dirl/dir2/dir3</span><br></pre></td></tr></table></figure></li><li>将Linux用户根目录中的文件<code>localFile.txt</code>复制到HDFS根目录中保存为<code>hdfsFile.txt</code><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hdfs dfs -copyFromLocal localFile.txt /hdfsFile.txt</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hdfs dfs -put localFile.txt /hdfsFile.txt</span><br></pre></td></tr></table></figure></li><li>显示HDFS中级联列出根目录下的所有目录和文件<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hdfs dfs -ls -R /</span><br></pre></td></tr></table></figure></li><li>在HDFS根目录<code>dir1</code>目录中创建文件<code>1.txt</code>   <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hdfs dfs -touchz /dir1/1.txt</span><br></pre></td></tr></table></figure></li><li>将用户目录下的<code>code2.txt</code>内容追加到HDFS文件<code>/dir1/1.txt</code>中   <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hdfs dfs -appendToFile code2.txt /dir1/1.txt</span><br></pre></td></tr></table></figure></li><li>将dir1目录中创建文件<code>1.txt</code>下载到Linux的本地根目录中，保存为文件<code>downloadFile.txt</code>   <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hdfs dfs -copyToLocal / dir1/1.txt downloadFile.txt</span><br></pre></td></tr></table></figure>   <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hdfs dfs -get /dir1/1.txt downloadFile.txt</span><br></pre></td></tr></table></figure></li></ol><h3 id="HDFS-API编程"><a href="#HDFS-API编程" class="headerlink" title="HDFS API编程"></a>HDFS API编程</h3><ol><li><p>已知HDFS的IP地址为<code>192.168.44.128</code>，访问端口为<code>9000</code>，用户名为<code>admin</code>。编程实现调用<code>FileSystem</code><br>类自带的<code>copyFromLocalFile</code>方法上传Linux系统中本地文件<code>/home/admin/upload.txt</code>到HDFS文件夹<code>/user/admin/</code><br>中保存为文件<code>1.txt</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> Exam;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.net.URI;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.conf.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.fs.FileSystem;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.fs.Path;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">App</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">URI</span> <span class="variable">uri</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">URI</span>(<span class="string">&quot;hdfs://192.168.44.128:9000&quot;</span>);</span><br><span class="line">        <span class="type">Configuration</span> <span class="variable">conf</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Configuration</span>();</span><br><span class="line">        <span class="type">FileSystem</span> <span class="variable">fs</span> <span class="operator">=</span> FileSystem.get(uri, conf, <span class="string">&quot;admin&quot;</span>);</span><br><span class="line">        <span class="type">Path</span> <span class="variable">src</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Path</span>(<span class="string">&quot;/home/admin/upload.txt&quot;</span>);</span><br><span class="line">        <span class="type">Path</span> <span class="variable">dst</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Path</span>(<span class="string">&quot;/user/admin/1.txt&quot;</span>);</span><br><span class="line">        fs.copyFromLocalFile(src, dst);</span><br><span class="line">        fs.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>已知HDFS的IP地址为<code>192.168.44.128</code>，访问端口为<code>9000</code>，用户名为<code>admin</code>。编程实现调用<code>FileSystem</code>类自带的<code>copyToLocalFile</code><br>方法下载HDFS文件夹<code>/user/admin/</code>中文件<code>1.txt</code>到Linux系统中本地目录<code>/home/admin/</code>保存为<code>download.txt</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> Exam;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.net.URI;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.conf.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.fs.FileSystem;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.fs.Path;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">App</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">URI</span> <span class="variable">uri</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">URI</span>(<span class="string">&quot;hdfs://192.168.44.128:9000&quot;</span>);</span><br><span class="line">        <span class="type">Configuration</span> <span class="variable">conf</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Configuration</span>();</span><br><span class="line">        <span class="type">FileSystem</span> <span class="variable">fs</span> <span class="operator">=</span> FileSystem.get(uri, conf, <span class="string">&quot;admin&quot;</span>);</span><br><span class="line">        <span class="type">Path</span> <span class="variable">src</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Path</span>(<span class="string">&quot;/user/admin/1.txt&quot;</span>);</span><br><span class="line">        <span class="type">Path</span> <span class="variable">dst</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Path</span>(<span class="string">&quot;/home/admin/download.txt&quot;</span>);</span><br><span class="line">        fs.copyToLocalFile(src, dst);</span><br><span class="line">        fs.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><h2 id="MapReduce程序设计题"><a href="#MapReduce程序设计题" class="headerlink" title="MapReduce程序设计题"></a>MapReduce程序设计题</h2><h3 id="练习1"><a href="#练习1" class="headerlink" title="练习1"></a>练习1</h3><p>在某企业管理系统的数据库中所保存员工信息表EMP的结构如下所示：</p><table><thead><tr><th>EMPNO</th><th>ENAME</th><th>JOB</th><th>MGR</th><th>HIREDATE</th><th>SAL</th><th>COMM</th><th>DEPTNO</th></tr></thead><tbody><tr><td>3641</td><td>石金泉</td><td>管理</td><td>0001</td><td>2009&#x2F;3&#x2F;4</td><td>20000</td><td>50000</td><td>1</td></tr><tr><td>6984</td><td>高丽</td><td>行政</td><td>5684</td><td>2009&#x2F;3&#x2F;7</td><td>3500</td><td>4000</td><td>1</td></tr><tr><td>7397</td><td>门亮</td><td>开发</td><td>7396</td><td>2009&#x2F;5&#x2F;11</td><td>10000</td><td>25000</td><td>2</td></tr><tr><td>7398</td><td>李贺</td><td>开发</td><td>7396</td><td>2009&#x2F;9&#x2F;22</td><td>10000</td><td>25000</td><td>2</td></tr><tr><td>8049</td><td>李加里</td><td>销售</td><td>3641</td><td>2009&#x2F;3&#x2F;21</td><td>8000</td><td>50000</td><td>3</td></tr><tr><td>8331</td><td>孙立宪</td><td>销售</td><td>8049</td><td>2009&#x2F;4&#x2F;29</td><td>6000</td><td>40000</td><td>3</td></tr><tr><td>9486</td><td>李明礼</td><td>生产</td><td>3641</td><td>2009&#x2F;3&#x2F;25</td><td>7000</td><td>9000</td><td>4</td></tr><tr><td>9696</td><td>张顺涛</td><td>生产</td><td>9486</td><td>2009&#x2F;4&#x2F;20</td><td>4000</td><td>5000</td><td>4</td></tr></tbody></table><p>其中表中各字段代表的含义：</p><table><thead><tr><th>字段</th><th>含义</th></tr></thead><tbody><tr><td>EMPNO</td><td>员工号</td></tr><tr><td>ENAME</td><td>员工姓名</td></tr><tr><td>JOB</td><td>岗位</td></tr><tr><td>MGR</td><td>直属领导</td></tr><tr><td>HIREDATE</td><td>雇佣时间</td></tr><tr><td>SAL</td><td>月薪</td></tr><tr><td>COMM</td><td>奖金</td></tr><tr><td>DEPTNO</td><td>部门号</td></tr></tbody></table><p>将数据从数据库中导出，保存为文件emp.csv以作为统计每个部门员工月薪总额的基础数据，文件其内容为：</p><blockquote><p>3641,石金泉,管理,0001,2009&#x2F;3&#x2F;4,20000,50000,1</p><p>6984,高丽,行政,5684,2009&#x2F;3&#x2F;7,3500,4000,1</p><p>7397,门亮,开发,7396,2009&#x2F;5&#x2F;11,10000,25000,2</p><p>7398,李贺,开发,7396,2009&#x2F;9&#x2F;22,10000,25000,2</p><p>8049,李加里,销售,3641,2009&#x2F;3&#x2F;21,8000,50000,3</p><p>8331,孙立宪,销售,8049,2009&#x2F;4&#x2F;29,6000,40000,3</p><p>9486,李明礼,生产,3641,2009&#x2F;3&#x2F;25,7000,9000,4</p><p>9696,张顺涛,生产,9486,2009&#x2F;4&#x2F;20,4000,5000,4</p></blockquote><p>将<code>emp.csv</code>上传到HDFS目录<code>hdfs://192.168.44.128:9000/user/input/</code></p><p>以MapReduce方式实现根据<code>emp.csv</code>中所包含的员工信息统计部门月薪总额的功能，以文字的方式分析求每个部门月工资总额数据的Map和Reduce步骤各完成的功能以及输入，输出数据类型。<br>根据注释描述分别填写Main类，Map类和Reduce类对应java代码。要求将计算的结果保存在HDFS目录<code>hdfs://192.168.44.128:9000/user/output/</code><br>中</p><h4 id="程序分析"><a href="#程序分析" class="headerlink" title="程序分析"></a>程序分析</h4><p>Map阶段输入类型为<code>Key LongWritable : Value Text</code>分别表示文本偏移量，当前行员工的信息</p><p>Map所实现的功能是根据逗号从当前行文本内容中提取出当前员工的部门编号和月薪</p><p>输出<code>key IntWritable : Value IntWritable</code>分别表示部门编号，当前行员工的月薪</p><p>Reduce阶段输入类型<code>Key IntWritable : Value IntWritable</code>分别表示部门编号，当前部门的员工月薪集合</p><p>Reduce所实现的功能是将当前部门的所有员工月薪进行累加得到整个部门的月薪总额</p><p>输出<code>Key IntWritable : Value IntWritable</code>分别表示部门编号，当前部门的月薪总额</p><h4 id="程序"><a href="#程序" class="headerlink" title="程序"></a>程序</h4><ol><li><p>ExamMapper Class</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> MapReduceExam1;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.io.IntWritable;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.io.LongWritable;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.io.Text;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapreduce.Mapper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ExamMapper</span> <span class="keyword">extends</span> <span class="title class_">Mapper</span>&lt;LongWritable, Text, IntWritable, IntWritable&gt; &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">map</span><span class="params">(LongWritable key1, Text value1, Context context)</span></span><br><span class="line">            <span class="keyword">throws</span> IOException, InterruptedException &#123;</span><br><span class="line">        <span class="comment">// 读取的一行文本内容</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">data</span> <span class="operator">=</span> value1.toString();</span><br><span class="line">        <span class="comment">// 将字符串以逗号为标记点进行分割</span></span><br><span class="line">        String[] words = data.split(<span class="string">&quot;,&quot;</span>);</span><br><span class="line">        <span class="comment">// 输出&lt; key,Value &gt;</span></span><br><span class="line">        context.write(<span class="keyword">new</span> <span class="title class_">IntWritable</span>(Integer.parseInt(words[<span class="number">7</span>])), <span class="keyword">new</span> <span class="title class_">IntWritable</span>(Integer.parseInt(words[<span class="number">5</span>])));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>ExamReducer Class</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> MapReduceExam1;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.io.IntWritable;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapreduce.Reducer;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ExamReducer</span> <span class="keyword">extends</span> <span class="title class_">Reducer</span>&lt;IntWritable, IntWritable, IntWritable, IntWritable&gt; &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">reduce</span><span class="params">(IntWritable key3, Iterable&lt;IntWritable&gt; value3, Context context)</span></span><br><span class="line">            <span class="keyword">throws</span> IOException, InterruptedException &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">total</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (IntWritable value : value3) &#123;</span><br><span class="line">            total += value.get();</span><br><span class="line">        &#125;</span><br><span class="line">        context.write(key3, <span class="keyword">new</span> <span class="title class_">IntWritable</span>(total));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>ExamMain Class</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> MapReduceExam1;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.conf.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.fs.Path;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.io.IntWritable;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapreduce.Job;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapreduce.lib.input.FileInputFormat;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapreduce.lib.output.FileOutputFormat;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ExamMain</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">Job</span> <span class="variable">job</span> <span class="operator">=</span> Job.getInstance(<span class="keyword">new</span> <span class="title class_">Configuration</span>());</span><br><span class="line">        <span class="comment">// 设置Client的类</span></span><br><span class="line">        job.setJarByClass(ExamMain.class);</span><br><span class="line">        <span class="comment">// 设置Map的类和输入类型</span></span><br><span class="line">        job.setMapperClass(ExamMapper.class);</span><br><span class="line">        job.setMapOutputKeyClass(IntWritable.class);</span><br><span class="line">        job.setMapOutputValueClass(IntWritable.class);</span><br><span class="line">        <span class="comment">// 设置reduce的类和输入类型</span></span><br><span class="line">        job.setReducerClass(ExamReducer.class);</span><br><span class="line">        job.setOutputKeyClass(IntWritable.class);</span><br><span class="line">        job.setOutputValueClass(IntWritable.class);</span><br><span class="line"></span><br><span class="line">        FileInputFormat.setInputPaths(job, <span class="keyword">new</span> <span class="title class_">Path</span>(<span class="string">&quot;hdfs://192.168.44.128:9000/user/input/Employee/EMP.csv&quot;</span>));</span><br><span class="line">        FileOutputFormat.setOutputPath(job, <span class="keyword">new</span> <span class="title class_">Path</span>(<span class="string">&quot;hdfs://192.168.44.128:9000/user/output/SalaryTotal&quot;</span>));</span><br><span class="line">        job.waitForCompletion(<span class="literal">true</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><h3 id="练习1-1"><a href="#练习1-1" class="headerlink" title="练习1"></a>练习1</h3><p>在某图书馆图书管理系统的数据库中所保存图书信息表BookInfo的结构如下所示：</p><table><thead><tr><th>BOOKID</th><th>BNAME</th><th>ROOM</th><th>TYPE</th><th>DATE</th><th>PRICE</th></tr></thead><tbody><tr><td>0001</td><td>老人与海</td><td>1</td><td>文学</td><td>2009&#x2F;3&#x2F;4</td><td>35</td></tr><tr><td>0002</td><td>时尚杂志</td><td>2</td><td>期刊杂志</td><td>2009&#x2F;3&#x2F;7</td><td>20</td></tr><tr><td>0003</td><td>C语言</td><td>3</td><td>计算机</td><td>2009&#x2F;5&#x2F;11</td><td>32</td></tr><tr><td>0004</td><td>红楼梦</td><td>1</td><td>文学</td><td>2009&#x2F;9&#x2F;22</td><td>50</td></tr><tr><td>0005</td><td>JAVA开发</td><td>3</td><td>计算机</td><td>2009&#x2F;3&#x2F;21</td><td>24</td></tr><tr><td>0006</td><td>计算机基础</td><td>3</td><td>计算机</td><td>2009&#x2F;4&#x2F;29</td><td>25</td></tr><tr><td>0007</td><td>西游记</td><td>1</td><td>文学</td><td>2009&#x2F;3&#x2F;25</td><td>40</td></tr><tr><td>0008</td><td>读者文摘</td><td>2</td><td>期刊杂志</td><td>2009&#x2F;4&#x2F;20</td><td>8</td></tr></tbody></table><p>其中表中各字段代表的含义：</p><table><thead><tr><th>字段</th><th>含义</th></tr></thead><tbody><tr><td>BOOKID</td><td>图书编号</td></tr><tr><td>BNAME</td><td>书名</td></tr><tr><td>ROOM</td><td>所在房间</td></tr><tr><td>TYPE</td><td>图书类型</td></tr><tr><td>DATE</td><td>购入时间</td></tr><tr><td>PRICE</td><td>价格</td></tr></tbody></table><p>将数据从数据库中导出，保存为文件book.csv以作为统计每类图书总价格的基础数据，文件其内容为：</p><blockquote><p>0001,老人与海,1,文学,2009&#x2F;3&#x2F;4,35</p><p>0002,时尚杂志,2,期刊杂志,2009&#x2F;3&#x2F;7,20</p><p>0003,C语言,3 计算机,2009&#x2F;5&#x2F;11,32</p><p>0004,红楼梦,1,文学,2009&#x2F;9&#x2F;22,50</p><p>0005,JAVA开发,3,计算机,2009&#x2F;3&#x2F;21,24</p><p>0006,计算机基础,3,计算机,2009&#x2F;4&#x2F;29,25</p><p>0007,西游记,1,文学,2009&#x2F;3&#x2F;25,40</p><p>0008,读者文摘,2,期刊杂志,2009&#x2F;4&#x2F;20,8</p></blockquote><p>将<code>book.csv</code>上传到HDFS目录<code>hdfs://192.168.44.128:9000/user/input/</code><br>以MapReduce方式实现根据book.csv中所包含的图书信息统计每类图书的总价格的功能，以文字的方式分析求每大类图书价格的Map和Reduce步骤各完成的功能以及输入，输出数据类型。根据注释描述分别填写Main类，Map类和Reduce类对应java代码。要求将计算的结果保存在HDFS目录<code>hdfs://192.168.44.128:9000/user/output/</code><br>中。</p><h4 id="程序分析-1"><a href="#程序分析-1" class="headerlink" title="程序分析"></a>程序分析</h4><p>Map阶段输入类型为<code>Key LongWritable : Value Text</code>分别表示文本偏移量，当前行图书的信息</p><p>Map所实现的功能是根据逗号从当前行文本内容中提取出当前图书的类型和价格</p><p>输出<code>key Text : Value IntWritable</code>分别表示当前行图书的类型和价格</p><p>Reduce阶段输入类型为<code>key Text : Value IntWritable</code>分别表示当前行图书的类型，当前类所有图书的价格集合</p><p>Reduce所实现的功能是将当前类型的所有图书价格进行累加得的价格总额</p><p>输出<code>key Text : Value IntWritable</code>分别表示图书类型，当前类型图书的价格总额</p><h4 id="程序-1"><a href="#程序-1" class="headerlink" title="程序"></a>程序</h4><ol><li>ExamMapper Class<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> MapReduceExam2;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.io.IntWritable;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.io.LongWritable;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.io.Text;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapreduce.Mapper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ExamMapper</span> <span class="keyword">extends</span> <span class="title class_">Mapper</span>&lt;LongWritable, Text, Text, IntWritable&gt; &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">map</span><span class="params">(LongWritable key1, Text value1, Context context)</span> <span class="keyword">throws</span> IOException, InterruptedException &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">data</span> <span class="operator">=</span> value1.toString();</span><br><span class="line">        <span class="comment">// 将字符串以逗号为标记点进行分割，保存如字符串数组中</span></span><br><span class="line">        String[] words = data.split(<span class="string">&quot;,&quot;</span>);</span><br><span class="line">        context.write(<span class="keyword">new</span> <span class="title class_">Text</span>(words[<span class="number">3</span>]), <span class="keyword">new</span> <span class="title class_">IntWritable</span>(Integer.parseInt(words[<span class="number">5</span>])));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li>ExamReducer Class<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> MapReduceExam2;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.io.IntWritable;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.io.Text;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapreduce.Reducer;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ExamReducer</span> <span class="keyword">extends</span> <span class="title class_">Reducer</span>&lt;Text, IntWritable, Text, IntWritable&gt; &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">reduce</span><span class="params">(Text key3, Iterable&lt;IntWritable&gt; value3, Context context)</span></span><br><span class="line">            <span class="keyword">throws</span> IOException, InterruptedException &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">total</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (IntWritable value : value3) &#123;</span><br><span class="line">            total += value.get();</span><br><span class="line">        &#125;</span><br><span class="line">        context.write(key3, <span class="keyword">new</span> <span class="title class_">IntWritable</span>(total));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li>ExamMain Class<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> MapReduceExam2;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.conf.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.fs.Path;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.io.IntWritable;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.io.Text;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapreduce.Job;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapreduce.lib.input.FileInputFormat;</span><br><span class="line"><span class="keyword">import</span> org.apache.hadoop.mapreduce.lib.output.FileOutputFormat;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ExamMain</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="comment">// 创建一个job作业实例</span></span><br><span class="line">        <span class="type">Job</span> <span class="variable">job</span> <span class="operator">=</span> Job.getInstance(<span class="keyword">new</span> <span class="title class_">Configuration</span>());</span><br><span class="line">        <span class="comment">// 设置作业的启动类</span></span><br><span class="line">        job.setJarByClass(ExamMain.class);</span><br><span class="line">        <span class="comment">// 设置Map的类和输入类型</span></span><br><span class="line">        job.setMapperClass(ExamMapper.class);</span><br><span class="line">        job.setMapOutputKeyClass(Text.class);</span><br><span class="line">        job.setMapOutputValueClass(IntWritable.class);</span><br><span class="line">        <span class="comment">// 设置reduce的类和输入类型</span></span><br><span class="line">        job.setReducerClass(ExamReducer.class);</span><br><span class="line">        job.setOutputKeyClass(Text.class);</span><br><span class="line">        job.setOutputValueClass(IntWritable.class);</span><br><span class="line"></span><br><span class="line">        FileInputFormat.setInputPaths(job, <span class="keyword">new</span> <span class="title class_">Path</span>(<span class="string">&quot;hdfs://192.168.44.128:9000/ExamData/book.csv&quot;</span>));</span><br><span class="line">        FileOutputFormat.setOutputPath(job, <span class="keyword">new</span> <span class="title class_">Path</span>(<span class="string">&quot;hdfs://192.168.44.128:9000/ExamOutput/&quot;</span>));</span><br><span class="line">        job.waitForCompletion(<span class="literal">true</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol>]]></content>
      
      
      <categories>
          
          <category> Final Review </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Hadoop </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>关于ChatGPT的tokens收费标准</title>
      <link href="/2023/07/07/About-GPT-Token/"/>
      <url>/2023/07/07/About-GPT-Token/</url>
      
        <content type="html"><![CDATA[<h1 id="关于ChatGPT的tokens收费标准"><a href="#关于ChatGPT的tokens收费标准" class="headerlink" title="关于ChatGPT的tokens收费标准"></a>关于ChatGPT的tokens收费标准</h1><p>根据OpenAI官网给出的<a href="https://openai.com/pricing">计费标准</a></p><p>总结了以下表格：</p><table><thead><tr><th>模型</th><th>最大长度</th><th>输入（&#x2F;1k tokens）</th><th>输出（1k tokens）</th><th>使用价格</th><th>类型</th></tr></thead><tbody><tr><td>GPT-4</td><td>8K</td><td>$0.03</td><td>$0.06</td><td></td><td>语言模型</td></tr><tr><td>GPT-4</td><td>32K</td><td>$0.06</td><td>$0.12</td><td></td><td>语言模型</td></tr><tr><td>GPT-3.5 Turbo</td><td>4K</td><td>$0.0015</td><td>$0.002</td><td></td><td>语言模型</td></tr><tr><td>GPT-3.5 Turbo</td><td>16K</td><td>$0.003</td><td>$0.004</td><td></td><td>语言模型</td></tr><tr><td>Ada</td><td></td><td>$0.0004</td><td>$0.0016</td><td></td><td>微调模型</td></tr><tr><td>Babbage</td><td></td><td>$0.0006</td><td>$0.0024</td><td></td><td>微调模型</td></tr><tr><td>Curie</td><td></td><td>$0.0030</td><td>$0.012</td><td></td><td>微调模型</td></tr><tr><td>Davinci</td><td></td><td>$0.0300</td><td>$0.12</td><td></td><td>微调模型</td></tr><tr><td>Ada v2</td><td>Ada v2</td><td></td><td></td><td>$0.0001&#x2F;1K tokens</td><td>嵌入模型</td></tr><tr><td>Image models</td><td>1024×1024</td><td></td><td></td><td>$0.020&#x2F;image</td><td>图像模型</td></tr><tr><td>Image models</td><td>512×512</td><td></td><td></td><td>$0.018&#x2F;image</td><td>图像模型</td></tr><tr><td>Image models</td><td>256×256</td><td></td><td></td><td>$0.016&#x2F;image</td><td>图像模型</td></tr><tr><td>Whisper</td><td></td><td></td><td></td><td>$0.006&#x2F;min</td><td>音频模型</td></tr></tbody></table><blockquote><p>事实上，OpenAI推出的模型不只这些，通过api可以得到最完整的模型列表。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">curl https://api.openai.com/v1/models \</span><br><span class="line">-H &quot;Authorization: Bearer $OPENAI_API_KEY&quot;</span><br></pre></td></tr></table></figure><p>如果没有key或者不想发送请求可以直接获取下面的json数据都是一样的</p><p>截止2023年7月7日全部模型的json数据：</p><div class="link-group"><div class="tagLink"><a class="link-card" no-pjax target="_blank" title="openai_models.json" href="/citation/openai_models.json"><span class="link-card-backdrop" style="background-image: url(https://cdn.pixabay.com/photo/2018/12/05/13/41/panda-3857754__340.jpg)"></span><div class="left"><img src="https://img.51miz.com/Element/00/37/79/59/10df0417_E377959_b7bb9dfa.png" class="lazyload placeholder" data-srcset="https://img.51miz.com/Element/00/37/79/59/10df0417_E377959_b7bb9dfa.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div><div class="right"><p class="text">openai_models.json</p><p class="url">/citation/openai_models.json</p></div></a></div></div></blockquote><h2 id="Tokens"><a href="#Tokens" class="headerlink" title="Tokens"></a>Tokens</h2><p>上述内容中多次提到了tokens的概念，什么是tokens？</p><blockquote><p>您可以将标记视为用于自然语言处理的单词片段。对于英文文本，1 个标记大约为 4 个字符或 0.75 个单词。作为参考，莎士比亚的作品集大约有<br>90 万字或 120 万个符号。</p><p><code>1000</code>tokens约等于<code>750</code>个单词</p><p>要了解有关代币如何工作并估计您的使用情况的更多信息……</p><ul><li>使用我们的交互式 <a href="https://platform.openai.com/tokenizer">分词器工具</a>进行实验。</li><li>登录您的帐户并在 Playground 中输入文本。页脚中的计数器将显示文本中有多少个标记。</li></ul></blockquote><p>根据OpenAI官方给出的回答还是无法有一个具体的掌握。</p><p>转换为中文，tokens的大小为多少？</p><p>使用gpt-3.5-turbo-0301为例：</p><table><thead><tr><th>Request content</th><th>Response content</th><th>input tokens</th><th>output tokens</th><th>total</th></tr></thead><tbody><tr><td>Say this is a test!</td><td>This is a test!</td><td>13</td><td>5</td><td>18</td></tr><tr><td>请形容一下小猫</td><td>小猫是一种可爱的小动物，通常体型娇小，毛发柔软。它们的眼睛大而明亮，透露出一种天真无邪的神采。小猫的耳朵尖尖，灵敏而警觉，时刻捕捉着周围的声音。它们的小鼻子粉嫩可爱，鼻尖微微动着，好奇地探索着周围的世界。小猫的爪子尖锐而灵活，能够轻松攀爬和抓捕猎物。它们的尾巴修长而灵动，时而垂下，时而竖起，表达出各种情绪。小猫的身体柔软而灵活，它们经常会摆出各种可爱的姿势，让人看了心情愉悦。总之，小猫是一种令人陶醉的可爱生物，它们的存在让人感到温暖和幸福。</td><td>16</td><td>319</td><td>335</td></tr><tr><td>请翻译：This technical report presents GPT-4, a large multimodal model capable of processing image and text inputs and producing text outputs. Such models are an important area of study as they have the potential to be used in a wide range of applications, such as dialogue systems, text summarization, and machine translation. As such, they have been the subject of substantial interest and progress in recent years.</td><td>这份技术报告介绍了GPT-4，一个能够处理图像和文本输入并生成文本输出的大型多模态模型。这样的模型是研究的重要领域，因为它们有潜力在各种应用中使用，如对话系统、文本摘要和机器翻译。因此，近年来它们受到了广泛关注和进展的研究对象。</td><td>93</td><td>127</td><td>220</td></tr></tbody></table><p>经过计算得出，1字约等于1token，英文状态4个字符约等于1token。</p><blockquote><p>假设：我现在有一篇论文要写，需求（input content）输入了100字，需要生成一篇5000字的论文（output<br>content），算上中间的润色和修改（约等于重复3遍），那么可以计算写一篇论文大约会消耗tokens &#x3D; ((100 + 5000) * 5) &#x3D; 25500</p><p>使用GPT-3.5，费用为 0.03825美元 约等于 0.277人民币，<br>如果内容总长度超过4096k，那么价格会翻一倍，费用为 0.0765美元 约等于 0.5534人民币（汇率为1美元兑7.2337人民币）</p><p>使用GPT-4，费用为 0.765美元 约等于 5.534人民币</p><p>当然这只是猜测。</p></blockquote><h2 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h2><p>使用gpt-3.5-turbo-16k与gpt-3.5-turbo-4k（并未写完一篇论文）：：</p><div class="link-group"><div class="tagLink"><a class="link-card" no-pjax target="_blank" title="gpt-3.5-turbo-16k.html" href="/citation/gpt-3.5-turbo-16k.html"><span class="link-card-backdrop" style="background-image: url(https://cdn.pixabay.com/photo/2018/12/05/13/41/panda-3857754__340.jpg)"></span><div class="left"><img src="https://img.51miz.com/Element/00/37/79/59/10df0417_E377959_b7bb9dfa.png" class="lazyload placeholder" data-srcset="https://img.51miz.com/Element/00/37/79/59/10df0417_E377959_b7bb9dfa.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div><div class="right"><p class="text">gpt-3.5-turbo-16k.html</p><p class="url">/citation/gpt-3.5-turbo-16k.html</p></div></a></div><div class="tagLink"><a class="link-card" no-pjax target="_blank" title="gpt-3.5-turbo-4k.html" href="/citation/gpt-3.5-turbo-4k.html"><span class="link-card-backdrop" style="background-image: url(https://cdn.pixabay.com/photo/2018/12/05/13/41/panda-3857754__340.jpg)"></span><div class="left"><img src="https://img.51miz.com/Element/00/37/79/59/10df0417_E377959_b7bb9dfa.png" class="lazyload placeholder" data-srcset="https://img.51miz.com/Element/00/37/79/59/10df0417_E377959_b7bb9dfa.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div><div class="right"><p class="text">gpt-3.5-turbo-4k.html</p><p class="url">/citation/gpt-3.5-turbo-4k.html</p></div></a></div></div><p>整理好的论文（字数：7479）：</p><div class="link-group"><div class="tagLink"><a class="link-card" no-pjax target="_blank" title="习近平新时代.pdf" href="/citation/习近平新时代.pdf"><span class="link-card-backdrop" style="background-image: url(https://cdn.pixabay.com/photo/2018/12/05/13/41/panda-3857754__340.jpg)"></span><div class="left"><img src="https://img.51miz.com/Element/00/37/79/59/10df0417_E377959_b7bb9dfa.png" class="lazyload placeholder" data-srcset="https://img.51miz.com/Element/00/37/79/59/10df0417_E377959_b7bb9dfa.png" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div><div class="right"><p class="text">习近平新时代.pdf</p><p class="url">/citation/习近平新时代.pdf</p></div></a></div></div><p>根据最后的返回<code>Total tokens spent: 52087</code>可以得出本次论文一共花费了<code>52087/1000*0.003*7.2337=1.1303451957¥</code>花费1.13人民币。</p><h2 id="总结与思考"><a href="#总结与思考" class="headerlink" title="总结与思考"></a>总结与思考</h2><p>为什么会与预测的花费不一致？</p><ol><li>示例中生成的文章为7000+</li><li>采用的是gpt对话的形式，也就是说每一次对话都需要把本次对话中的上文全部当作前置传入，这样就增加了tokens的消耗</li><li>输入与输出的tokens的价格并不相等，输出的tokens更贵一些</li></ol>]]></content>
      
      
      <categories>
          
          <category> Pointless small talk </category>
          
      </categories>
      
      
        <tags>
            
            <tag> GPT </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>期末复习-数据库原理</title>
      <link href="/2023/07/06/%E6%9C%9F%E6%9C%AB%E5%A4%8D%E4%B9%A0-%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86/"/>
      <url>/2023/07/06/%E6%9C%9F%E6%9C%AB%E5%A4%8D%E4%B9%A0-%E6%95%B0%E6%8D%AE%E5%BA%93%E5%8E%9F%E7%90%86/</url>
      
        <content type="html"><![CDATA[<h2 id="相关"><a href="#相关" class="headerlink" title="相关"></a>相关</h2><p>具体考些什么我也不太记得，有关系代数、sql语言、E-R图，其余的不太清楚了。</p><h2 id="关系代数"><a href="#关系代数" class="headerlink" title="关系代数"></a>关系代数</h2><h3 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h3><p>关系代数是一种数学工具和查询语言，用于处理和操作关系型数据库中的关系数据。它提供了一组操作符，用于对关系进行操作和组合，以获取所需的数据结果。</p><p>关系代数的基本操作符包括：</p><ol><li>选择（Selection）：根据指定的条件从关系中选择满足条件的元组。</li><li>投影（Projection）：从关系中选择指定的属性列，生成一个新的关系。</li><li>连接（Join）：将两个关系根据共享的属性列合并成一个新的关系。</li><li>交（Intersection）：获取两个关系的交集，即共有的元组。</li><li>并（Union）：获取两个关系的并集，即合并两个关系的元组，去除重复项。</li><li>差（Difference）：获取一个关系中有而另一个关系中没有的元组。</li><li>除（Division）：根据指定条件从一个关系中选择满足条件的元组，然后从另一个关系中选择与前一步结果关系中的所有元组匹配的元组。</li></ol><p>通过组合和嵌套这些基本操作符，可以进行更复杂的查询和操作，从而实现对关系数据库中的数据的有效管理和检索。关系代数是关系数据库理论的基础之一，它提供了一种形式化的方式来描述和操作关系数据库中的数据。</p><p>以下是关系代数基本操作的常用符号表示：</p><ol><li><p>选择（Selection）：用σ（sigma）符号表示。例如，σ&lt;条件&gt;(关系) 表示选择满足指定条件的元组。</p></li><li><p>投影（Projection）：用π（pi）符号表示。例如，π&lt;属性列表&gt;(关系) 表示从关系中选择指定的属性列。</p></li><li><p>连接（Join）：用⨝（join）符号表示。例如，关系1 ⨝ 关系2 表示根据共享的属性列将两个关系进行连接。</p></li><li><p>交（Intersection）：用∩（intersection）符号表示。例如，关系1 ∩ 关系2 表示获取两个关系的交集，即共有的元组。</p></li><li><p>并（Union）：用∪（union）符号表示。例如，关系1 ∪ 关系2 表示获取两个关系的并集，即合并两个关系的元组，去除重复项。</p></li><li><p>差（Difference）：用-（minus）符号表示。例如，关系1 - 关系2 表示获取一个关系中有而另一个关系中没有的元组。</p></li><li><p>除（Division）：用÷（division）符号表示。例如，关系1 ÷ 关系2 表示根据指定条件从一个关系中选择满足条件的元组，然后从另一个关系中选择与前一步结果关系中的所有元组匹配的元组。</p></li></ol><p>这些符号表示了关系代数中的基本操作，可以根据需要进行组合和嵌套，以实现更复杂的查询和操作。</p><h3 id="训练场"><a href="#训练场" class="headerlink" title="训练场"></a>训练场</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Emp(E#,Ename,Age,Salary,D#);</span><br><span class="line">Depa(D#,Dname,Mgr#);</span><br></pre></td></tr></table></figure><ol><li><p>检索每个部门经理的工资（显示部门编号，部门名称，经理编号，经理姓名，经理工资）：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">π D#, Dname, Mgr#, Ename, Salary (σ Emp.E# = Depa.Mgr# ∧ Emp.D# = Depa.D# (Emp ∞ Depa))</span><br></pre></td></tr></table></figure></li><li><p>检索部门名称为“销售科”的职工工号，姓名，工资：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">π E#, Ename, Salary (σ Dname = &quot;销售科&quot; (Emp ∞ Depa))</span><br></pre></td></tr></table></figure></li><li><p>已知一关系数据库的模式如下：<br>供应商关系：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">S(Sno,Sname,City);</span><br></pre></td></tr></table></figure><p>零件关系：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">P(Pno,Pname,Color,Weight);</span><br></pre></td></tr></table></figure><p>工程关系：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">J(Jno,Jname,City);</span><br></pre></td></tr></table></figure><p>供货关系：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SPJ(Sno,Pno,Jno,Qty);</span><br></pre></td></tr></table></figure><p>用关系代数完成下列查询：</p><ol><li><p>查询为工程’J1’供货的供应商名：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> Sname</span><br><span class="line"><span class="keyword">FROM</span> S</span><br><span class="line"><span class="keyword">WHERE</span> Sno <span class="keyword">IN</span> (</span><br><span class="line">    <span class="keyword">SELECT</span> Sno</span><br><span class="line">    <span class="keyword">FROM</span> SPJ</span><br><span class="line">    <span class="keyword">WHERE</span> Jno <span class="operator">=</span> <span class="string">&#x27;J1&#x27;</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure></li><li><p>查询供应’螺母’零件的供应商名和所在城市：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> Sname, City</span><br><span class="line"><span class="keyword">FROM</span> S</span><br><span class="line"><span class="keyword">WHERE</span> Sno <span class="keyword">IN</span> (</span><br><span class="line">    <span class="keyword">SELECT</span> Sno</span><br><span class="line">    <span class="keyword">FROM</span> SPJ</span><br><span class="line">    <span class="keyword">WHERE</span> Pno <span class="keyword">IN</span> (</span><br><span class="line">        <span class="keyword">SELECT</span> Pno</span><br><span class="line">        <span class="keyword">FROM</span> P</span><br><span class="line">        <span class="keyword">WHERE</span> Pname <span class="operator">=</span> <span class="string">&#x27;螺母&#x27;</span></span><br><span class="line">    )</span><br><span class="line">)</span><br></pre></td></tr></table></figure></li><li><p>查询工程’J2’不使用的零件名和颜色：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> Pname, Color</span><br><span class="line"><span class="keyword">FROM</span> P</span><br><span class="line"><span class="keyword">WHERE</span> Pno <span class="keyword">NOT</span> <span class="keyword">IN</span> (</span><br><span class="line">    <span class="keyword">SELECT</span> Pno</span><br><span class="line">    <span class="keyword">FROM</span> SPJ</span><br><span class="line">    <span class="keyword">WHERE</span> Jno <span class="operator">=</span> <span class="string">&#x27;J2&#x27;</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure></li></ol></li></ol><h2 id="SQL语言"><a href="#SQL语言" class="headerlink" title="SQL语言"></a>SQL语言</h2><h3 id="概念-1"><a href="#概念-1" class="headerlink" title="概念"></a>概念</h3><p>SQL（Structured Query Language）是一种用于管理关系型数据库系统的编程语言。它是一个标准化的语言，用于存储、检索、操作和管理数据库中的数据。</p><p>SQL提供了一组用于执行各种操作的命令和语句，包括以下主要方面：</p><ol><li><p>数据定义语言（Data Definition Language，DDL）：用于创建、修改和删除数据库对象（例如表、视图、索引等）的语句。DDL语句包括CREATE、ALTER和DROP等。</p></li><li><p>数据操作语言（Data Manipulation Language，DML）：用于操作和处理数据库中的数据的语句。DML语句包括SELECT、INSERT、UPDATE和DELETE等。</p></li><li><p>数据控制语言（Data Control Language，DCL）：用于控制数据库的安全性和访问权限的语句。DCL语句包括GRANT和REVOKE等。</p></li><li><p>数据查询语言（Data Query Language，DQL）：用于从数据库中检索数据的语句。DQL语句主要是SELECT语句，用于查询满足指定条件的数据。</p></li></ol><p>SQL语言的特点包括：</p><ul><li>面向集合：SQL处理数据的基本单位是集合，即表中的行。</li><li>声明式语言：SQL是一种声明式语言，用户只需描述所需的结果，而不需要指定具体的操作步骤。</li><li>高度可扩展：SQL支持在单个查询中使用多个表进行联接，执行复杂的数据操作和聚合运算。</li><li>广泛应用：SQL是关系型数据库系统的标准查询语言，几乎所有主流的关系型数据库管理系统（如MySQL、Oracle、SQL Server等）都支持SQL语言。</li></ul><p>通过SQL语言，用户可以方便地管理和操作数据库中的数据，执行各种查询、更新和管理任务。</p><h3 id="训练场-1"><a href="#训练场-1" class="headerlink" title="训练场"></a>训练场</h3><p>这里存在数据库，结构为</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Student(<span class="keyword">No</span>,name,sex,age,class);</span><br><span class="line">Course(Cno,cname,Tno);</span><br><span class="line">Teacher(Tno,name,sex,prof,dept);</span><br><span class="line">Score(<span class="keyword">No</span>,Cno,Grade);</span><br></pre></td></tr></table></figure><ol><li><p>查询选修课程<code>3-105</code>且成绩在60到80之间的所有记录：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> Score</span><br><span class="line"><span class="keyword">WHERE</span> Cno <span class="operator">=</span> <span class="string">&#x27;3-105&#x27;</span> <span class="keyword">AND</span> Grade <span class="keyword">BETWEEN</span> <span class="number">60</span> <span class="keyword">AND</span> <span class="number">80</span>;</span><br></pre></td></tr></table></figure></li><li><p>查询成绩为85,86或88的记录：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> Score</span><br><span class="line"><span class="keyword">WHERE</span> Grade <span class="keyword">IN</span> (<span class="number">85</span>, <span class="number">86</span>, <span class="number">88</span>);</span><br></pre></td></tr></table></figure></li><li><p>查询<code>95031</code>班的学生人数：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>)</span><br><span class="line"><span class="keyword">FROM</span> Student</span><br><span class="line"><span class="keyword">WHERE</span> Class <span class="operator">=</span> <span class="string">&#x27;95031&#x27;</span>;</span><br></pre></td></tr></table></figure></li><li><p>查询至少有5名同学选修的并以3开头的课程的平均成绩：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="built_in">AVG</span>(Grade)</span><br><span class="line"><span class="keyword">FROM</span> Score</span><br><span class="line"><span class="keyword">WHERE</span> Cno <span class="keyword">LIKE</span> <span class="string">&#x27;3%&#x27;</span></span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> Cno</span><br><span class="line"><span class="keyword">HAVING</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>) <span class="operator">&gt;=</span> <span class="number">5</span>;</span><br></pre></td></tr></table></figure></li><li><p>查询最低分大于70，最高分小于90的<code>NO</code>：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">No</span></span><br><span class="line"><span class="keyword">FROM</span> Score</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> <span class="keyword">No</span></span><br><span class="line"><span class="keyword">HAVING</span> <span class="built_in">MIN</span>(Grade) <span class="operator">&gt;</span> <span class="number">70</span> <span class="keyword">AND</span> <span class="built_in">MAX</span>(Grade) <span class="operator">&lt;</span> <span class="number">90</span>;</span><br></pre></td></tr></table></figure></li><li><p>查询<code>95033</code>班学生所选课程的平均分：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="built_in">AVG</span>(Grade)</span><br><span class="line"><span class="keyword">FROM</span> Score, Student</span><br><span class="line"><span class="keyword">WHERE</span> Score.No <span class="operator">=</span> Student.No <span class="keyword">AND</span> Class <span class="operator">=</span> <span class="string">&#x27;95033&#x27;</span></span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> <span class="keyword">No</span>;</span><br></pre></td></tr></table></figure></li><li><p>查询选修<code>3-105</code>课程的成绩高于<code>109</code>号同学成绩的所有同学的记录：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> Score</span><br><span class="line"><span class="keyword">WHERE</span> Cno <span class="operator">=</span> <span class="string">&#x27;3-105&#x27;</span> <span class="keyword">AND</span> Grade <span class="operator">&gt;</span> (<span class="keyword">SELECT</span> Grade <span class="keyword">FROM</span> Score <span class="keyword">WHERE</span> Cno <span class="operator">=</span> <span class="string">&#x27;3-105&#x27;</span> <span class="keyword">AND</span> <span class="keyword">No</span> <span class="operator">=</span> <span class="string">&#x27;109&#x27;</span>);</span><br></pre></td></tr></table></figure></li><li><p>查询与学号为<code>108</code>的同学同岁的所有学生的<code>NO</code>, <code>Name</code>, <code>Age</code>：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">No</span>, Name, Age</span><br><span class="line"><span class="keyword">FROM</span> Student</span><br><span class="line"><span class="keyword">WHERE</span> Age <span class="operator">=</span> (<span class="keyword">SELECT</span> Age <span class="keyword">FROM</span> Student <span class="keyword">WHERE</span> <span class="keyword">No</span> <span class="operator">=</span> <span class="string">&#x27;108&#x27;</span>);</span><br></pre></td></tr></table></figure></li><li><p>查询<code>张旭</code>教师任课的课程号及选修其课程的学生的学号和成绩：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">No</span>, Grade</span><br><span class="line"><span class="keyword">FROM</span> Score</span><br><span class="line"><span class="keyword">WHERE</span> Cno <span class="keyword">IN</span> (<span class="keyword">SELECT</span> Cno <span class="keyword">FROM</span> Course <span class="keyword">WHERE</span> Tno <span class="operator">=</span> (<span class="keyword">SELECT</span> Tno <span class="keyword">FROM</span> Teacher <span class="keyword">WHERE</span> name <span class="operator">=</span> <span class="string">&#x27;张旭&#x27;</span>));</span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">No</span>, Grade</span><br><span class="line"><span class="keyword">FROM</span> Score, Teacher, Course</span><br><span class="line"><span class="keyword">WHERE</span> Teacher.Tno <span class="operator">=</span> Course.Tno <span class="keyword">AND</span> Course.Cno <span class="operator">=</span> Score.Cno <span class="keyword">AND</span> Teacher.name <span class="operator">=</span> <span class="string">&#x27;张旭&#x27;</span>;</span><br></pre></td></tr></table></figure></li><li><p>查询选修某课程的学生人数多于30人的教师姓名：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> Name</span><br><span class="line"><span class="keyword">FROM</span> Teahcer</span><br><span class="line"><span class="keyword">WHERE</span> Tno <span class="keyword">IN</span> (</span><br><span class="line">   <span class="keyword">SELECT</span> Tno</span><br><span class="line">   <span class="keyword">FROM</span> Course</span><br><span class="line">   <span class="keyword">WHERE</span> Cno <span class="keyword">IN</span> (</span><br><span class="line">       <span class="keyword">SELECT</span> Cno</span><br><span class="line">       <span class="keyword">FROM</span> Score</span><br><span class="line">       <span class="keyword">GROUP</span> <span class="keyword">BY</span> Cno</span><br><span class="line">       <span class="keyword">HAVING</span> <span class="built_in">COUNT</span>(<span class="keyword">No</span>) <span class="operator">&gt;</span> <span class="number">30</span></span><br><span class="line">   )</span><br><span class="line">);</span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> Name</span><br><span class="line"><span class="keyword">FROM</span> Techaer, Score, Course</span><br><span class="line"><span class="keyword">WHERE</span> Techaer.Tno <span class="operator">=</span> Course.Tno</span><br><span class="line">   <span class="keyword">AND</span> Course.Cno <span class="operator">=</span> Score.Cno</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> Cno</span><br><span class="line"><span class="keyword">HAVING</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>) <span class="operator">&gt;</span> <span class="number">30</span>;</span><br></pre></td></tr></table></figure></li><li><p>查询<code>计算机系</code>与<code>电子工程系</code>不同职称的教师姓名和职称：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> name, prof</span><br><span class="line"><span class="keyword">FROM</span> Teacher</span><br><span class="line"><span class="keyword">WHERE</span> Dept <span class="operator">=</span> <span class="string">&#x27;电子工程系&#x27;</span> <span class="keyword">AND</span> Prof <span class="keyword">NOT</span> <span class="keyword">IN</span> (</span><br><span class="line">   <span class="keyword">SELECT</span> Prof</span><br><span class="line">   <span class="keyword">FROM</span> Teacher</span><br><span class="line">   <span class="keyword">WHERE</span> Dept <span class="operator">=</span> <span class="string">&#x27;计算机系&#x27;</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure></li><li><p>查询选修编号为<code>3-105</code>课程且成绩至少高于选修编号为<code>3-234</code>课程的同学的课号、学号、成绩，并按成绩降序排列：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">No</span>, grade</span><br><span class="line"><span class="keyword">FROM</span> Score</span><br><span class="line"><span class="keyword">WHERE</span> Cno <span class="operator">=</span> <span class="string">&#x27;3-105&#x27;</span> <span class="keyword">AND</span> Grade <span class="operator">&gt;</span> <span class="keyword">ANY</span> (</span><br><span class="line">   <span class="keyword">SELECT</span> grade</span><br><span class="line">   <span class="keyword">FROM</span> Score</span><br><span class="line">   <span class="keyword">WHERE</span> Cno <span class="operator">=</span> <span class="string">&#x27;3-234&#x27;</span></span><br><span class="line">)</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> grade <span class="keyword">DESC</span>;</span><br></pre></td></tr></table></figure></li><li><p>查询选修编号为<code>3-105</code>课程且成绩高于选修编号为<code>3-234</code>课程的同学的课号、学号、成绩，并按成绩降序排列：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">No</span>, grade</span><br><span class="line"><span class="keyword">FROM</span> Score</span><br><span class="line"><span class="keyword">WHERE</span> Cno <span class="operator">=</span> <span class="string">&#x27;3-105&#x27;</span> <span class="keyword">AND</span> Grade <span class="operator">&gt;</span> <span class="keyword">ALL</span> (</span><br><span class="line">   <span class="keyword">SELECT</span> grade</span><br><span class="line">   <span class="keyword">FROM</span> Score</span><br><span class="line">   <span class="keyword">WHERE</span> Cno <span class="operator">=</span> <span class="string">&#x27;3-234&#x27;</span></span><br><span class="line">)</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> grade <span class="keyword">DESC</span>;</span><br></pre></td></tr></table></figure></li><li><p>列出所有老师和同学的姓名、性别和年龄：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> Name, Sex, Age</span><br><span class="line"><span class="keyword">FROM</span> teacher</span><br><span class="line"><span class="keyword">UNION</span></span><br><span class="line"><span class="keyword">SELECT</span> Name, Sex, Age</span><br><span class="line"><span class="keyword">FROM</span> student;</span><br></pre></td></tr></table></figure></li><li><p>查询成绩比该课平均成绩低的学生的成绩表：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">No</span>, Grade</span><br><span class="line"><span class="keyword">FROM</span> Score</span><br><span class="line"><span class="keyword">WHERE</span> Grade <span class="operator">&lt;</span> (</span><br><span class="line">   <span class="keyword">SELECT</span> <span class="built_in">AVG</span>(Grade)</span><br><span class="line">   <span class="keyword">FROM</span> Score <span class="keyword">AS</span> y</span><br><span class="line">   <span class="keyword">WHERE</span> Score.Cno <span class="operator">=</span> y.Cno</span><br><span class="line">   <span class="keyword">GROUP</span> <span class="keyword">BY</span> Cno</span><br><span class="line">);</span><br></pre></td></tr></table></figure></li><li><p>列出所有任课教师的Name和Dept：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> Name, Dept</span><br><span class="line"><span class="keyword">FROM</span> Teacher</span><br><span class="line"><span class="keyword">WHERE</span> Tno <span class="keyword">IN</span> (</span><br><span class="line">   <span class="keyword">SELECT</span> Tno</span><br><span class="line">   <span class="keyword">FROM</span> Course</span><br><span class="line">);</span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> Name, Dept</span><br><span class="line"><span class="keyword">FROM</span> Teahcer <span class="keyword">AS</span> A</span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">EXISTS</span> (</span><br><span class="line">   <span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line">   <span class="keyword">FROM</span> Course <span class="keyword">AS</span> B</span><br><span class="line">   <span class="keyword">WHERE</span> A.Tno <span class="operator">=</span> B.Tno</span><br><span class="line">);</span><br></pre></td></tr></table></figure></li><li><p>列出所有未讲课教师的Name和Dept：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> Name, Dept</span><br><span class="line"><span class="keyword">FROM</span> Teacher</span><br><span class="line"><span class="keyword">WHERE</span> Tno <span class="keyword">NOT</span> <span class="keyword">IN</span> (</span><br><span class="line">   <span class="keyword">SELECT</span> Tno</span><br><span class="line">   <span class="keyword">FROM</span> Course</span><br><span class="line">);</span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> Name, Dept</span><br><span class="line"><span class="keyword">FROM</span> Teahcer <span class="keyword">AS</span> A</span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">NOT</span> <span class="keyword">EXISTS</span> (</span><br><span class="line">   <span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line">   <span class="keyword">FROM</span> Course <span class="keyword">AS</span> B</span><br><span class="line">   <span class="keyword">WHERE</span> A.Tno <span class="operator">=</span> B.Tno</span><br><span class="line">);</span><br></pre></td></tr></table></figure></li><li><p>列出至少有2名男生的班级编号：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> Class</span><br><span class="line"><span class="keyword">FROM</span> student</span><br><span class="line"><span class="keyword">WHERE</span> sex <span class="operator">=</span> <span class="string">&#x27;男&#x27;</span></span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> Class</span><br><span class="line"><span class="keyword">HAVING</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>) <span class="operator">&gt;=</span> <span class="number">2</span>;</span><br></pre></td></tr></table></figure></li><li><p>查询不姓<code>王</code>的学生记录：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> student</span><br><span class="line"><span class="keyword">WHERE</span> Name <span class="keyword">NOT</span> <span class="keyword">LIKE</span> <span class="string">&#x27;王%&#x27;</span>;</span><br></pre></td></tr></table></figure></li><li><p>查询每门课最高分的同学的No, Cno, Grade：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">No</span>, Cno, Grade</span><br><span class="line"><span class="keyword">FROM</span> Score A</span><br><span class="line"><span class="keyword">WHERE</span> Grade <span class="operator">=</span> (</span><br><span class="line">   <span class="keyword">SELECT</span> <span class="built_in">MAX</span>(Grade)</span><br><span class="line">   <span class="keyword">FROM</span> Score B</span><br><span class="line">   <span class="keyword">WHERE</span> A.Cno <span class="operator">=</span> B.Cno</span><br><span class="line">);</span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">No</span>, Cno, Grade</span><br><span class="line"><span class="keyword">FROM</span> Score A</span><br><span class="line"><span class="keyword">WHERE</span> A.Cno <span class="operator">=</span> B.Cno <span class="keyword">AND</span> Grade <span class="operator">=</span> (</span><br><span class="line">   <span class="keyword">SELECT</span> <span class="built_in">MAX</span>(Grade)</span><br><span class="line">   <span class="keyword">FROM</span> Score B</span><br><span class="line">   <span class="keyword">GROUP</span> <span class="keyword">BY</span> Cno</span><br><span class="line">);</span><br></pre></td></tr></table></figure></li><li><p>查询与“李军”同性别并同班的同学姓名：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> Name</span><br><span class="line"><span class="keyword">FROM</span> Student</span><br><span class="line"><span class="keyword">WHERE</span> Class <span class="operator">=</span> (</span><br><span class="line">   <span class="keyword">SELECT</span> Class</span><br><span class="line">   <span class="keyword">FROM</span> Student</span><br><span class="line">   <span class="keyword">WHERE</span> Name <span class="operator">=</span> <span class="string">&#x27;李军&#x27;</span></span><br><span class="line">)</span><br><span class="line"><span class="keyword">AND</span> sex <span class="operator">=</span> (</span><br><span class="line">   <span class="keyword">SELECT</span> sex</span><br><span class="line">   <span class="keyword">FROM</span> Student</span><br><span class="line">   <span class="keyword">WHERE</span> Name <span class="operator">=</span> <span class="string">&#x27;李军&#x27;</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure></li><li><p>查询<code>男</code>教师及其所任的课程：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> A.Name, B.Cname</span><br><span class="line"><span class="keyword">FROM</span> Teacher A, Course B</span><br><span class="line"><span class="keyword">WHERE</span> A.Tno <span class="operator">=</span> B.Tno <span class="keyword">AND</span> A.sex <span class="operator">=</span> <span class="string">&#x27;男&#x27;</span>;</span><br></pre></td></tr></table></figure></li><li><p>查询选修<code>计算机导论</code>课程的<code>男</code>同学的成绩表：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">No</span>, Cno, Grade</span><br><span class="line"><span class="keyword">FROM</span> Score</span><br><span class="line"><span class="keyword">WHERE</span> Cno <span class="keyword">IN</span> (</span><br><span class="line">   <span class="keyword">SELECT</span> Cno</span><br><span class="line">   <span class="keyword">FROM</span> Course</span><br><span class="line">   <span class="keyword">WHERE</span> Cname <span class="operator">=</span> <span class="string">&#x27;计算机导论&#x27;</span></span><br><span class="line">)</span><br><span class="line"><span class="keyword">AND</span> <span class="keyword">No</span> <span class="keyword">IN</span> (</span><br><span class="line">   <span class="keyword">SELECT</span> <span class="keyword">No</span></span><br><span class="line">   <span class="keyword">FROM</span> Student</span><br><span class="line">   <span class="keyword">WHERE</span> Sex <span class="operator">=</span> <span class="string">&#x27;男&#x27;</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">No</span>, Cno, Grade</span><br><span class="line"><span class="keyword">FROM</span> Score A, Student B, Course C</span><br><span class="line"><span class="keyword">WHERE</span> A.No <span class="operator">=</span> B.No</span><br><span class="line"><span class="keyword">AND</span> A.Cno <span class="operator">=</span> C.Cno</span><br><span class="line"><span class="keyword">AND</span> C.Cname <span class="operator">=</span> <span class="string">&#x27;计算机导论&#x27;</span></span><br><span class="line"><span class="keyword">AND</span> B.Sex <span class="operator">=</span> <span class="string">&#x27;男&#x27;</span>;</span><br></pre></td></tr></table></figure></li><li><p>在数据库中要求每个经理的工资大于2000元。试在Depa表的定义时，加一个Check子句，以满足上述要求。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ALTER TABLE Depa ADD CHECK (Mgr# IN (SELECT E# FROM Emp WHERE Salary &gt; 2000))</span><br></pre></td></tr></table></figure></li><li><p>更新Depa表，将经理编号（Mgr#）设置为null，满足条件：Depa表中的Mgr#等于Emp表中的E#，并且Emp表中的Age大于50。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">UPDATE Depa SET Mgr# = NULL WHERE Mgr# IN (SELECT E# FROM Emp WHERE Age &gt; 50)</span><br></pre></td></tr></table></figure></li><li><p>创建一个年龄大于50岁的职工视图（D#, Dname, E#, Ename, Age, Salary）：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">CREATE VIEW wyy AS</span><br><span class="line">SELECT D#, Dname, E#, Ename, Age, Salary</span><br><span class="line">FROM Emp, Depa</span><br><span class="line">WHERE Emp.E# = Depa.Mgr# AND Emp.Age &gt; 50;</span><br></pre></td></tr></table></figure></li><li><p>用Create table 命令定义Depa表（需要定义主键和外键）</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Create</span> <span class="keyword">table</span> Depa (</span><br><span class="line">    D# <span class="type">char</span>(<span class="number">10</span>) <span class="keyword">primary</span> key,</span><br><span class="line">    Dname <span class="type">char</span>(<span class="number">8</span>),</span><br><span class="line">    Mgr# <span class="type">char</span>(<span class="number">15</span>),</span><br><span class="line">    <span class="keyword">Foreign</span> key (Mgr#) <span class="keyword">references</span> Emp(E#)</span><br><span class="line">);</span><br></pre></td></tr></table></figure></li><li><p>查询每个部门的职工人数和平均工资，要求显示（部门号，部门名称，职工人数，平均工资）：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> D#, Dname, <span class="built_in">COUNT</span>(<span class="operator">*</span>) <span class="keyword">as</span> 职工人数, <span class="built_in">AVG</span>(Salary) <span class="keyword">as</span> 平均工资</span><br><span class="line"><span class="keyword">FROM</span> Depa, Emp</span><br><span class="line"><span class="keyword">WHERE</span> Depa.D# <span class="operator">=</span> Emp.D#</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> D#</span><br></pre></td></tr></table></figure></li><li><p>在Depa表中删除人数少于10人的部门元组</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> Depa</span><br><span class="line"><span class="keyword">WHERE</span> D# <span class="keyword">IN</span> (</span><br><span class="line">    <span class="keyword">SELECT</span> D#</span><br><span class="line">    <span class="keyword">FROM</span> Emp</span><br><span class="line">    <span class="keyword">GROUP</span> <span class="keyword">BY</span> D#</span><br><span class="line">    <span class="keyword">HAVING</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>) <span class="operator">&lt;</span> <span class="number">10</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure></li></ol><div class="note warning"><p>对于上述关系代数与SQL的示例可能存在不合理的部分，请跟据实际情况修改，毕竟，只有生产环境才是有真正明确需求的与真实的环境。</p></div><h3 id="万用模版"><a href="#万用模版" class="headerlink" title="万用模版"></a>万用模版</h3><ul><li><p>查询模版</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> [列名]</span><br><span class="line"><span class="keyword">FROM</span> [表名]</span><br><span class="line">[<span class="keyword">JOIN</span> 子句]</span><br><span class="line"><span class="keyword">WHERE</span> [条件]</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> [列名]</span><br><span class="line"><span class="keyword">HAVING</span> [条件]</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> [列名] [<span class="keyword">ASC</span><span class="operator">|</span><span class="keyword">DESC</span>]</span><br><span class="line">LIMIT [数量];</span><br></pre></td></tr></table></figure></li><li><p>插入模版</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> [表名] ([列<span class="number">1</span>], [列<span class="number">2</span>], ...)</span><br><span class="line"><span class="keyword">VALUES</span> ([值<span class="number">1</span>], [值<span class="number">2</span>], ...);</span><br></pre></td></tr></table></figure></li><li><p>修改模版</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">UPDATE</span> [表名]</span><br><span class="line"><span class="keyword">SET</span> [列<span class="number">1</span>] <span class="operator">=</span> [新值<span class="number">1</span>], [列<span class="number">2</span>] <span class="operator">=</span> [新值<span class="number">2</span>], ...</span><br><span class="line"><span class="keyword">WHERE</span> [条件];</span><br></pre></td></tr></table></figure></li><li><p>删除模版</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> [表名]</span><br><span class="line"><span class="keyword">WHERE</span> [条件];</span><br></pre></td></tr></table></figure></li><li><p>定义视图模版</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">VIEW</span> [视图名] <span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span> [列<span class="number">1</span>], [列<span class="number">2</span>], ...</span><br><span class="line"><span class="keyword">FROM</span> [表名]</span><br><span class="line"><span class="keyword">WHERE</span> [条件];</span><br></pre></td></tr></table></figure><ul><li><p>解释说明：</p><ul><li><code>[视图名]</code>：指定要创建的视图的名称。</li><li><code>[列1], [列2], ...</code>：指定要包含在视图中的列名。</li><li><code>[表名]</code>：指定要从中提取数据的表名。</li><li><code>[条件]</code>：可选项，用于筛选特定的数据行。</li></ul></li><li><p>注意事项：</p><ul><li>方括号 <code>[ ]</code> 中的内容是需要替换为具体的值或表达式。</li><li>视图是从一个或多个基本表派生出来的虚拟表，其内容是基于查询的结果集。因此，在定义视图时，需要使用合适的 SELECT<br>语句来指定视图的内容。</li></ul></li></ul></li><li><p>建表模版</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> [表名] (</span><br><span class="line">    [列<span class="number">1</span>] [数据类型] [约束],</span><br><span class="line">    [列<span class="number">2</span>] [数据类型] [约束],</span><br><span class="line">    ...</span><br><span class="line">    [列N] [数据类型] [约束]</span><br><span class="line">);</span><br></pre></td></tr></table></figure><ul><li><p>解释说明：</p><ul><li><code>[表名]</code>：指定要创建的表的名称。</li><li><code>[列1], [列2], ..., [列N]</code>：指定要创建的列名。</li><li><code>[数据类型]</code>：指定每个列的数据类型，如 INT、VARCHAR、DATE 等。</li><li><code>[约束]</code>：可选项，用于指定列级别的约束条件，如 PRIMARY KEY、NOT NULL、UNIQUE 等。</li></ul></li><li><p>注意事项：</p><ul><li>方括号 <code>[ ]</code> 中的内容是需要替换为具体的值或表达式。</li><li>每个列定义需要包含列名和数据类型。</li><li>可以在每个列定义后面添加约束来进一步定义列的行为和限制。</li><li>可以根据需要在表定义的末尾添加其他选项，如存储引擎、字符集等。</li></ul></li></ul></li><li><p>创建角色模版</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> ROLE <span class="string">&#x27;角色名&#x27;</span>;</span><br></pre></td></tr></table></figure><ul><li><p>解释说明：</p><ul><li><code>&#39;角色名&#39;</code>：指定要创建的角色名称，角色名称用单引号括起来。</li></ul></li><li><p>注意事项：</p><ul><li>角色名称应遵循 MySQL 的命名规则，如不能包含特殊字符、空格等。</li><li>创建角色需要具有适当的权限，通常是 <code>CREATE ROLE</code> 权限。</li></ul></li></ul></li><li><p>角色赋权模版</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GRANT</span> 权限列表 <span class="keyword">TO</span> <span class="string">&#x27;角色名&#x27;</span>;</span><br></pre></td></tr></table></figure><ul><li><p>解释说明：</p><ul><li><code>权限列表</code>：指定要授予给角色的权限，可以是单个权限或多个权限，多个权限之间使用逗号分隔。</li><li><code>&#39;角色名&#39;</code>：指定要授予权限的角色名称，角色名称用单引号括起来。</li></ul></li><li><p>注意事项：</p><ul><li>角色和权限都应存在于数据库中。</li><li>授予权限需要具有适当的权限，通常是 <code>GRANT</code> 权限。</li></ul></li><li><p>使用上述模板，你可以为角色赋予指定的权限。将 <code>&#39;角色名&#39;</code> 替换为实际的角色名称，将 <code>权限列表</code><br>替换为要授予的具体权限即可。如果需要授予多个权限，可以在 <code>权限列表</code> 中使用逗号分隔不同的权限项。</p><blockquote><p>示例：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GRANT</span> <span class="keyword">SELECT</span>, <span class="keyword">INSERT</span>, <span class="keyword">UPDATE</span> <span class="keyword">ON</span> database.table <span class="keyword">TO</span> <span class="string">&#x27;角色名&#x27;</span>;</span><br></pre></td></tr></table></figure><p>上述示例将 SELECT、INSERT 和 UPDATE 权限授予给名为 <code>&#39;角色名&#39;</code> 的角色。你可以根据实际情况调整权限列表和角色名称。</p></blockquote></li></ul></li><li><p>授权模版</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GRANT</span> [权限列表] <span class="keyword">ON</span> [数据库].[表] <span class="keyword">TO</span> <span class="string">&#x27;[用户名]&#x27;</span>@<span class="string">&#x27;[主机]&#x27;</span> [<span class="keyword">WITH</span> <span class="keyword">GRANT</span> OPTION];</span><br></pre></td></tr></table></figure><ul><li><p>解释说明：</p><ul><li><code>[权限列表]</code>：指定要授予的权限，可以是多个权限，用逗号分隔，如 SELECT, INSERT, UPDATE。</li><li><code>[数据库]</code>：指定要授予权限的数据库名称。如果要授予全局权限，可以使用通配符 <code>*</code>。</li><li><code>[表]</code>：可选项，指定要授予权限的表名。如果要授予数据库级别的权限，可以省略该部分。</li><li><code>&#39;[用户名]&#39;@&#39;[主机]&#39;</code><br>：指定要授予权限的用户和对应的主机。用户名和主机分别用单引号括起来。如果要授予全局权限，可以使用通配符 <code>%</code>。</li><li><code>WITH GRANT OPTION</code>：可选项，允许被授权的用户进一步授予该权限给其他用户。</li></ul></li><li><p>注意事项：</p><ul><li>方括号 <code>[ ]</code> 中的内容是需要替换为具体的值或表达式。</li><li>权限可以是诸如 SELECT、INSERT、UPDATE、DELETE 等数据库操作的关键字。</li><li>可以根据需要指定具体的数据库和表，或者使用通配符 <code>*</code> 表示所有数据库或表。</li><li>授权操作需要具有适当的权限，通常是 <code>GRANT OPTION</code> 权限。</li></ul></li></ul></li></ul><h2 id="E-R图"><a href="#E-R图" class="headerlink" title="E-R图"></a>E-R图</h2><h3 id="概念-2"><a href="#概念-2" class="headerlink" title="概念"></a>概念</h3><p>E-R图（实体-关系图）是一种用于数据建模的图形工具，用于描述现实世界中的实体、实体之间的关系以及实体属性的结构化图形化表示。它基于实体-关系模型，是一种高层次、抽象的表示方式，用于在数据库设计和开发过程中描述实体、关系和属性之间的概念和关联。</p><p>E-R图由实体、关系和属性组成，其中：</p><ul><li>实体（Entity）代表现实世界中具有独立存在和可识别的事物，如人、物、地点或概念。每个实体都有一个唯一的标识符（主键），并具有属性描述实体的特征。</li><li>关系（Relationship）表示实体之间的联系或关联。关系可以是一对一、一对多或多对多的关系，用于描述实体之间的交互和依赖。</li><li>属性（Attribute）是实体的特征或描述，用于存储实体的具体数据。属性可以是简单属性（如姓名、年龄）或复合属性（如地址，由街道、城市和邮编组成）。</li></ul><p>通过使用符号和连接线，E-R图提供了一种直观的方式来可视化和表示实体、关系和属性之间的结构和相互作用。它是数据库设计和规划的重要工具，有助于理解和沟通数据模型的概念，以便更好地设计和管理数据库系统。</p><h3 id="例子"><a href="#例子" class="headerlink" title="例子"></a>例子</h3><p>Student(<u>id</u>, name, gender)</p><p>Class(<u>cid</u>, name)</p><p>Teacher(<u>tid</u>, gender, name)</p><p><strong>我们使用<code>_</code>来表述一张数据表中的主键字段。</strong></p><p><strong>图中连接表与表的线条，应该是干净的，不应该有类似于分支的部分，应该与连接表与字段的线条一致。</strong></p><img no-lazy class="inline" src="/picture/E-R图.png" style="height:500px;"/>]]></content>
      
      
      <categories>
          
          <category> Final Review </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Database </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>My first blog post</title>
      <link href="/2023/07/05/my-first-blog-post/"/>
      <url>/2023/07/05/my-first-blog-post/</url>
      
        <content type="html"><![CDATA[<h1 id="如何搭建一个属于自己的博客网站？"><a href="#如何搭建一个属于自己的博客网站？" class="headerlink" title="如何搭建一个属于自己的博客网站？"></a>如何搭建一个属于自己的博客网站？</h1><h2 id="起因"><a href="#起因" class="headerlink" title="起因"></a>起因</h2><p><code>今天早些的时候我在看Nginx的教程，那位youtuber就使用了Hexo搭建的博客进行反向代理测试，于是我就很感兴趣，便去了解了一下</code></p><div class="link-group"><div class="tagLink"><a class="link-card" title="30分钟Nginx入门教程 - YouTube" href="https://youtu.be/sCJcusORiE8"><span class="link-card-backdrop" style="background-image: url(https://pica.zhimg.com/80/v2-970dd5538f106dd6be064c4eafc01c36_1440w.webp)"></span><div class="left"><img src="https://pica.zhimg.com/80/v2-970dd5538f106dd6be064c4eafc01c36_1440w.webp" class="lazyload placeholder" data-srcset="https://pica.zhimg.com/80/v2-970dd5538f106dd6be064c4eafc01c36_1440w.webp" srcset="https://pic1.zhimg.com/v2-cd38920285d125be80b3eb504052c550_b.webp"/></div><div class="right"><p class="text">30分钟Nginx入门教程 - YouTube</p><p class="url">https://youtu.be/sCJcusORiE8</p></div></a></div></div><p>访问<a href="https://hexo.io/">Hexo</a>以了解更多内容。</p><p>我选择了一个自己蛮喜欢的主题。</p><p>我也修改了很多配置项，不过总的说还是非常容易理解的。</p><h2 id="遇到的问题"><a href="#遇到的问题" class="headerlink" title="遇到的问题"></a>遇到的问题</h2><p>这过程中最最最离谱的问题（对我来说）是：关于git push的问题，经常push不上去，所以我就排查了问题原因，试过了修改<code>/etc/hosts</code>的配置</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo bash -c &#x27;echo &quot;&lt;IP&gt; &lt;hostname&gt;&quot; &gt;&gt; /etc/hosts&#x27;</span><br></pre></td></tr></table></figure><p>也尝试了修改<code>http.version</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git config --global http.version HTTP/1.1</span><br></pre></td></tr></table></figure><p>发现没有用，最后，我发现是代理的问题，因为在浏览器中打开GitHub没问题，但使用git的时候就<code>could&#39;t connect</code>，原因在于git默认不使用代理端口</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git config --global http.proxy 127.0.0.1:[port]</span><br><span class="line">git config --global https.proxy 127.0.0.1:[port]</span><br></pre></td></tr></table></figure><p><code>port</code>为代理端口号</p><p>这个问题就如此解决了。</p><h2 id="后言"><a href="#后言" class="headerlink" title="后言"></a>后言</h2><p>说实话，太累了写这东西。</p>]]></content>
      
      
      <categories>
          
          <category> Pointless small talk </category>
          
      </categories>
      
      
        <tags>
            
            <tag> one </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
