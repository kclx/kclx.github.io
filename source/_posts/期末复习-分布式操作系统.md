---
title: 期末复习-分布式操作系统
tags: []
categories: ["Final Review"]
top: false
comments: true
lang: en
toc: true
excerpt: 期末复习-分布式操作系统
swiper: false
swiperDesc: 期末复习-分布式操作系统
tocOpen: true
onlyTitle: false
share: true
copyright: true
donate: true
bgImgTransition: fade
bgImgDelay: 180000
prismjs: default
mathjax: false
imgTop: ture
date: 2024-01-03 15:51:46
updated: 2024-01-03 15:51:46
swiperImg:
bgImg:
img: https://s1.imagehub.cc/images/2024/01/03/b3541045b38b85d015a52febb8edb02d.jpeg
---

## 简答题

1. `vim`有几种工作模式？各模式可实现什么功能？

    `vim`编辑器的工作模式分为命令模式、插入模式和底行模式，其中命令模式可执行光标移动、删除、复制、粘贴等操作；插入模式可实现文本编辑操作；底行模式可实现退出、查找等功能。

2. 网络连接存储NAS(Network Attached Storage)

    NAS是一种远程文件服务的方法，多个存储设备通过网络协议和一群计算机相连接。用户不是在用户自己的文件系统上使用该软件，其文件访问被重定向到使用远程协议(CIFS或NFS)的其他设备，该设备有自己的文件系统和服务来执行文件I/O，实现文件共享和集中数据管理。NAS以网络为中心，利用现有IP网络资源就能从存储数据的服务器获取数据。用户可以像在本地驱动器上一样复制和粘贴文件或整个文件夹。但其网络协议开销大，访问速度高的场合（如数据库应用）不适合使用NAS，一般也很难管理多个相关设备，不能跨越不同设备。

3. 直接连接存储DAS(Direct Attached Srorage)

    DAS本质是硬件设备的累加，多个存储设备通过光纤或SCSI接口直接连接到主机。存在服务器一旦故障，存储数据难恢复的问题。其存储维护管理和I/O读写依赖服务器的主机操作系统，数据存储一般占用30%左右主机资源，存储数据量很大时，需要耗费时间长，对服务器硬件有一定影响。另外，该存储方式不具备共享性。

4. 举例说明`cat`、`more`和`less`命令的用法

    1. `cat`命令可以把多个文件连接后输出到标准输出(屏幕)或加―>文件名输出到另一个文件中。如显示当前目录下文件`testfile1`的内容可用如下命令:  `cat testfile1`。

    2. `more`命令显示文本文件的内容，一次显示一屏，满屏后停下来，可按键继续。如显示`/etc/profile`文件的内容，每屏10行可用如下命令:  `more -10 /etc/profile`。

    3. `less`命令与`more`命令相似，分屏显示文件的内容。less命令允许用户向前(pageup)或向后(pagedown)浏览文件。如文件`/etc/profile`中查找字符串"hostname"，并从该字符串后显示可以如下命令:  `less -p hostname /etc/profile`

5. 如何把`/tmp/etc/man.conf`移动到`/tmp`下并改名为`test.conf`设置所有人都有读写执行权限

    ```shell
    mv /tmp/etc/man.conf /tmp/test.conf
    chmod 777 /tmp/test.conf
    ```

6. 论述从SSH客户端来看，SSH服务端主要提供两种级别的安全验证

    - 基于口令的安全验证和基于密钥的安全验证
        基于口令的安全验证方式是最为用户所熟悉的，服务器端保存用户的 SSH 连接账号和口令，用户在客户端向服务器的 SSH 端口(默认为 22)提出登录请求，用户输入的身份和口令信息传递到服务器端验证合法性，如果通过验证就可以建立连接开始通信。该方式下，认证和通信过程都有密码技术的结合，口令可以散列化处理后再传输，通信信息也能保证信息的机密性，但在双向身份认证上有缺陷，不能判断服务器是否是冒充的。
    - 基于密钥的安全验证
        基于密钥的安全验证方式是基于公钥密码技术，通信双方要事先各建立一对密钥，用户需把公钥(Public Key)放在待访问的目标服务器上，私钥(Private Key)可保管在 SSH 客户端。客户端向 SSH 服务器发出请求时，服务器会先在服务器上寻找事先存放的对应用户的公钥，然后把它和 SSH 客户端发送过来的公钥进行比较，如果两个密钥一致，服务器用公钥加密质询(Challenge)发送给 SSH 客户端，SSH 客户端收到质询后用自己的私钥解密,再把验证信息发送给 SSH 服务器。该认证过程双方都可要求实行预存对方公钥，可实现双向身份认证，防止任何一方的身份冒充。

7. 如何查看`/etc`下的所有文件，并从人性化的长格式显示还能区分是什么文件

    ```shell
    ls -alh --color /etc/
    ls -alh /etc/
    ll -ah /etc/
    ```

8. 编程题：利用匿名管道实现父子进程间的通信，子进程对父进程说"hello"

    ```c
    #include <unistd.h>
    #include <errno.h>
    #include <stdio.h>
    #include <stdlib.h>
    #include <string.h>
    
    int main()
    {
        int pipe_fd[2];
    
        if (pipe(pipe_fd) < 0)
        {
            perror("pipe create error");
            return -1;
        }
    
        printf("pipe create success\n");
    
        if (fork() > 0)
        {
            // Father process
            int r;
            char buf[15 + 1];
    
            printf("*** Want to read from son\n");
            r = read(pipe_fd[0], buf, 15); // 从管道读端读取数据到 buf
            buf[r] = '\0';
            printf("*** FATHER Got strings: %s\n", buf);
        }
        else
        {
            // Son process
            const char *test = "a test string !";
            
            printf("Son sleep:\n");
            sleep(5);
            printf("SonWrite after sleep: %s\n", test); // 2
            write(pipe_fd[1], test, strlen(test));      // 从管道写端写入 test
        }
    
        close(pipe_fd[1]);
    
        return 0;
    }
    ```

9. 写出shell脚本中`while`循环与`until`循环的基本格式，并简述这两种循环结构的区别

    while循环的语法格式为: 

    ```shell
    while [ 表达式 ]
    do
    	# code
    done
    ```

    until循环的语法格式为: 

    ```shell
    until [ 表达式 ]
    do
    	# code
    done
    ```

    while和until的区别在于: while会先进行表达式判断,若表达式满足,才执行循环体,直到表达式不满足为止;而until则会先执行循环体,再进行表达式判断,直到表达式不成立时,才结束循环。until循环至少会执行一次。

10. 编写一个循环输出字符串"Hello"的程序，利用键盘`Ctrl+C`或`kill`发信号终止该程序。程序执行时捕获信号会输出已接收，输出"OK"后结束

    ```c
    #include <stdio.h>
    #include <signal.h>
    #include <unistd.h>
    
    volatile sig_atomic_t received_signal = 0;
    
    void signal_handler(int sig) {
        received_signal = sig;
        printf("Received signal: %d\n", sig);
    }
    
    int main() {
        signal(SIGINT, signal_handler);  // 捕获Ctrl+C
        signal(SIGTERM, signal_handler); // 捕获kill命令
    
        while (1) {
            printf("Hello\n");
            sleep(1);
    
            if (received_signal != 0) {
                printf("OK\n");
                break;
            }
        }
        return 0;
    }
    ```

11. 编写脚本：提示用户输入用户名和密码，脚本自动创建相应的账户及配置密码。如果用户不输入账户名，则提示必须输入账户名并退出脚本；如果用户不输入密码，则统一使用默认的"123456"作为默认密码

    ```shell
    #!/bin/bash
    # 编写脚本: 提示用户输入用户名和密码,脚本自动创建相应的账户及配置密码。
    # 如果用户不输入账户名,则提示必须输入账户名并退出脚本;
    # 如果用户不输入密码,则统一使用默认的 123456 作为默认密码。
    
    read -p "请输入用户名:  " user
    
    # 使用 -z 可以判断一个变量是否为空,如果为空,提示用户必须输入账户名,并退出脚本,退出码为 2
    # 没有输入用户名脚本退出后,使用$?查看的返回码为 2
    if [ -z "$user" ]; then
        echo "您必须输入账户名"
        exit 2
    fi
    
    # 使用 stty -echo 关闭 shell 的回显功能
    # 使用 stty echo 打开 shell 的回显功能
    stty -echo
    read -p "请输入密码:  " pass
    stty echo
    pass=${pass: -123456}
    
    useradd "$user"
    echo "$pass" | passwd --stdin "$user"
    ```

12. 如何删除`/tmp`下所有"A"开头的文件

    ```shell
    rm -rf /tmp/A*
    rm /tmp/A*
    ```

13. 如何通过命令行重启Linux操作系统

    ```shell
    shutdown -r now | reboot | init 6
    ```

14. `/var`下一般放置什么文件

    大型文件的溢出区

15. shell中都有哪些引号，它们之间的区别是什么

    - 在shell中引号分为三种: 单引号,双引号和反引号。 
    - 单引号 (') 由单引号括起来的字符都作为普通字符出现。特殊字符用单引号括起来以后也会失去原有意义,而只作为普通字符解释。 
    - 双引号(")由双引号括起来的字符,除$、\、‘、和‖这几个字符仍是特殊字符并保留其特殊功能外,其余字符作为普通字符对待。 
    - 反引号(`)反引号括起来的字符串被shell解释为命令,在执行时,shell首先执行该命令,并以它的标准输出结果取代整个反引号(包括两个反引号)部分。

16. 简单说明vi编辑器的工作模式，并画图说明各模式间的切换方法

    vi编辑器的工作模式分为命令模式、插入模式和底行模式,其中命令模式可执行光标移动、删除、复制、粘贴等操作;插入模式可实现文本编辑操作;底行模式可实现退出、查找等功能。

    {% note warning, 图示参考教材图2-1 %}

17. 备份日志

    ```shell
    #!/bin/bash
    # 每周 5 使用 tar 命令备份/var/log 下的所有日志文件
    # vim /root/logbak.sh
    # 编写备份脚本,备份后的文件名包含日期标签,防止后面的备份将前面的备份数据覆盖
    # 注意 date 命令需要使用反引号括起来,反引号在键盘<tab>键上面
    
    tar -czf log-$(date +%Y%m%d).tar.gz /var/log
    
    # crontab -e # 编写计划任务,执行备份脚本
    # 00 03 * * 5 /root/logbak.sh
    ```

18. 简述gcc编译器的工作流程，并说明每步执行的内容

    1. gcc的编译过程分为四个步骤,分别是预处理、编译、汇编和链接。
    2. 预处理阶段主要处理源代码中以“#”开头的预编译指令和一些注释信息;
    3. 编译阶段gcc会对经过预处理的文件进行语法、词法和语义分析,确定代码实际要做的工作,若检查无误,则生成相应的汇编代码文件;
    4. 汇编阶段将编译后生成的汇编代码转换为机器可以执行的命令;
    5. 链接的过程是组装各个目标文件的过程,在这个过程中会解决符号依赖和库依赖关系,最终生成可执行文件。

19. 监控内存和磁盘容量，小于给定值时报警

    ```shell
    #!/bin/bash
    # 实时监控本机内存和硬盘剩余空间,剩余内存小于500M、根分区剩余空间小于1000M时,发送报警邮件给root管理员
    
    while : 
    do
        # 提取根分区剩余空间
        disk_size=$(df / | awk '/\//{print $4}')
    
        # 提取内存剩余空间
        mem_size=$(free | awk '/Mem/{print $4}')
    
        # 注意内存和磁盘提取的空间大小都是以 Kb 为单位
        if [ $disk_size -le 512000 -a $mem_size -le 1024000 ]
        then
            mail -s "Warning" root <<EOF
    Insufficient resources,资源不足
    EOF
        fi
        sleep 60
    done
    ```

20. 编写shell脚本，首先批量删除用户功能，其中用户的用户名格式统一（如`qwe1` ~ `qwe9`）。删除的用户名采用统一格式，因此可使用`user00+数字`的方式实现，其中前缀由用户手动输入，后缀数字可通过循环逐次递增

    ```shell
    #!/bin/bash
    # delusers
    echo "------del 9 users------"
    echo "please input a string: "
    read user
    
    for i in {1..9}; do
        username="$user$i"
        userdel -r "$username"
    
        if [ $? -eq 0 ]; then
            echo "del $username successful"
        else
            echo "del $username failure"
        fi
    done
    
    exit
    ```

21. 设置`/test/a.txt`属主有读写执行权限，属组，有读写，其他账户无权限。
    ```shell
    chmod 760 /test/a.txt
    ```

22. 如何删除`g2`组的用户`u`
    ```shell
    gpasswd -d u g2
    ```

23. `vim`如何把文档中的`50`到`100`行之间的`man`改`MAN`

    ```shell
    :50,100s/man/MAN/g
    ```

24. 如何通过`vim`编辑打开`/tmp/test.conf`
    ```shell
    cd /tmp
    vim /tmp/test.conf
    ```

25. 如何查看`/etc/passwd`的头`3`行和尾`3`行
    ```shell
    head -3 /etc/passwd
    tail -3 /etc/passwd
    ```

26. 日志一般都存放在那个目录下
    `/var/log`

27. 通过位置变量创建 Linux 系统账户及密码
    ```shell
    useradd "$1"
    echo "$2" | passwd ‐‐stdin "$1"
    ```

28. 修改`/tmp/test.conf`的属主为`u1`，属组为`u2`
    ```shell
    chown u1:u2 /tmp/test.conf
    ```

29. 什么命令可以统计当前系统中一共有多少账户
    ```shell
    wc -l /etc/passwd
    ```

30. 添加账户`u1`，为其指定附加组`g1`，并设置`2013—04—04`账户到期
    ```shell
    useradd -G g1 -e 2013-04-04 u1
    ```

31. 如何只查看`/etc`单个目录的信息并以长格式显示
    ```shell
    ls -ld /etc # -d只显示目录本身的属性
    ll -d /etc
    ```

32. 提升用户`usr1`的权限,要求`usr1`可登入所有主机、可切换至所有用户、可执行所用命令。
    使用`visudo`命令打开`/etc/sudoers`文件，在其中添加"usr1 ALL=(ALL) ALI"后，保存退出。

33. 如何查看系统最后创建的3个组
    ```shell
    tail -3 /etc/group
    ```